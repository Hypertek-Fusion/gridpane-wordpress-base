document.addEventListener("DOMContentLoaded",()=>{const c=document.querySelectorAll(".setup-page"),u=document.querySelector(".page-prev"),d=document.querySelector(".page-next");let t=0,s=10;window.HSRevData=window.HSRevData||{},window.HSRevData.functions=window.HSRevData.functions||{},window.HSRevData.data=window.HSRevData.data||{},window.HSRevData.data.selectedReviews=new Set;const h=document.querySelector("form");h.addEventListener("submit",e=>{e.preventDefault(),submitForm()});const l=()=>{const e=c[t].querySelectorAll('input:not([name="select-all-reviews"])[type="checkbox"]');return Array.from(e).some(n=>n.checked)},m=e=>{const n=c[t].querySelectorAll('input[name*="selected-review-"][type="checkbox"]'),o=window.HSRevData.data.locationId;window.HSRevData.data.reviewsCache[o],Array.from(n).forEach(a=>{const i=a.value;a.checked=e.checked,e.checked?window.HSRevData.data.selectedReviews.add(i):window.HSRevData.data.selectedReviews.delete(i)}),S(),r()},S=()=>{const e=document.getElementById("selected_reviews"),n=Array.from(window.HSRevData.data.selectedReviews).filter(o=>o.startsWith("AbFvOq"));e.value=n.join(",")},k=()=>{const e=c[0].querySelector('input[type="checkbox"]:checked');return e?e.closest(".row-item").dataset.accountId:null},D=()=>{const e=c[1].querySelector('input[type="checkbox"]:checked');return e?e.closest(".row-item").dataset.locationId:null},r=()=>{t!==2?d.innerText="Next Page":d.innerText="Submit",d.disabled=!l()},f=e=>{e.querySelectorAll('input[type="checkbox"]').forEach(o=>{o.addEventListener("change",a=>{const i=a.target,p=i.value;i.checked?window.HSRevData.data.selectedReviews.add(p):window.HSRevData.data.selectedReviews.delete(p),S(),r()})})},w=e=>{c.forEach((n,o)=>{n.style.display=o===e?"block":"none"}),u.disabled=e===0,r()};w(t),u.addEventListener("click",()=>{t>0&&(t--,w(t))}),d.addEventListener("click",()=>{if(t<c.length-1&&l()){if(t===0){const e=k();e&&window.HSRevData.functions.getLocations&&(window.HSRevData.data.accountId!==e&&(console.log("Account changed, clearing location cache"),window.HSRevData.data.locationsCache={}),window.HSRevData.functions.getLocations(e),window.HSRevData.data.accountId=e,console.log(`Account ID set: ${e}`))}else if(t===1){const e=D();e&&window.HSRevData.functions.prefetchReviews&&(window.HSRevData.data.locationId!==e&&(console.log("Location changed, clearing review cache"),window.HSRevData.data.reviewsCache={}),window.HSRevData.functions.prefetchReviews(e),window.HSRevData.data.locationId=e,console.log(`Location ID set: ${e}`))}t++,w(t)}else t===2&&l()&&h.submit()}),window.HSRevData&&window.HSRevData.functions&&(window.HSRevData.functions.attachCheckboxListeners=f,window.HSRevData.functions.selectAllReviews=m),c[t]&&f(c[t]);const y=document.getElementById("reviews-per-page"),H=(e,n,o)=>{const a=Math.ceil(e/o);document.getElementById("reviews-prev").disabled=n<=1,document.getElementById("reviews-next").disabled=n>=a},g=e=>{const n=Math.ceil(R()/s);e>0&&e<=n&&(t=e,v(t))},v=e=>{document.querySelectorAll(".reviews-page").forEach((o,a)=>{o.style.display=a+1===e?"block":"none"}),H(R(),t,s)},R=()=>document.querySelectorAll(".review-row").length;document.getElementById("reviews-prev").addEventListener("click",()=>g(t-1)),document.getElementById("reviews-next").addEventListener("click",()=>g(t+1)),y.addEventListener("change",function(){s=parseInt(this.value,10),t=1,v(t)}),v(t)});
