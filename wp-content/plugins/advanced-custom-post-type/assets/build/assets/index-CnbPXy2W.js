import{j as e,u as l,f as E,d as xl,e as vl,g as fl,h as $l,i as os,k as ds,m as cs,r as us,b as He}from"./fields-Cqw4NA-S.js";import{a as w,R as I,u as Ee,j as hs,h as ms}from"./vendor-D21mNUGX.js";import{n as xe,b as Me,u as al,B as Gl,L as ps,_ as ml,s as bs}from"./Layout-DCNQQmUm.js";import{P as i,u as z,B as U,s as G,ai as Pl,I as _,G as ue,K as Be,aj as Ce,a as H,ak as $e,al as Kl,am as nl,ab as Xe,an as gl,ao as sl,ap as jl,v as ce,aq as Pe,ar as Ul,as as W,at as ke,au as Yl,av as yl,aw as il,ax as xs,ay as vs,az as Hl,aA as zl,aB as Nl,aC as Qe,aD as Sl,aE as Jl,aF as Wl,aG as Cl,aH as fs,aI as Xl,i as ve,aJ as Ol,A as rl,aK as ll,aL as gs,aM as js,aN as ys,aO as Ns,aP as Ss,aQ as Cs,aR as Ts,aS as Rs,aT as ks,aU as ws,aV as Fs,aW as pl,aX as Es,aY as Ms,aZ as As,a_ as Os,a$ as Is,b0 as qs,ac as ze,b1 as Le,b2 as Vs,b3 as Il,b4 as Ds,b5 as Bs,b6 as _s,b7 as Ls,b8 as $s,b9 as Gs,ba as Ps,bb as ol,bc as ql,bd as Ql,be as Vl,bf as Ks,bg as Us,bh as Ys,bi as Hs,bj as zs,bk as Js,bl as Ws,m as Dl,c as Xs,L as Qs,bm as Zs,bn as et}from"./index-DxCcoVgy.js";import{u as P,a as ie,b as V,g as Ae,c as lt,F as at}from"./index.esm-CunHohLK.js";import{I as Z}from"./Input-CuPRbCrx.js";import{T as $}from"./index-XHH1WL2a.js";import{M as he}from"./index-Dp8I9ahT.js";import{a as Ke}from"./validation-D-MLcBjP.js";import{I as be}from"./InputHidden-D-OSbUvk.js";import{d as we,w as Fe}from"./bundle.esm.min-B-HQpnrw.js";import{u as Oe,C as Ie,a as ye}from"./sortable.esm-C-GypyhB.js";import{M as dl}from"./index-Dx-NZAGb.js";import{C as Bl}from"./index-DJ-BFKuq.js";import{B as De}from"./ButtonSwitch-DDjyTOqf.js";import{S as le}from"./Select-DQFFBRh5.js";import{S as ge}from"./index-DYn0t4Hl.js";import{T as st,a as Je}from"./index-WYQ2JGQs.js";import{L as Q}from"./Label-DD1DoJkn.js";import{u as Ne}from"./index-DRV1MUeg.js";import{m as te}from"./metaTypes-Bb9tjSPe.js";import{R as tt}from"./index-C8n7JnXF.js";import{S as Ge}from"./SelectMulti-CK2coul2.js";import{p as nt}from"./posts-DE4oWSSH.js";import{P as it}from"./index-CP6v-V9Q.js";import"./index-Cwt3Qm9G.js";import"./objectWithoutPropertiesLoose-D8pFLZ8M.js";const Zl=({index:a,boxId:s,setActiveTab:d})=>{const t=z(),{control:o}=P(),{remove:n}=ie({control:o,name:"boxes"}),[c,m]=w.useState(!1),b=[e.jsx(U,{style:G.SUCCESS,onClick:r=>{r.preventDefault(),t(Pl(s)),n(a),m(!c),d&&d(0)},children:l("Yes")}),e.jsx(U,{style:G.DANGER,onClick:r=>{r.preventDefault(),m(!c)},children:l("No")})];return e.jsxs(I.Fragment,{children:[e.jsx(he,{title:l("Confirm deleting meta box"),visible:c,buttons:b,children:l("Are you sure?")}),e.jsx("a",{href:"#",onClick:r=>{r.preventDefault(),m(!c)},children:e.jsx(_,{icon:"bx-trash",width:18,color:"#F94144"})})]})};Zl.propTypes={setActiveTab:i.func,index:i.number.isRequired,boxId:i.string.isRequired};const ea=({box:a})=>{const d=document.globals.globals,{setValue:t}=P(),o=z(),{id:n}=Ee(),[c,m]=w.useState(!1),[b,r]=w.useState(null),[h,T]=w.useState(!1);w.useEffect(()=>{r(null),T(!1)},[c]);const f=()=>{ue("copyMetaBoxAction",{boxId:a.id,targetGroupId:b,delete:h}).then(u=>{u.success?(xe.success(`${l("Meta box was successfully copied")}.`),m(!c),n===a.groupId&&o(Be({id:n})).then(p=>{o(Ce(p.payload)),t("id",n),t("name",p.payload.name),t("label",p.payload.label),t("display",p.payload.display),p.payload.belongs&&p.payload.belongs.map((x,R)=>{t(`belongs.${R}.id`,x.id),t(`belongs.${R}.belongsTo`,x.belongsTo),t(`belongs.${R}.operator`,x.operator),t(`belongs.${R}.find`,x.find),t(`belongs.${R}.logic`,x.logic)}),p.payload.boxes&&p.payload.boxes.map((x,R)=>{t(`boxes.${R}`,x)})}).catch(p=>{console.error(p)})):xe.error(u.error)}).catch(u=>console.error(u))};return e.jsxs(I.Fragment,{children:[e.jsx(he,{title:l("Copy this meta box"),visible:c,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:l("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:u=>r(u.target.value),children:d.find.meta.map(u=>e.jsx("option",{value:u.value,children:u.label}))})})]}),b&&b!=="Select"&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:h,onClick:()=>T(!h),id:"deleteBox"}),e.jsx("label",{htmlFor:"deleteBox",children:l("Delete the meta box after copying")})]}),e.jsx(U,{onClick:()=>f(),style:G.PRIMARY,children:l("Copy")})]})]})}),e.jsx("a",{href:"",onClick:u=>{u.preventDefault(),m(!c)},children:e.jsx(_,{icon:"bx:copy",width:18})})]})};ea.propTypes={box:i.object.isRequired};const Ue=({element:a,elementType:s})=>{const d=z(),{selectedElements:t}=H(c=>c.metaState),o=()=>t.filter(m=>m.id===a.id).length>0,n=c=>{d($e({element:a,selected:c,type:s})),a.children&&a.children.map(m=>{d($e({element:m,selected:c,type:s})),m.children&&m.children.map(b=>{d($e({element:b,selected:c,type:s}))})})};return e.jsx($,{label:e.jsxs("label",{className:"checkbox",htmlFor:`select-${a.id}`,style:{top:"3px"},children:[e.jsx("input",{id:`select-${a.id}`,type:"checkbox",checked:o(),onChange:c=>n(c.target.checked)}),e.jsx("span",{})]}),icon:!1,tip:l(o()?"Deselect this element":"Select this element")})};Ue.propTypes={element:i.object.isRequired,elementType:i.oneOf(["box","block","field"]).isRequired};function Tl(a,s,d){var t,o,n,c,m,b=function(){var h=_l()-o;s>h?t=setTimeout(b,s-h):(t=null,c=a.apply(m,n),t||(n=m=null))},r=rt(function(h){return m=this,n=h,o=_l(),t||(t=setTimeout(b,s)),c});return r.cancel=function(){clearTimeout(t),t=n=m=null},r}function _l(){return new Date().getTime()}function rt(a,s){return s=s==null?a.length-1:+s,function(){for(var d=Math.max(arguments.length-s,0),t=Array(d),o=0;o<d;o++)t[o]=arguments[o+s];switch(s){case 0:return a.call(this,t);case 1:return a.call(this,arguments[0],t);case 2:return a.call(this,arguments[0],arguments[1],t)}var n=Array(s+1);for(o=0;o<s;o++)n[o]=arguments[o];return n[s]=t,a.apply(this,n)}}const la=({index:a,box:s,listeners:d,attributes:t,setActiveTab:o})=>{const n=q=>`boxes.${a}.${q}`,{register:c,formState:{errors:m},control:b,setValue:r,resetField:h,clearErrors:T,setError:f}=P(),u=V({control:b,name:n("name")}),p=V({control:b,name:n("label")}),x=V({control:b,name:`boxes.${a}`}),R=V({control:b,name:"boxes"}),{append:S}=ie({control:b,name:"boxes"}),M=z(),{closedElements:A,selectedElementsType:g}=H(q=>q.metaState),k=()=>A.filter(D=>D===s.id).length===1,[N,v]=w.useState(!1),[C,F]=w.useState(!0),y=()=>{const q=n("name"),D=Ae(m,q);return D?e.jsx("span",{className:"invalid-feedback",children:l(D.message)}):u||s.name},j=()=>typeof p=="string"?p:s.label,O=async q=>{if(C){const D=we(Fe(q));r(n("name"),D),await B(D)?f(n("name"),{message:l("Name is already taken")}):T(n("name"))}},B=async q=>{let D=[];if(R&&R.map((se,ne)=>{ne!==a&&D.push(se.name)}),D.includes(q))return l("Name is already taken");if(s.name!==q&&(await ue("checkMetaBoxNameAction",{boxName:q})).exists===!0)return l("Name is already taken")},X=()=>{gl(s.id),k()?M(sl({id:s.id})):M(jl({id:s.id}))},ae=()=>!(typeof s.isSaved<"u"&&s.isSaved===!1),L=()=>{const q={id:ce(),boxId:s.id,name:"meta_box_field",label:"meta box field",type:E.TEXT,defaultValue:"",description:"",isRequired:!1,showInArchive:!1,quickEdit:!1,filterableInAdmin:!1,sort:1,advancedOptions:[],options:[],blocks:[],blockId:null,validationRules:[],visibilityConditions:[],hasManyRelation:[],children:[],parentId:null,isATextualField:!0,isFilterable:!0,isSaved:!1};M(Pe({boxId:s.id,parentFieldId:null,parentBlockId:null,field:q}))};return e.jsxs("div",{className:"flex-between p-24 s-8 for-xs",children:[e.jsx(be,{id:n("id"),value:s.id,register:c}),e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"cursor-move top-2 handle",...t,...d,children:e.jsx(_,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),g!=="field"&&g!=="block"&&ae()&&e.jsx(Ue,{elementType:"box",element:{id:s.id}}),e.jsx("h3",{className:`${N?"hidden":""}`,children:y()}),e.jsx("span",{className:`color-gray ${N?"hidden":""}`,children:j()}),e.jsxs("div",{className:`i-flex-center s-8 ${N?"":"hidden"}`,children:[e.jsx("div",{children:e.jsx(Z,{size:"sm",id:n("label"),placeholder:l("Box label, non latin chars allowed."),defaultValue:s.name,register:c,errors:m,required:!0,onChangeCapture:Tl(q=>{O(q.target.value)},300),onClick:q=>{(q.target.value==="meta_box_title"||q.target.value==="meta box title")&&h(n("label"))},validate:{maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("div",{children:e.jsx(Z,{size:"sm",id:n("name"),placeholder:l("Box name. Allowed chars: [a-z0-9_-]"),defaultValue:s.name,register:c,errors:m,required:!0,onClick:q=>{q.target.value==="meta_box_title"&&h(n("name"))},validate:{validate:{alphanumericallyValid:Ke,checkIfNameIsValid:B},required:l("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx($,{label:e.jsx("span",{className:`acpt-btn-switch ${C===!0?"active":""}`,onClick:q=>{q.preventDefault(),F(!C)},children:e.jsx(_,{icon:"bx-link",width:18})}),tip:l(`${C?"Auto slug ON":"Auto slug OFF"}`),icon:!1})]}),e.jsx(U,{style:G.SECONDARY,size:"sm",onClick:q=>{q.preventDefault(),v(!N)},children:l(`${N?"Close":"Edit"}`)})]}),e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx($,{label:e.jsx("a",{href:"#",onClick:q=>{q.preventDefault();const D=Kl(x);M(nl(D)),S(D),Xe(1).then(()=>{Me(D.id)})},children:e.jsx(_,{icon:"bx:duplicate",width:18})}),tip:l("Duplicate this meta box"),icon:!1}),ae()&&e.jsx(I.Fragment,{children:e.jsx($,{label:e.jsx(ea,{box:s}),tip:l("Copy this meta box"),icon:!1})}),e.jsx($,{label:e.jsx(Zl,{index:a,setActiveTab:o,boxId:s.id}),tip:l("Delete this meta box"),icon:!1}),e.jsx($,{label:e.jsx("a",{href:"#",onClick:q=>{q.preventDefault(),L()},children:e.jsx(_,{icon:"bx:plus-circle",width:18})}),tip:l("Add field"),icon:!1}),e.jsx($,{label:e.jsx("a",{href:"#",onClick:q=>{q.preventDefault(),X()},children:e.jsx(_,{icon:"bx:expand-alt",width:18})}),tip:l("Hide/show this meta box"),icon:!1})]})]})};la.propTypes={box:i.object.isRequired,setActiveTab:i.func,attributes:i.object,listeners:i.object};const aa=({field:a})=>{const d=document.globals.globals,{setValue:t}=P(),o=z(),{id:n}=Ee(),[c,m]=w.useState(!1),[b,r]=w.useState(null),[h,T]=w.useState([]),[f,u]=w.useState([]),[p,x]=w.useState([]),[R,S]=w.useState(null),[M,A]=w.useState(null),[g,k]=w.useState(!1);w.useEffect(()=>{r(null),T([]),u([]),x([]),S(null),A(null),k(!1)},[c]);const N=j=>{r(j),T([]),u([]),x([]),S(null),A(null),k(!1),ue("fetchMetaAction",{id:j}).then(O=>{T(O.boxes)}).catch(O=>console.error(O))},v=j=>{u([]),x([]),S("box"),A(j);const O=h.filter(B=>B.id===j)[0].fields;if(O&&O.length>0){const B=O.filter(X=>X.type===E.REPEATER||X.type===E.FLEXIBLE);B&&B.length>0&&u(B)}},C=j=>{S("field"),A(j);const O=f.filter(B=>B.id===j)[0].blocks;O&&O.length>0&&x(O)},F=j=>{S("block"),A(j)},y=()=>{ue("copyMetaFieldAction",{fieldId:a.id,targetEntityType:R,targetEntityId:M,delete:g}).then(j=>{j.success?(xe.success(`${l("Meta field was successfully copied")}.`),m(!c),n===a.groupId&&o(Be({id:n})).then(O=>{o(Ce(O.payload)),t("id",n),t("name",O.payload.name),t("label",O.payload.label),t("display",O.payload.display),O.payload.belongs&&O.payload.belongs.map((B,X)=>{t(`belongs.${X}.id`,B.id),t(`belongs.${X}.belongsTo`,B.belongsTo),t(`belongs.${X}.operator`,B.operator),t(`belongs.${X}.find`,B.find),t(`belongs.${X}.logic`,B.logic)}),O.payload.boxes&&O.payload.boxes.map((B,X)=>{t(`boxes.${X}`,B)})}).catch(O=>{xe.error(`${l("Something went wrong, please retry.")}`)})):xe.error(j.error)}).catch(j=>{xe.error(`${l("Something went wrong, please retry.")}`)})};return e.jsxs(I.Fragment,{children:[e.jsx(he,{title:l("Copy this meta field"),visible:c,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:l("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:j=>N(j.target.value),children:d.find.meta.map(j=>e.jsx("option",{value:j.value,children:j.label}))})})]}),h&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"box",children:l("Meta box")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"box",className:"form-control default",onChangeCapture:j=>v(j.target.value),children:[e.jsx("option",{value:null,children:l("Select")}),h.map(j=>e.jsx("option",{value:j.id,children:j.name}))]})})]}),f&&f.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"field",children:l("Meta field")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"field",className:"form-control default",onChangeCapture:j=>C(j.target.value),children:[e.jsx("option",{value:null,children:l("Select")}),f.map(j=>e.jsx("option",{value:j.id,children:j.name}))]})})]}),p&&p.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"field",children:l("Meta block")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"block",className:"form-control default",onChangeCapture:j=>F(j.target.value),children:[e.jsx("option",{value:null,children:l("Select")}),p.map(j=>e.jsx("option",{value:j.id,children:j.name}))]})})]}),R&&M&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:g,onClick:()=>k(!g),id:"deleteField"}),e.jsx("label",{htmlFor:"deleteField",children:l("Delete the meta field after copying")})]}),e.jsx(U,{onClick:()=>y(),style:G.PRIMARY,children:l("Copy")})]})]})}),e.jsx("a",{href:"#",onClick:j=>{j.preventDefault(),m(!c)},children:e.jsx(_,{icon:"bx:copy",width:18})})]})};aa.propTypes={field:i.object.isRequired};const sa=({boxId:a,fieldId:s,fieldIndex:d,parentFieldId:t,parentBlockId:o,setActiveTab:n})=>{const c=z(),{group:m}=H(p=>p.metaState),b=()=>W(m.boxes,a,s,!1),[r,h]=w.useState(!1),{control:T}=P(),{remove:f}=ie({control:T,name:b()}),u=[e.jsx(U,{style:G.SUCCESS,onClick:p=>{p.preventDefault(),c(Ul({boxId:a,parentFieldId:t,parentBlockId:o,fieldId:s})),f(d),h(!r),n&&n(0)},children:l("Yes")}),e.jsx(U,{style:G.DANGER,onClick:p=>{p.preventDefault(),h(!r)},children:l("No")})];return e.jsxs(I.Fragment,{children:[e.jsx(he,{title:l("Confirm deleting meta field"),visible:r,buttons:u,children:l("Are you sure?")}),e.jsx("a",{href:"#",onClick:p=>{p.preventDefault(),h(!r)},children:e.jsx(_,{icon:"bx-trash",width:18,color:"#F94144"})})]})};sa.propTypes={setActiveTab:i.func,boxId:i.string.isRequired,fieldId:i.string.isRequired,fieldIndex:i.number.isRequired,parentFieldId:i.string,parentBlockId:i.string};const ta=({boxId:a,field:s,parentFieldId:d,parentBlockId:t})=>{const{group:o}=H(y=>y.metaState),n=o.boxes.findIndex(y=>y.id===a),c=W(o.boxes,a,s.id),m=c.split("."),[b,r]=w.useState(!1),[h,T]=w.useState([]),[f,u]=w.useState(null),[p,x]=w.useState(!1),{control:R}=P(),S=V({control:R,name:"belongs"}),M=V({control:R,name:`boxes.${n}.name`}),A=V({control:R,name:c}),g=V({control:R,name:`boxes.${n}.fields.${m[3]}.name`});let k=null,N=null,v=m[m.length-1],C=t?m[m.length-3]:null;t&&(k=V({control:R,name:W(o.boxes,a,t)})),d&&(N=V({control:R,name:W(o.boxes,a,d)})),w.useEffect(()=>{p&&(r(!0),ue("calculateShortCodeAction",{belongsTo:S,boxName:M,fieldId:s.id,fieldName:A?A.name:s.name,fieldRootName:g,parentBlockName:k?k.name:null,parentFieldName:N?N.name:null,index:v,blockIndexInfo:C}).then(y=>{u(y.metaKey),T(y.shortcodes),r(!1)}).catch(y=>{console.error(y.message),r(!1)}))},[p]);const F=[e.jsx(U,{style:G.DANGER,onClick:y=>{y.preventDefault(),x(!p)},children:l("Close")})];return e.jsxs(I.Fragment,{children:[e.jsx(he,{title:l("Shortcode preview"),visible:p,padding:0,buttons:F,children:b?e.jsx("div",{className:"b-bottom-1 p-24",children:l("Loading...")}):e.jsxs(I.Fragment,{children:[f&&e.jsxs("div",{className:"b-bottom-1 p-24",children:[e.jsx("div",{className:"mb-8 color-black",children:e.jsx($,{label:l("Meta-key"),tip:e.jsxs("div",{className:"flex-column s-4",children:[e.jsx("div",{children:l("This is the meta-key of this field.")}),e.jsx("div",{children:l("Use it in functions like get_post_meta() to retrieve saved meta field data.")}),e.jsxs("div",{children:[l("Prepend the option page slug to retrieve option page meta fields."),e.jsx("br",{}),"Example: page-slug_",f]})]})})}),e.jsx(Bl,{text:f})]}),h&&h.length>0&&e.jsxs("div",{className:"p-24",children:[e.jsx("div",{className:"mb-8 color-black",children:e.jsx($,{label:h&&h.length>1?l("Shortcodes"):l("Shortcode"),tip:l("Use this shortcode to display the meta field on your frontend.")})}),h&&e.jsx("div",{className:"flex-column s-8",children:h.map(y=>e.jsx(Bl,{text:y}))})]})]})}),e.jsx("a",{href:"#",onClick:y=>{y.preventDefault(),x(!p)},children:e.jsx(_,{icon:"bx:code-alt",width:18})})]})};ta.propTypes={boxId:i.string.isRequired,field:i.object.isRequired,parentFieldId:i.string,parentBlockId:i.string};const Rl=({boxIndex:a,fieldIndex:s,boxId:d,field:t,parentFieldIndex:o,parentFieldId:n,parentBlockId:c})=>{const m=z(),{group:b,closedElements:r}=H(k=>k.metaState),{formState:{errors:h},control:T}=P(),f=V({control:T,name:W(b.boxes,d,t.id)}),u=V({control:T,name:ke(b.boxes,d,t.id,"type")}),{append:p}=ie({control:T,name:W(b.boxes,d,t.id,!1)}),x=()=>u||t.type,R=()=>x()!==E.REPEATER&&x()!==E.FLEXIBLE,S=()=>r.filter(N=>N===t.id).length===1,M=()=>{gl(t.id),S()?m(sl({id:t.id})):m(jl({id:t.id}))},A=()=>{const k={id:ce(),boxId:d,name:"meta_box_field",label:"meta box field",type:E.TEXT,defaultValue:"",description:"",isRequired:!1,showInArchive:!1,quickEdit:!1,filterableInAdmin:!1,sort:1,advancedOptions:[],options:[],blocks:[],blockId:null,validationRules:[],visibilityConditions:[],hasManyRelation:[],children:[],parentId:t.id,isATextualField:!0,isFilterable:!0,isSaved:!1};m(Pe({boxId:d,parentFieldId:t.id,parentBlockId:null,field:k}))},g=()=>{const k={id:ce(),boxId:d,fieldId:t.id,label:"new-block",name:"new_block",fields:[],isSaved:!1};m(il({boxId:d,parentFieldId:t.id,block:k}))};return e.jsxs("span",{className:"i-flex-center s-8",children:[R()&&e.jsx($,{label:e.jsx(ta,{boxId:d,field:t,parentFieldId:n,parentBlockId:c}),tip:l("Show the shortcode"),icon:!1}),e.jsx($,{label:e.jsx("a",{href:"#",onClick:k=>{k.preventDefault();const N=Yl(d,f,n,c);m(Pe({boxId:d,field:N,parentFieldId:n,parentBlockId:c})),p(N),Xe(1).then(()=>{Me(N.id)})},children:e.jsx(_,{icon:"bx:duplicate",width:18})}),tip:l("Duplicate this meta field"),icon:!1}),yl(t.isSaved)&&e.jsx($,{label:e.jsx(aa,{field:t}),tip:l("Copy this meta field"),icon:!1}),e.jsx($,{label:e.jsx(sa,{boxId:d,fieldId:t.id,fieldIndex:s,parentFieldId:n,parentBlockId:c}),tip:l("Delete this meta field"),icon:!1}),xl(x())&&e.jsx($,{label:e.jsx("a",{href:"#",onClick:k=>{k.preventDefault(),A()},children:e.jsx(_,{icon:"bx:plus-circle",width:18})}),tip:l("Add field"),icon:!1}),vl(x())&&e.jsx($,{label:e.jsx("a",{href:"#",onClick:k=>{k.preventDefault(),g()},children:e.jsx(_,{icon:"bx:plus-circle",width:18})}),tip:l("Add block"),icon:!1}),e.jsx($,{label:e.jsx("a",{href:"#",onClick:k=>{k.preventDefault(),M()},children:e.jsx(_,{icon:"bx:expand-alt",width:18})}),tip:l("Hide/show this meta field"),icon:!1})]})};Rl.propTypes={boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,field:i.object.isRequired,parentFieldIndex:i.string,parentFieldId:i.string,parentBlockId:i.string};const kl=({boxId:a,field:s})=>{const{group:d}=H(x=>x.metaState),{formState:{errors:t},register:o,control:n}=P(),c=x=>`${W(d.boxes,a,s.id)}.${x}`,m=V({control:n,name:c("type")}),b=V({control:n,name:c("showInArchive")}),r=V({control:n,name:c("filterableInAdmin")}),h=V({control:n,name:c("quickEdit")}),T=V({control:n,name:c("isRequired")}),f=()=>m||s.type,u=()=>f()!==E.CLONE&&f()!==E.REPEATER&&f()!==E.FLEXIBLE&&f()!==E.LIST,p=()=>s.parentId||s.blockId;return e.jsxs("div",{className:"i-flex-center s-4",children:[e.jsx($,{label:e.jsx(De,{id:c("showInArchive"),control:n,defaultValue:typeof b=="boolean"?b:s.showInArchive,errors:t,icon:"bxl:wordpress"}),tip:l("Show in Wordpress admin post lists page"),icon:!1}),u()&&e.jsxs(I.Fragment,{children:[!p()&&e.jsxs(I.Fragment,{children:[xs(s.type)&&e.jsx($,{label:e.jsx(De,{control:n,defaultValue:typeof r=="boolean"?r:s.filterableInAdmin,errors:t,icon:"bx:filter",id:c("filterableInAdmin")}),tip:l("Filterable in Wordpress admin post lists page"),icon:!1}),vs(s.type)&&e.jsx($,{label:e.jsx(De,{control:n,defaultValue:typeof h=="boolean"?h:s.quickEdit,errors:t,icon:"bx:pencil",id:c("quickEdit")}),tip:l("Quick edit in Wordpress admin post lists page"),icon:!1})]}),e.jsx($,{label:e.jsx(I.Fragment,{children:e.jsx(De,{control:n,defaultValue:typeof T=="boolean"?T:s.isRequired,errors:t,icon:"foundation:asterisk",id:c("isRequired")})}),tip:l("Field required"),icon:!1})]})]})};kl.propTypes={boxId:i.string.isRequired,field:i.object.isRequired};const wl=({boxId:a,field:s,parentFieldId:d,parentBlockId:t})=>{const{group:o}=H(b=>b.metaState),{formState:{errors:n},register:c}=P(),m=b=>ke(o.boxes,a,s.id,b);return e.jsxs(I.Fragment,{children:[e.jsx(be,{id:m("id"),value:s.id,register:c}),e.jsx(be,{id:m("parentId"),value:d||"",register:c}),e.jsx(be,{id:m("blockId"),value:t||"",register:c})]})};wl.propTypes={boxId:i.string.isRequired,field:i.object.isRequired,parentFieldId:i.string,parentBlockId:i.string};const na=({boxId:a,parentFieldId:s,blockId:d,blockIndex:t})=>{const o=z(),{group:n}=H(f=>f.metaState),c=()=>W(n.boxes,a,d,!1),[m,b]=w.useState(!1),{control:r}=P(),{remove:h}=ie({control:r,name:c()}),T=[e.jsx(U,{style:G.SUCCESS,onClick:f=>{f.preventDefault(),o(Hl({boxId:a,parentFieldId:s,blockId:d})),h(t),b(!m)},children:l("Yes")}),e.jsx(U,{style:G.DANGER,onClick:f=>{f.preventDefault(),b(!m)},children:l("No")})];return e.jsxs(I.Fragment,{children:[e.jsx(he,{title:l("Confirm deleting block"),visible:m,buttons:T,children:l("Are you sure?")}),e.jsx("a",{href:"#",onClick:f=>{f.preventDefault(),b(!m)},children:e.jsx(_,{icon:"bx-trash",width:18,color:"#F94144"})})]})};na.propTypes={boxId:i.string.isRequired,parentFieldId:i.string.isRequired,blockId:i.string.isRequired};const ia=({block:a})=>{const d=document.globals.globals,{setValue:t}=P(),o=z(),{id:n}=Ee(),[c,m]=w.useState(!1),[b,r]=w.useState(null),[h,T]=w.useState([]),[f,u]=w.useState([]),[p,x]=w.useState(null),[R,S]=w.useState(!1);w.useEffect(()=>{r(null),T([]),u([]),x(null),S(!1)},[c]);const M=N=>{r(N),T([]),u([]),x(null),S(!1),ue("fetchMetaAction",{id:N}).then(v=>{T(v.boxes)}).catch(v=>console.error(v))},A=N=>{u([]);const v=h.filter(C=>C.id===N)[0].fields;u(v)},g=N=>{x(N)},k=()=>{ue("copyMetaBlockAction",{blockId:a.id,targetFieldId:p,delete:R}).then(N=>{N.success?(xe.success(`${l("Meta block was successfully copied")}.`),m(!c),n===a.groupId&&o(Be({id:n})).then(v=>{o(Ce(v.payload)),t("id",n),t("name",v.payload.name),t("label",v.payload.label),t("display",v.payload.display),v.payload.belongs&&v.payload.belongs.map((C,F)=>{t(`belongs.${F}.id`,C.id),t(`belongs.${F}.belongsTo`,C.belongsTo),t(`belongs.${F}.operator`,C.operator),t(`belongs.${F}.find`,C.find),t(`belongs.${F}.logic`,C.logic)}),v.payload.boxes&&v.payload.boxes.map((C,F)=>{t(`boxes.${F}`,C)})}).catch(v=>{console.error(v)})):xe.error(N.error)}).catch(N=>console.error(N))};return e.jsxs(I.Fragment,{children:[e.jsx(he,{title:l("Copy this meta block"),visible:c,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:l("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:N=>M(N.target.value),children:d.find.meta.map(N=>e.jsx("option",{value:N.value,children:N.label}))})})]}),h&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"box",children:l("Meta box")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"box",className:"form-control default",onChangeCapture:N=>A(N.target.value),children:[e.jsx("option",{value:null,children:l("Select")}),h.map(N=>e.jsx("option",{value:N.id,children:N.name}))]})})]}),f&&f.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"field",children:l("Meta field")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"field",className:"form-control default",onChangeCapture:N=>g(N.target.value),children:[e.jsx("option",{value:null,children:l("Select")}),f.map(N=>e.jsx("option",{value:N.id,children:N.name}))]})})]}),p&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:R,onClick:()=>S(!R),id:"deleteBlock"}),e.jsx("label",{htmlFor:"deleteBlock",children:l("Delete the meta block after copying")})]}),e.jsx(U,{onClick:()=>k(),style:G.PRIMARY,children:l("Copy")})]})]})}),e.jsx("a",{href:"#",onClick:N=>{N.preventDefault(),m(!c)},children:e.jsx(_,{icon:"bx:copy",width:18})})]})};ia.propTypes={block:i.object.isRequired};const Fl=({boxId:a,block:s,blockIndex:d,parentFieldId:t})=>{const{group:o,closedElements:n}=H(p=>p.metaState),{formState:{errors:c},control:m}=P(),b=V({control:m,name:W(o.boxes,a,s.id)}),r=()=>n.filter(x=>x===s.id).length===1,h=z(),T=()=>{gl(s.id),r()?h(sl({id:s.id})):h(jl({id:s.id}))},f=()=>{const p={id:ce(),boxId:a,name:"meta_box_field",label:"meta box field",type:E.TEXT,defaultValue:"",description:"",isRequired:!1,showInArchive:!1,quickEdit:!1,filterableInAdmin:!1,sort:1,advancedOptions:[],options:[],blocks:[],blockId:s.id,validationRules:[],visibilityConditions:[],hasManyRelation:[],children:[],parentId:null,isATextualField:!0,isFilterable:!0,isSaved:!1};h(Pe({boxId:a,parentFieldId:null,parentBlockId:s.id,field:p})),h(sl({id:s.id}))},u=()=>!(typeof s.isSaved<"u"&&s.isSaved===!1);return e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx($,{label:e.jsx("a",{href:"#",onClick:p=>{p.preventDefault();const x=zl(a,t,b);h(il({boxId:a,parentFieldId:t,block:x})),Xe(1).then(()=>{Me(x.id)})},children:e.jsx(_,{icon:"bx:duplicate",width:18})}),tip:l("Duplicate this block"),icon:!1}),u()&&e.jsx($,{label:e.jsx(ia,{block:s}),tip:l("Copy this meta block"),icon:!1}),e.jsx($,{label:e.jsx(na,{boxId:a,blockId:s.id,blockIndex:d,parentFieldId:t}),tip:l("Delete this block"),icon:!1}),e.jsx($,{label:e.jsx("a",{href:"#",onClick:p=>{p.preventDefault(),f()},children:e.jsx(_,{icon:"bx:plus-circle",width:18})}),tip:l("Add field"),icon:!1}),e.jsx($,{label:e.jsx("a",{href:"#",onClick:p=>{p.preventDefault(),T()},children:e.jsx(_,{icon:"bx:expand-alt",width:18})}),tip:l("Hide/show this block"),icon:!1})]})};Fl.propTypes={blockIndex:i.number.isRequired,boxId:i.string.isRequired,parentFieldId:i.string,block:i.object.isRequired};const tl=({boxId:a,block:s,listeners:d,attributes:t,formId:o,boxIndex:n,blockIndex:c,parentFieldIndex:m,parentFieldId:b})=>{const{group:r,closedElements:h,selectedElementsType:T}=H(y=>y.metaState),{formState:{errors:f},register:u,control:p,resetField:x,setValue:R}=P();V({control:p,name:W(r.boxes,a,s.id)});const S=V({control:p,name:o("name")}),M=V({control:p,name:o("label")}),[A,g]=w.useState(!0),k=()=>{const y=o("name"),j=Ae(f,y);return j?e.jsx("span",{className:"invalid-feedback",children:l(j.message)}):S||s.name},N=()=>M||s.label;z();const[v,C]=w.useState(!1),F=()=>!(typeof s.isSaved<"u"&&s.isSaved===!1);return e.jsxs("div",{className:"flex-between s-8 for-xs",children:[e.jsx(be,{id:o("id"),value:s.id,register:u}),e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx($,{label:e.jsx(_,{icon:"hugeicons:blockchain-01",color:"#A972CA",width:18}),tip:l("Child block"),icon:!1}),e.jsx("span",{className:"cursor-move top-2 handle",...t,...d,children:e.jsx(_,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),T!=="box"&&T!=="field"&&F()&&e.jsx(Ue,{elementType:"block",element:{id:s.id,boxId:a,parentFieldId:b}}),e.jsx("h3",{className:`${v?"hidden":""}`,children:k()}),e.jsx("span",{className:`color-gray ${v?"hidden":""}`,children:N()}),e.jsxs("div",{className:`i-flex-center s-8 ${v?"":"hidden"}`,children:[e.jsx("div",{children:e.jsx(Z,{size:"sm",id:o("label"),placeholder:l("Block label, non latin chars allowed."),defaultValue:s.label,register:u,errors:f,onChangeCapture:y=>{A&&R(o("name"),we(Fe(y.target.value)))},onClick:y=>{y.target.value==="new-block"&&x(o("label"))},validate:{maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("div",{children:e.jsx(Z,{size:"sm",id:o("name"),placeholder:l("Block name. Allowed chars: [a-z0-9_-]"),defaultValue:s.name,register:u,errors:f,required:!0,onClick:y=>{y.target.value==="new_block"&&x(o("name"))},validate:{validate:Ke,required:l("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx($,{label:e.jsx("span",{className:`acpt-btn-switch ${A===!0?"active":""}`,onClick:y=>{y.preventDefault(),g(!A)},children:e.jsx(_,{icon:"bx-link",width:18})}),tip:l(`${A?"Auto slug ON":"Auto slug OFF"}`),icon:!1})]}),e.jsx(U,{style:G.SECONDARY,size:"sm",onClick:y=>{y.preventDefault(),C(!v)},children:l(`${v?"Close":"Edit"}`)})]}),e.jsx(Fl,{blockIndex:c,boxId:a,parentFieldId:b,block:s})]})};tl.propTypes={boxIndex:i.number.isRequired,blockIndex:i.number.isRequired,formId:i.func.isRequired,boxId:i.string.isRequired,parentFieldIndex:i.string,parentFieldId:i.string,block:i.object.isRequired,attributes:i.object,listeners:i.object};const ra=({blockIndex:a,block:s,boxIndex:d,boxId:t,parentFieldIndex:o,parentFieldId:n,isMainView:c})=>{const{attributes:m,listeners:b,setNodeRef:r,isDragging:h,transform:T}=Oe({id:s.id}),f={transform:Ie.Translate.toString(T)},{group:u,closedElements:p}=H(k=>k.metaState),x=()=>p.filter(N=>N===s.id).length===1,R=k=>`${W(u.boxes,t,s.id)}.${k}`,M=0<fl.MAX_NESTING,A=()=>x()?"hidden":"mt-24",g={background:"#eff6fc3b"};return c?e.jsx("tr",{id:s.id,className:`bg-white ${h?"b-rounded z-100 with-drop-shadow":""}`,ref:r,style:f,children:e.jsxs("td",{style:g,className:"with-active-border",colSpan:7,children:[e.jsx(tl,{formId:R,boxIndex:d,attributes:m,listeners:b,boxId:t,block:s,blockIndex:a,parentFieldId:n}),e.jsx("div",{className:A(),children:e.jsx(We,{addFieldEnabled:M,boxIndex:d,boxId:t,parentFieldIndex:o,parentFieldId:n,parentBlockId:s.id,fields:s.fields})})]})}):e.jsxs("div",{id:s.id,className:`bg-white b-rounded with-active-border p-24 ${h?"z-100 with-drop-shadow":"with-shadow"}`,ref:r,style:{...f,...g},children:[e.jsx(tl,{formId:R,boxIndex:d,attributes:m,listeners:b,boxId:t,block:s,blockIndex:a,parentFieldId:n}),e.jsx("div",{className:A(),children:e.jsx(We,{addFieldEnabled:M,boxIndex:d,boxId:t,parentFieldIndex:o,parentFieldId:n,parentBlockId:s.id,fields:s.fields})})]})};ra.propTypes={isMainView:i.bool,blockIndex:i.number.isRequired,block:i.object.isRequired,boxId:i.string.isRequired,boxIndex:i.string.isRequired,parentFieldIndex:i.number.isRequired,parentFieldId:i.string.isRequired};const oa=({blockIndex:a,block:s,boxIndex:d,boxId:t,parentFieldIndex:o,parentFieldId:n,isMainView:c})=>{const{attributes:m,listeners:b,setNodeRef:r,isDragging:h,transform:T}=Oe({id:s.id}),f={transform:Ie.Translate.toString(T)},{group:u,closedElements:p,selectedElementsType:x}=H(ee=>ee.metaState),R=z(),S=Nl(u.boxes,t,s.id),{formState:{errors:M},register:A,control:g,resetField:k,setValue:N}=P(),v=ee=>`${W(u.boxes,t,s.id)}.${ee}`;V({control:g,name:W(u.boxes,t,s.id)});const C=V({control:g,name:v("name")}),F=V({control:g,name:v("label")}),{move:y}=ie({control:g,name:v("fields")}),j=()=>{const ee=v("name"),de=Ae(M,ee);return de?e.jsx("span",{className:"invalid-feedback",children:l(de.message)}):C||s.name},O=()=>F||s.label,[B,X]=w.useState(!0),[ae,L]=w.useState(!1),[q,D]=w.useState(!1),[se,ne]=w.useState(!1),me=w.useRef(),re=w.useRef();al([me,re],()=>{L(!1),D(!1),ne(!1)});const pe=ee=>{const{active:de,over:Se}=ee;if(de.id===Se.id)return;const Te=s.fields,Ze=Te.findIndex(fe=>fe.id===de.id),el=Te.findIndex(fe=>fe.id===Se.id),_e=ye(Te,Ze,el);y(Ze,el),R(Qe({boxId:t,parentFieldId:null,parentBlockId:s.id,sortedFields:_e}))},K=()=>{if(!c||!S||S===0)return null;let ee="#a972ca";switch(S){case 1:return"#a972ca";case 2:return"#875ba2";case 3:return"#654479";default:case 4:return"#553965"}return ee},oe=()=>!(typeof s.isSaved<"u"&&s.isSaved===!1);return c?e.jsxs(I.Fragment,{children:[e.jsx(be,{id:v("id"),value:s.id,register:A}),e.jsxs("tr",{id:s.id,ref:r,style:f,className:`bg-white b-rounded ${h?"z-100 with-drop-shadow":""}`,children:[e.jsx("td",{style:{borderLeft:`5px solid ${K()}`},children:e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx($,{label:e.jsx(_,{icon:"hugeicons:blockchain-01",color:K(),width:18}),tip:l("Child block"),icon:!1}),e.jsx("span",{className:"cursor-move handle top-2",...m,...b,children:e.jsx(_,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),x!=="box"&&x!=="field"&&oe()&&e.jsx(Ue,{elementType:"block",element:{id:s.id,boxId:t,parentFieldId:n}})]})}),e.jsx("td",{children:ae?e.jsxs("div",{ref:me,className:"w-100 i-flex-center s-8",children:[e.jsx(Z,{size:"sm",id:v("label"),placeholder:l("Block label, non latin chars allowed."),defaultValue:s.label,register:A,errors:M,onChangeCapture:ee=>{B&&N(v("name"),we(Fe(ee.target.value)))},onClick:ee=>{ee.target.value==="new-block"&&k(v("label"))},validate:{maxLength:{value:255,message:"max length is 255"}}}),e.jsx($,{label:e.jsx("span",{className:`acpt-btn-switch ${B===!0?"active":""}`,onClick:ee=>{ee.preventDefault(),X(!B)},children:e.jsx(_,{icon:"bx-link",width:18})}),tip:l(`${B?"Auto slug ON":"Auto slug OFF"}`),icon:!1})]}):e.jsx("div",{className:"cursor-pointer",onClick:()=>{window.innerWidth>=960&&(L(!ae),D(!q),ne(!1))},children:O()})}),e.jsx("td",{className:"hidden-xs",children:ae?e.jsx("div",{ref:re,children:e.jsx(Z,{size:"sm",id:v("name"),placeholder:l("Block name. Allowed chars: [a-z0-9_-]"),defaultValue:s.name,register:A,errors:M,required:!0,onClick:ee=>{ee.target.value==="new_block"&&k(v("name"))},validate:{validate:Ke,required:l("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}):e.jsx("div",{className:"text-bold color-black cursor-pointer",onClick:()=>{window.innerWidth>=960&&(L(!ae),ne(!se),D(!1))},children:j()})}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{children:e.jsx(Fl,{blockIndex:a,boxId:t,parentFieldId:n,block:s})})]}),s.fields&&s.fields.length>0&&e.jsx(ge,{onDragEnd:pe,items:s.fields,children:e.jsx(I.Fragment,{children:s.fields&&s.fields.length>0&&s.fields.map((ee,de)=>e.jsx(cl,{isMainView:!0,boxIndex:d,fieldIndex:de,boxId:t,field:ee,parentBlockId:s.id}))})})]}):e.jsx("div",{id:s.id,className:`bg-white b-rounded with-shadow p-24 ${h?"z-100 with-drop-shadow":""}`,ref:r,style:f,children:e.jsx(tl,{formId:v,boxIndex:d,attributes:m,listeners:b,boxId:t,block:s,blockIndex:a,parentFieldId:n})})};oa.propTypes={isMainView:i.bool,blockIndex:i.number.isRequired,block:i.object.isRequired,boxId:i.string.isRequired,boxIndex:i.string.isRequired,parentFieldIndex:i.number.isRequired,parentFieldId:i.string.isRequired};const El=({blockIndex:a,block:s,boxIndex:d,boxId:t,parentFieldIndex:o,parentFieldId:n,isMainView:c})=>{const{closedElements:m}=H(r=>r.metaState);return(()=>{const r=m.filter(h=>h===s.id);return typeof r>"u"?!1:r.length>0})()?e.jsx(oa,{isMainView:c,blockIndex:a,block:s,boxIndex:d,boxId:t,parentFieldIndex:o,parentFieldId:n}):e.jsx(ra,{isMainView:c,blockIndex:a,block:s,boxIndex:d,boxId:t,parentFieldIndex:o,parentFieldId:n})};El.propTypes={isMainView:i.bool,blockIndex:i.number.isRequired,block:i.object.isRequired,boxId:i.string.isRequired,boxIndex:i.string.isRequired,parentFieldIndex:i.number.isRequired,parentFieldId:i.string.isRequired};const da=({boxIndex:a,fieldIndex:s,boxId:d,field:t,parentFieldIndex:o,parentFieldId:n,parentBlockId:c,isMainView:m})=>{const{attributes:b,listeners:r,setNodeRef:h,isDragging:T,transform:f}=Oe({id:t.id}),u={transform:Ie.Translate.toString(f)},p=z(),{group:x,selectedElementsType:R}=H(J=>J.metaState),{formState:{errors:S},register:M,unregister:A,resetField:g,setError:k,clearErrors:N,setValue:v,control:C}=P(),{move:F}=ie({control:C,name:`${W(x.boxes,d,t.id)}.children`}),{move:y}=ie({control:C,name:`${W(x.boxes,d,t.id)}.blocks`}),[j,O]=w.useState(!0),[B,X]=w.useState(!1),[ae,L]=w.useState(!1),[q,D]=w.useState(!1),[se,ne]=w.useState(!1),me=w.useRef(),re=w.useRef(),pe=w.useRef();al([me],()=>{L(!1)}),al([re,pe],()=>{X(!1),D(!1),ne(!1)});const K=J=>ke(x.boxes,d,t.id,J),oe=V({control:C,name:`boxes.${a}.fields`}),ee=V({control:C,name:`boxes.${a}.name`}),de=V({control:C,name:K("name")}),Se=V({control:C,name:K("label")}),Te=V({control:C,name:K("type")}),Ze=()=>{const J=K("name"),Y=Ae(S,J);return Y?e.jsx("span",{className:"invalid-feedback",children:l(Y.message)}):de||t.name},el=()=>typeof Se=="string"?Se:t.label,_e=()=>Te||t.type,fe=Nl(x.boxes,d,t.id),ss=J=>{if(_e()!==J){const Y={...t};Y.type=J,J!==E.REPEATER&&(Y.children=[]),J!==E.FLEXIBLE&&(Y.blocks=[]),J!==E.POST&&(Y.relations=[]),Jl(J)||(A(K("relations")),A(K("visibilityConditions")),A(K("validationRules")),Y.visibilityConditions=[],Y.validationRules=[],Y.relations=[]),A(K("relations")),A(K("blocks")),A(K("children")),Y.children||(Y.children=[]),Y.blocks||(Y.blocks=[]),Y.relations||(Y.relations=[]),Y.visibilityConditions||(Y.visibilityConditions=[]),Y.validationRules||(Y.validationRules=[]),p(Wl({field:Y,boxId:d}))}},ts=async J=>{if(j){const Y=we(Fe(J));v(K("name"),Y),await Ml(Y)?k(K("name"),{message:l("Name is already taken")}):N(K("name"))}},Ml=async J=>{const Y=we(Fe(J));let Re=[];if(oe.map((je,qe)=>{qe!==s&&Re.push(je.name)}),Re.includes(Y))return l("Name is already taken");if(t.name!==Y&&(await ue("checkMetaBoxFieldNameAction",{boxName:ee||t.boxName,fieldName:Y})).exists===!0)return l("Name is already taken")},ns=J=>{const{active:Y,over:Re}=J;if(Y.id===Re.id)return;const je=t.blocks,qe=je.findIndex(Ve=>Ve.id===Y.id),Ye=je.findIndex(Ve=>Ve.id===Re.id),hl=ye(je,qe,Ye);y(qe,Ye),p(Cl({boxId:d,parentFieldId:t.id,sortedBlocks:hl}))},is=J=>{const{active:Y,over:Re}=J;if(Y.id===Re.id)return;const je=t.children,qe=je.findIndex(Ve=>Ve.id===Y.id),Ye=je.findIndex(Ve=>Ve.id===Re.id),hl=ye(je,qe,Ye);F(qe,Ye),p(Qe({boxId:d,parentFieldId:t.id,parentBlockId:null,sortedFields:hl}))},Al=()=>{if(!m||!fe||fe===0)return null;let J="#02C39A";switch(fe){case 1:return"#02C39A";case 2:return"#029c7b";case 3:return"#01755c";default:case 4:return"#01624d"}return J},rs=()=>m?!fe||fe<2?24:24*fe:null;return e.jsxs(I.Fragment,{children:[e.jsx(wl,{boxId:d,field:t,parentFieldId:n,parentBlockId:c}),e.jsxs("tr",{id:t.id,ref:h,style:u,className:`bg-white b-rounded ${T?"z-100 with-drop-shadow":""}`,children:[e.jsx("td",{style:{borderLeft:`5px solid ${Al()}`,paddingLeft:`${rs()}px`},children:e.jsxs("div",{className:"i-flex-center s-8",children:[(n||c)&&e.jsx($,{label:e.jsx(_,{icon:"tabler:arrow-guide",color:Al(),width:18}),tip:l("Child field"),icon:!1}),e.jsx("span",{className:"cursor-move handle top-2",...b,...r,children:e.jsx(_,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),R!=="box"&&R!=="block"&&yl(t.isSaved)&&e.jsx(Ue,{elementType:"field",element:Sl(t,d,n,c)})]})}),e.jsx("td",{className:"hidden-xs",children:B?e.jsxs("div",{ref:re,className:"w-100 i-flex-center s-8",children:[e.jsx(Z,{id:K("label"),register:M,errors:S,autoFocus:q,defaultValue:t.label,placeholder:l("The field label, non latin characters are allowed"),onChangeCapture:Tl(J=>{ts(J.target.value)},300),onClick:J=>{J.target.value==="meta box field"&&g(K("label"))},validate:{maxLength:{value:255,message:"max length is 255"}}}),e.jsx($,{label:e.jsx("span",{className:`acpt-btn-switch ${j===!0?"active":""}`,onClick:J=>{J.preventDefault(),O(!j)},children:e.jsx(_,{icon:"bx-link",width:18})}),tip:l(`${j?"Auto slug ON":"Auto slug OFF"}`),icon:!1})]}):e.jsx("div",{className:"cursor-pointer",onClick:()=>{window.innerWidth>=960&&(X(!B),D(!q),ne(!1))},children:el()})}),e.jsx("td",{children:B?e.jsx("div",{ref:pe,children:e.jsx(Z,{id:K("name"),register:M,errors:S,autoFocus:se,placeholder:l("Field slug (Ex. gallery or text_1)"),defaultValue:t.name,onClick:J=>{J.target.value==="meta_box_field"&&g(K("name"))},validate:{validate:{alphanumericallyValid:Ke,checkIfNameIsValid:Ml},required:l("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}):e.jsx("div",{className:"text-bold color-black cursor-pointer",onClick:()=>{window.innerWidth>=960&&(X(!B),ne(!se),D(!1))},children:Ze()})}),e.jsx("td",{className:"hidden-xs",children:e.jsx(kl,{field:t,boxId:d})}),e.jsx("td",{children:ae?e.jsx("div",{ref:me,style:{maxWidth:"200px"},children:e.jsx(le,{register:M,id:K("type"),errors:S,defaultValue:t.type,values:$l(fe),onChangeCapture:J=>{ss(J.target.value)}})}):e.jsxs("div",{className:"i-flex-center s-8 cursor-pointer",onClick:()=>{window.innerWidth>=960&&L(!ae)},children:[e.jsx(dl,{fieldType:_e(),css:"with-border b-rounded p-8"}),Te===E.REPEATER&&t.children&&t.children.length>0&&e.jsx("span",{className:"px-8 py-4 font-sm bg-light-gray text-normal b-rounded",children:t.children.length}),Te===E.FLEXIBLE&&t.blocks&&t.blocks.length>0&&e.jsx("span",{className:"px-8 py-4 font-sm bg-light-gray text-normal b-rounded",children:t.blocks.length})]})}),e.jsx("td",{children:e.jsx(Rl,{boxIndex:a,field:t,boxId:d,fieldIndex:s,parentFieldIndex:o,parentFieldId:n,parentBlockId:c})})]}),xl(_e())&&t.children&&e.jsx(ge,{onDragEnd:is,items:t.children,children:e.jsx(I.Fragment,{children:t.children&&t.children.length>0&&t.children.map((J,Y)=>e.jsx(cl,{isMainView:!0,boxIndex:a,fieldIndex:Y,boxId:d,field:J,parentFieldIndex:s,parentFieldId:t.id}))})}),vl(_e())&&t.blocks&&e.jsx(ge,{onDragEnd:ns,items:t.blocks,children:e.jsx(I.Fragment,{children:t.blocks&&t.blocks.length>0&&t.blocks.map((J,Y)=>e.jsx(El,{isMainView:!0,blockIndex:Y,block:J,boxIndex:a,boxId:d,parentFieldIndex:o,parentFieldId:t.id}))})})]})};da.propTypes={boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,field:i.object.isRequired,parentFieldIndex:i.string,parentFieldId:i.string,parentBlockId:i.string};const ca=({boxId:a,fieldId:s,optionId:d,parentFieldId:t,optionIndex:o})=>{const n=z(),{group:c}=H(u=>u.metaState),m=()=>`${W(c.boxes,a,s)}.options`,[b,r]=w.useState(!1),{control:h}=P(),{remove:T}=ie({control:h,name:m()}),f=[e.jsx(U,{style:G.SUCCESS,onClick:u=>{u.preventDefault(),n(fs({boxId:a,fieldId:s,parentFieldId:t,optionId:d})),T(o),r(!b)},children:l("Yes")}),e.jsx(U,{style:G.DANGER,onClick:u=>{u.preventDefault(),r(!b)},children:l("No")})];return e.jsxs("span",{children:[e.jsx(he,{title:l("Confirm deleting option"),visible:b,buttons:f,children:l("Are you sure?")}),e.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),r(!b)},children:e.jsx($,{icon:!1,tip:l("Delete"),label:e.jsx(_,{icon:"bx-trash",width:18,color:"#F94144"})})})]})};ca.propTypes={boxId:i.string.isRequired,fieldId:i.string.isRequired,parentFieldId:i.string,optionId:i.string.isRequired,optionIndex:i.number.isRequired};const ua=({index:a,boxIndex:s,fieldIndex:d,boxId:t,fieldId:o,parentFieldId:n,option:c,handleIsDefault:m})=>{const{group:b}=H(B=>B.metaState),r=B=>n?`${W(b.boxes,t,o)}.options.${a}.${B}`:`boxes.${s}.fields.${d}.options.${a}.${B}`,{register:h,formState:{errors:T},control:f,setValue:u,resetField:p}=P(),x=V({control:f,name:r("value")}),R=V({control:f,name:r("label")}),S=V({control:f,name:r("isDefault")}),{attributes:M,listeners:A,setNodeRef:g,isDragging:k,transform:N}=Oe({id:c.id}),v={transform:Ie.Translate.toString(N)},C=()=>c.label==="label"&&c.value==="value"?!0:c.label===c.value,[F,y]=w.useState(C()),j=()=>x||(c.value?c.value:null),O=()=>R||(c.label?c.label:null);return e.jsxs(I.Fragment,{children:[e.jsx(be,{id:r("id"),value:c.id,register:h}),e.jsxs("tr",{style:v,ref:g,className:`bg-white ${k?"b-rounded z-100 with-drop-shadow":""}`,children:[e.jsx("td",{children:e.jsx("span",{className:"cursor-move top-2 handle",...M,...A,children:e.jsx(_,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})})}),e.jsx("td",{children:e.jsx(Z,{id:r("label"),register:h,errors:T,defaultValue:O(),onChangeCapture:B=>{F&&u(r("value"),B.target.value)},onClick:B=>{c.label&&B.target.value==="label"&&p(r("label"))},validate:{required:l("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("td",{children:e.jsx(Z,{id:r("value"),register:h,errors:T,defaultValue:j(),onChangeCapture:B=>{F&&u(r("label"),B.target.value)},onClick:B=>{c.value&&B.target.value==="value"&&p(r("value"))},validate:{required:l("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("td",{children:e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx($,{label:e.jsx("button",{type:"button",className:`acpt-btn-switch ${F?"active":""}`,onClick:B=>{B.preventDefault(),y(!F)},children:e.jsx(_,{icon:"bx:bx-link",width:"18px"})}),tip:l(F?"Label and value are linked":"Label and value are unlinked"),icon:!1}),e.jsx($,{label:e.jsx(De,{control:f,defaultValue:typeof S=="boolean"?S:c.isDefault,errors:T,icon:"bx:check",id:r("isDefault"),externalOnChange:m}),tip:l("Default value"),icon:!1})]})}),e.jsx("td",{children:e.jsx(ca,{boxId:t,fieldId:o,optionId:c.id,parentFieldId:n,optionIndex:a})})]})]})};ua.propTypes={index:i.number.isRequired,boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,fieldId:i.string.isRequired,parentFieldId:i.string,option:i.object.isRequired,handleIsDefault:i.func};const bl=({boxId:a,fieldId:s,parentFieldId:d})=>{const t=z(),[o,n]=w.useState(!1),[c,m]=w.useState(null),[b,r]=w.useState(null),[h,T]=w.useState(!1);w.useEffect(()=>{h&&(n(!0),ue("fetchDatasetsAction",{}).then(p=>{let x=[{value:null,label:l("Select"),items:[]}];p.records&&p.records.map(R=>{x.push({value:R.id,label:R.label?R.label:R.name,items:R.items?R.items:[]})}),m(x),n(!1)}).catch(p=>{console.error(p.message),n(!1)}))},[h]);const f=()=>{const p=c.filter(R=>R.value===b);if(p&&p.length!==1)return;p[0].items.map(R=>{const S={id:ce(),boxId:a,fieldId:s,label:R.label,value:R.value,isDefault:R.isDefault};t(Xl({boxId:a,fieldId:s,parentFieldId:d,option:S}))}),xe.success(l("Dataset loaded correctly")),T(!h)},u=[e.jsx(U,{style:G.PRIMARY,disabled:b===null,onClick:p=>{p.preventDefault(),f()},children:l("Load dataset")}),e.jsx(U,{style:G.DANGER,onClick:p=>{p.preventDefault(),T(!h)},children:l("Close")})];return e.jsxs(I.Fragment,{children:[e.jsx(he,{title:l("Load dataset"),visible:h,padding:0,buttons:u,children:o?e.jsx("div",{className:"p-24",children:l("Loading...")}):e.jsx("div",{className:"p-24",children:e.jsx("select",{id:"dataset",className:"form-control default",onChangeCapture:p=>r(p.target.value),children:c&&c.map(p=>e.jsx("option",{value:p.value,children:p.label}))})})}),e.jsx("a",{href:"#",onClick:p=>{p.preventDefault(),T(!h)},children:l("Load dataset")})]})};bl.propTypes={boxId:i.string.isRequired,fieldId:i.string.isRequired,parentFieldId:i.string.isRequired};const ha=({boxId:a,boxIndex:s,fieldIndex:d,fieldId:t,parentFieldId:o,options:n,isMulti:c})=>{const m=document.globals;m.settings;const b=m.globals,r=z(),{group:h}=H(g=>g.metaState),[T]=Ne(),f=()=>`${W(h.boxes,a,t)}.options`,{control:u,setValue:p,resetField:x}=P(),{move:R}=ie({control:u,name:f()}),S=g=>{const{active:k,over:N}=g;if(k.id===N.id)return;const v=n.findIndex(F=>F.id===k.id),C=n.findIndex(F=>F.id===N.id);R(v,C)},M=()=>{const g={id:ce(),boxId:a,fieldId:t,label:"label",value:"value",isDefault:!1};r(Xl({boxId:a,fieldId:t,parentFieldId:o,option:g}))},A=({id:g,checked:k})=>{if(!c)for(let N=0;N<n.length;N++){const v=f()+"."+N+".isDefault";v!==g?p(v,!1):p(v,k)}};return e.jsxs("div",{className:"mt-24",children:[e.jsx("label",{className:"form-label",children:l("Options")}),n&&n.length>0?e.jsxs("div",{className:"responsive with-shadow b-rounded",children:[e.jsxs("table",{className:`acpt-table ${b.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"10px"}}),e.jsx("th",{children:l("Label")}),e.jsx("th",{children:l("Value")}),e.jsx("th",{style:{width:"10px"}}),e.jsx("th",{style:{width:"10px"}})]})}),e.jsx("tbody",{ref:T,children:e.jsx(ge,{onDragEnd:S,items:n,children:n&&n.map((g,k)=>e.jsx(ua,{index:k,boxIndex:s,fieldIndex:d,boxId:a,fieldId:t,parentFieldId:o,option:g,handleIsDefault:A}))})})]}),e.jsxs("div",{className:"p-24 i-flex-center s-8",children:[e.jsx("a",{href:"#",onClick:g=>{g.preventDefault(),M()},children:l("Add option")}),e.jsx(bl,{boxId:a,fieldId:t,parentFieldId:o})]})]}):e.jsxs("div",{className:"mt-8 b-maxi b-rounded p-24 flex-column s-12 text-center",children:[e.jsx("span",{children:l('No options already created. Create the first one now by clicking the button "Add option"!')}),e.jsxs("div",{className:"i-flex-center justify-center s-8",children:[e.jsx("a",{href:"#",onClick:g=>{g.preventDefault(),M()},children:l("Add option")}),e.jsx(bl,{boxId:a,fieldId:t,parentFieldId:o})]})]})]})};ha.propTypes={boxId:i.string.isRequired,fieldId:i.string.isRequired,parentFieldId:i.string,boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,options:i.array.isRequired,isMulti:i.bool.isRequired};const ma=({boxId:a,boxIndex:s,parentFieldIndex:d,parentFieldId:t,childrenFields:o,nestingLevel:n})=>{const c=n<fl.MAX_NESTING;return e.jsxs("div",{className:"mt-24",children:[e.jsx("label",{className:"form-label",children:l("Children")}),e.jsx(We,{addFieldEnabled:c,boxIndex:s,boxId:a,parentFieldIndex:d,parentFieldId:t,fields:o})]})};ma.propTypes={boxId:i.string.isRequired,parentFieldId:i.string.isRequired,boxIndex:i.number.isRequired,parentFieldIndex:i.number.isRequired,childrenFields:i.array.isRequired,nestingLevel:i.number.isRequired};const pa=({boxIndex:a,boxId:s,blocks:d,parentFieldIndex:t,parentFieldId:o,addBlockEnabled:n=!0})=>{const c=z(),{group:m}=H(f=>f.metaState),{control:b}=P(),{move:r}=ie({control:b,name:`${W(m.boxes,s,o)}.blocks`}),h=f=>{const{active:u,over:p}=f;if(u.id===p.id)return;const x=d.findIndex(M=>M.id===u.id),R=d.findIndex(M=>M.id===p.id),S=ye(d,x,R);r(x,R),c(Cl({boxId:s,parentFieldId:o,sortedBlocks:S}))},T=()=>{const f={id:ce(),boxId:s,fieldId:o,label:"new-block",name:"new_block",fields:[],isSaved:!1};c(il({boxId:s,parentFieldId:o,block:f}))};return e.jsx(I.Fragment,{children:d&&d.length>0?e.jsxs(I.Fragment,{children:[e.jsx("div",{className:"s-24 flex-column",children:e.jsx(ge,{onDragEnd:h,items:d,children:d&&d.map((f,u)=>e.jsx(El,{parentFieldId:o,boxIndex:a,parentFieldIndex:t,blockIndex:u,boxId:s,block:f}))})}),n&&e.jsx("div",{className:"mt-24",children:e.jsx(U,{type:"button",style:G.SECONDARY,onClick:f=>{f.preventDefault(),T()},children:l("Add block")})})]}):e.jsxs("div",{className:"mt-24 b-maxi b-rounded p-24 flex-column s-12 text-center",children:[e.jsx("span",{children:l('No blocks already created. Create the first one now by clicking the button "Add block"!')}),n&&e.jsx("div",{children:e.jsx(U,{type:"button",style:G.SECONDARY,onClick:f=>{f.preventDefault(),T()},children:l("Add block")})})]})})};pa.propTypes={boxIndex:i.number.isRequired,boxId:i.string.isRequired,blocks:i.array.isRequired,parentFieldIndex:i.string,parentFieldId:i.string,addBlockEnabled:i.bool};const ba=({boxId:a,boxIndex:s,parentFieldIndex:d,parentFieldId:t,blocks:o,nestingLevel:n})=>{const c=n<fl.MAX_NESTING,[m]=Ne();return e.jsxs("div",{ref:m,className:"mt-24",children:[e.jsx("label",{className:"form-label",children:l("Blocks")}),e.jsx(pa,{addBlockEnabled:c,boxIndex:s,boxId:a,parentFieldIndex:d,parentFieldId:t,blocks:o})]})};ba.propTypes={boxId:i.string.isRequired,parentFieldId:i.string.isRequired,boxIndex:i.number.isRequired,parentFieldIndex:i.number.isRequired,blocks:i.array.isRequired,nestingLevel:i.number.isRequired};const xa="OneToOneUni",va="OneToOneBi",fa="OneToManyUni",ga="OneToManyBi",ja="ManyToOneUni",ya="ManyToOneBi",Na="ManyToManyUni",Sa="ManyToManyBi",ot=[{value:null,label:l("Select")},{value:xa,label:l("One to One - Unidirectional")},{value:va,label:l("One to One - Bidirectional")},{value:fa,label:l("One to Many - Unidirectional")},{value:ga,label:l("One to Many - Bidirectional")},{value:ja,label:l("Many to One - Unidirectional")},{value:ya,label:l("Many to One - Bidirectional")},{value:Na,label:l("Many to Many - Unidirectional")},{value:Sa,label:l("Many to Many - Bidirectional")}],dt=[{value:null,label:l("Select")},{value:xa,label:l("One to One - Unidirectional")},{value:fa,label:l("One to Many - Unidirectional")},{value:ja,label:l("Many to One - Unidirectional")},{value:Na,label:l("Many to Many - Unidirectional")}],Ll=a=>a===va||a===ga||a===ya||a===Sa,Ca=({field:a,formId:s})=>{const o=document.globals.globals.find,n=a.relations&&a.relations.length>0?a.relations[0]:null,{control:c,register:m,resetField:b,setValue:r,formState:{errors:h}}=P(),T=V({control:c,name:s("relations.0.relationship")}),f=V({control:c,name:"id"}),[u,p]=w.useState([]),[x,R]=w.useState([]),[S,M]=w.useState([]);w.useEffect(()=>{ue("fetchMetaAction",{excludeField:a.id}).then(v=>{let C=[],F=[{label:l("Select"),value:null}];v.records&&v.records.length>0&&v.records.filter(y=>y.id!==f).map(y=>{let j=[];y.boxes.map(O=>{C.push(O),j.push({label:O.UIName+" ("+y.name+")",value:O.id})}),j&&j.length>0&&F.push({label:y.name,options:j})}),p(C),R(F),n&&n.inversedBoxId&&k(n.inversedBoxId,C)}).catch(v=>console.error(v))},[]);const A=v=>{Ll(v)||(b(s("relations.0.inversedBoxId")),b(s("relations.0.inversedFieldId")))},g=(v,C)=>{r(s(`relations.0.${v}.type`),C),b(s("relations.0.relationship")),b(s("relations.0.inversedBoxId")),b(s("relations.0.inversedFieldId"))},k=(v,C)=>{let F=[{label:l("Select"),value:null}];const y=C.filter(j=>j.id===v);y&&y.length===1&&y[0].fields.map(j=>{F.push({label:j.name,value:j.id}),j.blocks&&j.blocks.length>0&&j.blocks.map(O=>{O.fields&&O.fields.length>0&&O.fields.map(B=>{F.push({label:B.name,value:B.id}),B.blocks&&B.blocks.length>0&&B.blocks.map(X=>{X.fields&&X.fields.length>0&&X.fields.map(ae=>{F.push({label:ae.name,value:ae.id})})})})}),j.children&&j.children.length>0&&j.children.map(O=>{F.push({label:O.name,value:O.id}),O.children&&O.children.length>0&&O.children.map(B=>{F.push({label:B.name,value:B.id})})})}),M(F)};if(ve(o))return null;const N=()=>{let v=[{label:l("Select"),value:null}];const C=o[te.CUSTOM_POST_TYPE].filter(y=>y.value!==null),F=o[te.TAXONOMY].filter(y=>y.value!==null);return C&&C.length>0&&v.push({label:l("Custom post types"),originalLabel:te.CUSTOM_POST_TYPE,options:C}),F&&F.length>0&&v.push({label:l("Taxonomies"),originalLabel:te.TAXONOMY,options:F}),v.push({label:l("Option pages"),originalLabel:te.OPTION_PAGE,options:[{label:l("All pages"),value:te.OPTION_PAGE}]}),v.push({label:l("Users"),originalLabel:te.USER,options:[{label:l("All users"),value:te.USER}]}),v};return e.jsxs("div",{className:"mt-24",children:[e.jsx(be,{id:s("relations.0.relatedEntity.type"),value:a.type,register:m}),e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Related entities and relationship")}),e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-4",children:[e.jsx("div",{className:"mb-8",children:e.jsx($,{label:e.jsx("label",{className:"form-label",htmlFor:s("relations.0.from.value"),children:l("From")}),tip:l("The first entity involved in the relationship")})}),e.jsx(le,{register:m,id:s("relations.0.from.value"),errors:h,values:N(),onChangeCapture:v=>{g("from",v.target.selectedOptions[0].parentElement.dataset.original)},validate:{required:l("This field is mandatory")}})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("div",{className:"mb-8",children:e.jsx($,{label:e.jsx("label",{className:"form-label",htmlFor:s("relations.0.to.value"),children:l("To")}),tip:l("The second entity involved in the relationship")})}),e.jsx(le,{register:m,id:s("relations.0.to.value"),errors:h,values:N(),onChangeCapture:v=>{g("to",v.target.selectedOptions[0].parentElement.dataset.original)},validate:{required:l("This field is mandatory")}})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("div",{className:"mb-8",children:e.jsx($,{label:e.jsx("label",{className:"form-label",htmlFor:s("relations.0.relationship"),children:l("Relationship")}),tip:l("The relationship between the selected entities")})}),e.jsx(le,{register:m,id:s("relations.0.relationship"),errors:h,values:a.parentId?dt:ot,onChangeCapture:v=>{A(v.target.value)},validate:{required:l("This field is mandatory")}})]})]}),Ll(T)&&e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"mb-8",children:e.jsx($,{label:e.jsxs("label",{className:"form-label",htmlFor:s("relations.0.inversedBoxId"),children:[l("Target field"),". ",l("Select field box from list")]}),tip:l("The inversed field is the target post type field which is related with this one in a bidirectional relation")})}),e.jsx(le,{register:m,id:s("relations.0.inversedBoxId"),errors:h,values:x,defaultValue:n&&n.inversedBoxId?n.inversedBoxId:null,onChangeCapture:v=>{k(v.target.value,u)},validate:{required:l("This field is mandatory")}})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"mb-8",children:e.jsx($,{label:e.jsxs("label",{className:"form-label",htmlFor:s("relations.0.inversedFieldId"),children:[l("Target field"),". ",l("Select the inversed field on target")]}),tip:l("The inversed field is the target post type field which is related with this one in a bidirectional relation")})}),e.jsx(le,{register:m,id:s("relations.0.inversedFieldId"),errors:h,values:S,defaultValue:n&&n.inversedFieldId?n.inversedFieldId:null,validate:{required:l("This field is mandatory")}})]})]})]})]})]})};Ca.propTypes={formId:i.func.isRequired,field:i.object.isRequired};const Ta=({size:a="default",placeholder:s,id:d,defaultValue:t,description:o,readOnly:n,onChangeCapture:c,validate:m,register:b,errors:r,rows:h=8,disabled:T=!1,characterLimit:f=null})=>{const u=Ae(r,d),[p,x]=w.useState(t),R=()=>{if(!f||!p)return"";const S=f-p.length;return S<=3?"color-danger":S<=10?"color-warning":""};return e.jsxs(I.Fragment,{children:[e.jsxs("div",{className:"acpt-textarea",children:[e.jsx("textarea",{rows:h||8,id:d,"data-cy":`textarea-${d}`,name:d,disabled:T,defaultValue:t,placeholder:s,onChangeCapture:S=>{x(S.target.value),c&&c(S)},readOnly:n,maxLength:f,"aria-invalid":u?"true":"false",className:`form-control ${a} ${u?"has-errors":""}`,...b(d,m)}),f&&e.jsxs("div",{className:"acpt-character-limit mt-4",children:[e.jsx("span",{className:R(),children:p.length}),e.jsx("span",{children:"/"}),e.jsx("span",{children:f})]})]}),u&&e.jsx("div",{className:"invalid-feedback",children:u.message}),o&&e.jsx("div",{className:"form-description",children:o})]})};Ta.propTypes={id:i.string.isRequired,size:i.oneOf(["default","sm"]),innerRef:i.func,placeholder:i.string,defaultValue:i.string,description:i.string,readOnly:i.bool,onChangeCapture:i.func,validate:i.func,register:i.func.isRequired,errors:i.array.isRequired,disabled:i.bool,rows:i.number,characterLimit:i.number};const Ra=({id:a,defaultValue:s,description:d,validate:t,onChangeCapture:o,register:n,errors:c})=>{const m=Ae(c,a),[b,r]=w.useState(s);return e.jsxs(I.Fragment,{children:[e.jsxs("div",{className:"flex-column s-8",children:[e.jsxs("div",{className:"acpt-color-picker",children:[e.jsx("input",{id:a,"data-cy":`input-${a}`,name:a,type:"color",defaultValue:s,onChangeCapture:h=>{r(h.target.value),o&&o(h)},"aria-invalid":m?"true":"false",className:`${m?"has-errors":""}`,...n(a,t)}),e.jsx("span",{className:"color-value",children:b})]}),m&&e.jsx("div",{className:"invalid-feedback",children:m.message})]}),d&&e.jsx("div",{className:"form-description",children:d}),m&&e.jsx("div",{className:"invalid-feedback",children:m.message})]})};Ra.propTypes={id:i.string.isRequired,description:i.string,defaultValue:i.string,onChangeCapture:i.func,validate:i.func,register:i.func.isRequired,errors:i.array.isRequired};const ka=({handleDeleteField:a,clonedFieldId:s,meta:d})=>{const o=(()=>{let n=null,c=null;return d.map(m=>{m.boxes&&m.boxes.map(b=>{b.fields&&b.fields.map(r=>{r.id===s&&(n=`[${b.label?b.label:b.name}] - ${r.label?r.label:r.name}`,c=r.type)})})}),{label:n,type:c}})();return e.jsxs("div",{className:"i-flex-center s-12 bg-pale-gray b-rounded p-12",children:[e.jsxs("div",{className:"i-flex-center s-4",children:[e.jsx("span",{children:o.label?o.label:"Loading..."}),o.type&&e.jsx(dl,{fieldType:o.type,css:"with-border b-rounded p-8"})]}),e.jsx($,{label:e.jsx("a",{href:"#",onClick:n=>{n.preventDefault(),a&&a(s)},children:e.jsx(_,{icon:"bx-trash",width:18,color:"#F94144"})}),tip:l("Delete this meta field"),icon:!1})]})};ka.propTypes={meta:i.array.isRequired,handleDeleteField:i.object,clonedFieldId:i.string.isRequired};const wa=({fields:a,meta:s,id:d})=>{const{setValue:t}=P(),o=n=>{const c=a.filter(m=>m!==n);t(d,c)};return!a||a.length===0?null:e.jsx("div",{className:"flex flex-wrap justify-center s-8",children:a&&a.length>0&&a.map(n=>e.jsx(ka,{meta:s,clonedFieldId:n,handleDeleteField:o}))})};wa.propTypes={id:i.string.isRequired,meta:i.array.isRequired,fields:i.array.isRequired};const Fa=({id:a,group:s,field:d,gindex:t,watchedDefaultValueObject:o})=>{const m=document.globals.globals.is_rtl,{setValue:b}=P(),r=u=>{let p=[];return u.boxes&&u.boxes.map(x=>{x.fields&&x.fields.map(R=>{R.id!==d.id&&p.push(R.id)})}),p},h=(u,p)=>{u.id&&p&&(p==="deselect"?b(a,Ol(o.filter(x=>!r(u).includes(x)))):p==="select"&&b(a,Ol([...o,...r(u)])))},T=(u,p)=>{const x=o;u?(x.push(p),b(a,x)):b(a,x.filter(R=>R!==p))},f=u=>{const p=o;return ve(p)?!1:p.includes(u)};return r(s).length===0?null:e.jsxs("table",{id:s.id,className:`acpt-table with-border ${m?"rtl":""}`,children:[s.id!==null&&e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{style:{padding:"12px 24px"},colSpan:2,children:e.jsxs("div",{className:"flex-center flex-between s-8",children:[e.jsx("span",{children:s.name}),e.jsx("div",{children:e.jsxs("select",{className:"form-control sm",onChangeCapture:u=>{u.preventDefault();const p=u.target.value;p&&h(s,p)},children:[e.jsx("option",{value:null,children:l("Action")}),e.jsx("option",{value:"select",children:l("Select all")}),e.jsx("option",{value:"deselect",children:l("Deselect all")})]})})]})})})}),s.boxes&&s.boxes.length>0&&s.boxes.map((u,p)=>e.jsx("tbody",{children:u.fields&&u.fields.length>0&&u.fields.map((x,R)=>x.id!==d.id?e.jsx(I.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{id:x.id,width:10,children:e.jsxs("label",{className:"checkbox",htmlFor:`${a}_${t}_${p}_${R}`,children:[e.jsx("input",{name:a,type:"checkbox",id:`${a}_${t}_${p}_${R}`,checked:f(x.id),value:x.id,onChangeCapture:S=>T(S.target.checked,x.id)}),e.jsx("span",{})]})}),e.jsx("td",{children:e.jsxs("div",{className:"i-flex-center s-4",children:[e.jsxs("label",{htmlFor:`${a}_${t}_${p}_${R}`,className:"cursor-pointer text-ellipsis",children:["[",u.label?u.label:u.name,"] - ",x.label?x.label:x.name]}),e.jsx(dl,{fieldType:x.type,css:"with-border b-rounded p-8"})]})})]})}):e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:l("No boxes registered")})}))}))]})};Fa.propTypes={id:i.string.isRequired,gindex:i.number.isRequired,watchedDefaultValueObject:i.object.isRequired,field:i.object.isRequired,group:i.object.isRequired};const Ea=({id:a,field:s})=>{document.globals.globals.is_rtl;const{control:o,getValues:n}=P(),[c,m]=w.useState(!1),[b,r]=w.useState([]),[h,T]=w.useState(!1),f=V({control:o,name:a}),u=()=>{if(f){if(typeof f=="object")return f;try{return JSON.parse(f)}catch{try{return JSON.parse(`["${f}"]`)}catch{return[]}}}return[]};w.useEffect(()=>{p()},[]),w.useEffect(()=>{c===!0&&p()},[c]);const p=()=>{T(!0),ue("fetchMetaAction",{page:1,perPage:999}).then(R=>{let S=[];R.records&&R.records.length>0&&(S=R.records);const M=n();S&&S.length>0&&S.map((A,g)=>{M.id===A.id&&(S[g]=M)}),r(S),T(!1)}).catch(R=>{console.error(R),T(!1)})},x=[e.jsx(U,{style:G.DANGER,onClick:R=>{R.preventDefault(),m(!c)},children:l("Close")})];return e.jsxs(I.Fragment,{children:[e.jsx(he,{title:l("Select fields to clone"),visible:c,buttons:x,children:e.jsx(I.Fragment,{children:h?e.jsx("div",{className:"p-24 text-center",children:"Loading..."}):e.jsx(I.Fragment,{children:b&&b.length>0?e.jsx("div",{className:"flex-column s-24",children:e.jsx("div",{className:"flex-column s-24",style:{maxHeight:"450px",overflowY:"auto",overflowX:"hidden",padding:"0 12px"},children:b.map((R,S)=>e.jsx(Fa,{group:R,field:s,id:a,gindex:S,watchedDefaultValueObject:u()}))})}):e.jsx(rl,{style:G.SECONDARY,children:l("No fields registered.")})})})}),e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Fields to clone")}),e.jsxs("div",{style:{alignItems:"center"},className:"flex-column s-24",children:[h?e.jsx("div",{children:"Loading..."}):e.jsx(I.Fragment,{children:u()&&typeof u()=="object"&&u().length>0&&e.jsx(wa,{fields:u(),meta:b,id:a})}),e.jsx("a",{style:{margin:"auto"},className:"acpt-btn acpt-btn acpt-btn-secondary",href:"#",onClick:R=>{R.preventDefault(),m(!c)},children:e.jsxs("div",{className:"i-flex-center s-4",children:[e.jsx(_,{icon:"bx:bx-copy-alt",width:18}),e.jsx("span",{children:l("Select fields to clone")})]})})]})]})]})};Ea.propTypes={field:i.object.isRequired};const Ma=({formId:a,field:s})=>{const{register:d,control:t,formState:{errors:o},setValue:n,clearErrors:c}=P(),m=V({control:t,name:a("advancedOptions")});V({control:t,name:a("defaultValue")});const r=os(s.defaultValue)?JSON.parse(s.defaultValue):s.defaultValue,[h,T]=w.useState(r.from?r.from:null),[f,u]=w.useState(r.to?r.to:null),[p,x]=w.useState(r.url?r.url:null),[R,S]=w.useState(r.urlLabel?r.urlLabel:null),[M,A]=w.useState(r.currencyValue?r.currencyValue:null),[g,k]=w.useState(r.currency?r.currency:null),[N,v]=w.useState(r.length?r.length:null),[C,F]=w.useState(r.lengthValue?r.lengthValue:null),[y,j]=w.useState(r.weight?r.weight:null),[O,B]=w.useState(r.weightValue?r.weightValue:null),X=[E.ICON,E.TABLE,E.REPEATER,E.FLEXIBLE,E.PASSWORD,E.POST,E.SELECT_MULTI,E.SELECT,E.RADIO,E.CHECKBOX,E.FILE,E.IMAGE,E.GALLERY,E.VIDEO],ae=(L,q)=>L?e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(Ge,{id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="object"?r:null,values:q,clearErrors:c,setValue:n})]})}):e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(le,{id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,values:q})]})});if(!s.type||X.includes(s.type))return null;if(s.type===E.EMAIL)return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(Z,{type:"email",id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,validate:{maxLength:{value:255,message:"max length is 255"}}})]})});if(s.type===E.DATE)return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(Z,{type:"date",id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,validate:{maxLength:{value:255,message:"max length is 255"}}})]})});if(s.type===E.DATE_TIME)return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(Z,{type:"datetime-local",id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,validate:{maxLength:{value:255,message:"max length is 255"}}})]})});if(s.type===E.TIME)return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(Z,{type:"time",id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,validate:{maxLength:{value:255,message:"max length is 255"}}})]})});if(s.type===E.COLOR)return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(Ra,{id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,validate:{maxLength:{value:255,message:"max length is 255"}}})]})});if(s.type===E.HTML)return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(tt,{value:r,height:"250px",editable:!0,theme:"light",onChange:L=>{n(a("defaultValue"),L)}})]})});if(s.type===E.RANGE||s.type===E.NUMBER){const L=m&&m[8]&&m[8].value!==""?m[8].value:1,q=m&&m[9]&&m[9].value!==""?m[9].value:100,D=m&&m[10]&&m[10].value!==""?m[10].value:1;return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(Z,{type:"number",min:L,max:q,step:D,id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,validate:{maxLength:{value:255,message:"max length is 255"}}})]})})}if(s.type===E.RATING)return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(le,{type:"number",id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,values:[{label:"5.00/5.00",value:10},{label:"4.50/5.00",value:9},{label:"4.00/5.00",value:8},{label:"3.50/5.00",value:7},{label:"3.00/5.00",value:6},{label:"2.50/5.00",value:5},{label:"2.00/5.00",value:4},{label:"1.50/5.00",value:3},{label:"1.00/5.00",value:2},{label:"0.50/5.00",value:1}]})]})});if(s.type===E.TOGGLE)return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle",htmlFor:a("defaultValue"),children:[e.jsx("input",{id:a("defaultValue"),name:a("defaultValue"),type:"checkbox",defaultChecked:r==1,onChangeCapture:L=>{n(a("defaultValue"),L.target.checked?"1":"0")}}),e.jsx("span",{className:"slider round"})]})})]})});if(s.type===E.CURRENCY){const L=document.globals.globals.uom.currency;return e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-3",children:[e.jsx(Q,{id:a("defaultValue_currency_value"),label:l("The default value for this field")}),e.jsx("input",{id:a("defaultValue_currency_value"),name:a("defaultValue_currency_value"),type:"number",min:.01,step:.01,className:"form-control",defaultValue:M,onChangeCapture:q=>{A(q.target.value),n(a("defaultValue"),JSON.stringify({currency:g,currencyValue:q.target.value}))}})]}),e.jsxs("div",{className:"col-3",children:[e.jsx(Q,{id:a("defaultValue_currency"),label:" "}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:a("defaultValue_currency"),name:a("defaultValue_currency"),placeholder:l("Currency"),defaultValue:g||"USD",className:"form-control",onChangeCapture:q=>{k(q.target.value),n(a("defaultValue"),JSON.stringify({currencyValue:M,currency:q.target.value}))},children:L&&L.map((q,D)=>e.jsx("option",{value:q.value,children:q.label},D))})})]})]})}if(s.type===E.LENGTH){const L=document.globals.globals.uom.length;return e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-3",children:[e.jsx(Q,{id:a("defaultValue_length_value"),label:l("The default value for this field")}),e.jsx("input",{id:a("defaultValue_length_value"),name:a("defaultValue_length_value"),type:"number",min:.01,step:.01,className:"form-control",defaultValue:C,onChangeCapture:q=>{F(q.target.value),n(a("defaultValue"),JSON.stringify({length:N,lengthValue:q.target.value}))}})]}),e.jsxs("div",{className:"col-3",children:[e.jsx(Q,{id:a("defaultValue_length"),label:" "}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:a("defaultValue_length"),name:a("defaultValue_length"),placeholder:l("Length"),defaultValue:N||" KILOMETER",className:"form-control",onChangeCapture:q=>{v(q.target.value),n(a("defaultValue"),JSON.stringify({lengthValue:C,length:q.target.value}))},children:L&&L.map((q,D)=>e.jsx("option",{value:q.value,children:q.label},D))})})]})]})}if(s.type===E.WEIGHT){const L=document.globals.globals.uom.weight;return e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-3",children:[e.jsx(Q,{id:a("defaultValue_weight_value"),label:l("From")}),e.jsx("input",{id:a("defaultValue_weight_value"),name:a("defaultValue_weight_value"),type:"number",min:.01,step:.01,className:"form-control",defaultValue:O,onChangeCapture:q=>{B(q.target.value),n(a("defaultValue"),JSON.stringify({weight:y,weightValue:q.target.value}))}})]}),e.jsxs("div",{className:"col-3",children:[e.jsx(Q,{id:a("defaultValue_currency"),label:" "}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:a("defaultValue_weight"),name:a("defaultValue_weight"),placeholder:l("Weight"),defaultValue:y||"KILOGRAM",className:"form-control",onChangeCapture:q=>{j(q.target.value),n(a("defaultValue"),JSON.stringify({weightValue:O,weight:q.target.value}))},children:L&&L.map((q,D)=>e.jsx("option",{value:q.value,children:q.label},D))})})]})]})}if(s.type===E.DATE_RANGE)return e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-6",children:[e.jsx(Q,{id:a("defaultValue_from"),label:l("From")}),e.jsx("input",{id:a("defaultValue_from"),name:a("defaultValue_from"),type:"date",className:"form-control",defaultValue:h,onChangeCapture:L=>{T(L.target.value),n(a("defaultValue"),JSON.stringify({to:f,from:L.target.value}))}})]}),e.jsxs("div",{className:"col-6",children:[e.jsx(Q,{id:a("defaultValue_to"),label:l("To")}),e.jsx("input",{id:a("defaultValue_to"),name:a("defaultValue_to"),type:"date",className:"form-control",defaultValue:f,onChangeCapture:L=>{u(L.target.value),n(a("defaultValue"),JSON.stringify({from:h,to:L.target.value}))}})]})]});if(s.type===E.URL)return e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-6",children:[e.jsx(Q,{id:a("defaultValue_url"),label:l("URL")}),e.jsx("input",{id:a("defaultValue_url"),name:a("defaultValue_url"),type:"url",className:"form-control",defaultValue:p,onChangeCapture:L=>{x(L.target.value),n(a("defaultValue"),JSON.stringify({urlLabel:R,url:L.target.value}))}})]}),e.jsxs("div",{className:"col-6",children:[e.jsx(Q,{id:a("defaultValue_url_label"),label:l("Label")}),e.jsx("input",{id:a("defaultValue_url_label"),name:a("defaultValue_url_label"),type:"text",className:"form-control",defaultValue:R,onChangeCapture:L=>{S(L.target.value),n(a("defaultValue"),JSON.stringify({url:p,urlLabel:L.target.value}))}})]})]});if(s.type===E.PHONE)return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(Z,{type:"phone",id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,validate:{maxLength:{value:255,message:"max length is 255"}}})]})});if(s.type===E.POST_OBJECT||s.type===E.POST_OBJECT_MULTI){const L=document.globals.globals.find.POST_ID;return ae(s.type===E.POST_OBJECT_MULTI,L)}if(s.type===E.TERM_OBJECT||s.type===E.TERM_OBJECT_MULTI){const L=document.globals.globals.find.TERM_ID;return ae(s.type===E.TERM_OBJECT_MULTI,L)}if(s.type===E.USER||s.type===E.USER_MULTI){const L=document.globals.globals.find.USER_ID;return ae(s.type===E.USER_MULTI,L)}if(s.type===E.COUNTRY){const L=[{label:"Afghanistan (‫افغانستان‬‎)",value:"Afghanistan (‫افغانستان‬‎)"},{label:"Åland Islands (Åland)",value:"Åland Islands (Åland)"},{label:"Albania (Shqipëri)",value:"Albania (Shqipëri)"},{label:"Algeria (‫الجزائر‬‎)",value:"Algeria (‫الجزائر‬‎)"},{label:"American Samoa",value:"American Samoa"},{label:"Andorra",value:"Andorra"},{label:"Angola",value:"Angola"},{label:"Anguilla",value:"Anguilla"},{label:"Antarctica",value:"Antarctica"},{label:"Antigua and Barbuda",value:"Antigua and Barbuda"},{label:"Argentina",value:"Argentina"},{label:"Armenia (Հայաստան)",value:"Armenia (Հայաստան)"},{label:"Aruba",value:"Aruba"},{label:"Australia",value:"Australia"},{label:"Austria (Österreich)",value:"Austria (Österreich)"},{label:"Azerbaijan (Azərbaycan)",value:"Azerbaijan (Azərbaycan)"},{label:"Bahamas",value:"Bahamas"},{label:"Bahrain (‫البحرين‬‎)",value:"Bahrain (‫البحرين‬‎)"},{label:"Bangladesh (বাংলাদেশ)",value:"Bangladesh (বাংলাদেশ)"},{label:"Barbados",value:"Barbados"},{label:"Belarus (Беларусь)",value:"Belarus (Беларусь)"},{label:"Belgium (België)",value:"Belgium (België)"},{label:"Belize",value:"Belize"},{label:"Benin (Bénin)",value:"Benin (Bénin)"},{label:"Bermuda",value:"Bermuda"},{label:"Bhutan (འབྲུག)",value:"Bhutan (འབྲུག)"},{label:"Bolivia",value:"Bolivia"},{label:"Bosnia and Herzegovina (Босна и Херцеговина)",value:"Bosnia and Herzegovina (Босна и Херцеговина)"},{label:"Botswana",value:"Botswana"},{label:"Bouvet Island (Bouvetøya)",value:"Bouvet Island (Bouvetøya)"},{label:"Brazil (Brasil)",value:"Brazil (Brasil)"},{label:"British Indian Ocean Territory",value:"British Indian Ocean Territory"},{label:"British Virgin Islands",value:"British Virgin Islands"},{label:"Brunei",value:"Brunei"},{label:"Bulgaria (България)",value:"Bulgaria (България)"},{label:"Burkina Faso",value:"Burkina Faso"},{label:"Burundi (Uburundi)",value:"Burundi (Uburundi)"},{label:"Cambodia (កម្ពុជា)",value:"Cambodia (កម្ពុជា)"},{label:"Cameroon (Cameroun)",value:"Cameroon (Cameroun)"},{label:"Canada",value:"Canada"},{label:"Cape Verde (Kabu Verdi)",value:"Cape Verde (Kabu Verdi)"},{label:"Caribbean Netherlands",value:"Caribbean Netherlands"},{label:"Cayman Islands",value:"Cayman Islands"},{label:"Central African Republic (République Centrafricaine)",value:"Central African Republic (République Centrafricaine)"},{label:"Chad (Tchad)",value:"Chad (Tchad)"},{label:"Chile",value:"Chile"},{label:"China (中国)",value:"China (中国)"},{label:"Christmas Island",value:"Christmas Island"},{label:"Cocos (Keeling) Islands (Kepulauan Cocos (Keeling))",value:"Cocos (Keeling) Islands (Kepulauan Cocos (Keeling))"},{label:"Colombia",value:"Colombia"},{label:"Comoros (‫جزر القمر‬‎)",value:"Comoros (‫جزر القمر‬‎)"},{label:"Congo (DRC) (Jamhuri ya Kidemokrasia ya Kongo)",value:"Congo (DRC) (Jamhuri ya Kidemokrasia ya Kongo)"},{label:"Congo (Republic) (Congo-Brazzaville)",value:"Congo (Republic) (Congo-Brazzaville)"},{label:"Cook Islands",value:"Cook Islands"},{label:"Costa Rica",value:"Costa Rica"},{label:"Côte d’Ivoire",value:"Côte d’Ivoire"},{label:"Croatia (Hrvatska)",value:"Croatia (Hrvatska)"},{label:"Cuba",value:"Cuba"},{label:"Curaçao",value:"Curaçao"},{label:"Cyprus (Κύπρος)",value:"Cyprus (Κύπρος)"},{label:"Czech Republic (Česká republika)",value:"Czech Republic (Česká republika)"},{label:"Denmark (Danmark)",value:"Denmark (Danmark)"},{label:"Djibouti",value:"Djibouti"},{label:"Dominica",value:"Dominica"},{label:"Dominican Republic (República Dominicana)",value:"Dominican Republic (República Dominicana)"},{label:"Ecuador",value:"Ecuador"},{label:"Egypt (‫مصر‬‎)",value:"Egypt (‫مصر‬‎)"},{label:"El Salvador",value:"El Salvador"},{label:"Equatorial Guinea (Guinea Ecuatorial)",value:"Equatorial Guinea (Guinea Ecuatorial)"},{label:"Eritrea",value:"Eritrea"},{label:"Estonia (Eesti)",value:"Estonia (Eesti)"},{label:"Ethiopia",value:"Ethiopia"},{label:"Falkland Islands (Islas Malvinas)",value:"Falkland Islands (Islas Malvinas)"},{label:"Faroe Islands (Føroyar)",value:"Faroe Islands (Føroyar)"},{label:"Fiji",value:"Fiji"},{label:"Finland (Suomi)",value:"Finland (Suomi)"},{label:"France",value:"France"},{label:"French Guiana (Guyane française)",value:"French Guiana (Guyane française)"},{label:"French Polynesia (Polynésie française)",value:"French Polynesia (Polynésie française)"},{label:"French Southern Territories (Terres australes françaises)",value:"French Southern Territories (Terres australes françaises)"},{label:"Gabon",value:"Gabon"},{label:"Gambia",value:"Gambia"},{label:"Georgia (საქართველო)",value:"Georgia (საქართველო)"},{label:"Germany (Deutschland)",value:"Germany (Deutschland)"},{label:"Ghana (Gaana)",value:"Ghana (Gaana)"},{label:"Gibraltar",value:"Gibraltar"},{label:"Greece (Ελλάδα)",value:"Greece (Ελλάδα)"},{label:"Greenland (Kalaallit Nunaat)",value:"Greenland (Kalaallit Nunaat)"},{label:"Grenada",value:"Grenada"},{label:"Guadeloupe",value:"Guadeloupe"},{label:"Guam",value:"Guam"},{label:"Guatemala",value:"Guatemala"},{label:"Guernsey",value:"Guernsey"},{label:"Guinea (Guinée)",value:"Guinea (Guinée)"},{label:"Guinea-Bissau (Guiné Bissau)",value:"Guinea-Bissau (Guiné Bissau)"},{label:"Guyana",value:"Guyana"},{label:"Haiti",value:"Haiti"},{label:"Heard Island and Mcdonald Islands",value:"Heard Island and Mcdonald Islands"},{label:"Honduras",value:"Honduras"},{label:"Hong Kong (香港)",value:"Hong Kong (香港)"},{label:"Hungary (Magyarország)",value:"Hungary (Magyarország)"},{label:"Iceland (Ísland)",value:"Iceland (Ísland)"},{label:"India (भारत)",value:"India (भारत)"},{label:"Indonesia",value:"Indonesia"},{label:"Iran (‫ایران‬‎)",value:"Iran (‫ایران‬‎)"},{label:"Iraq (‫العراق‬‎)",value:"Iraq (‫العراق‬‎)"},{label:"Ireland",value:"Ireland"},{label:"Isle of Man",value:"Isle of Man"},{label:"Israel (‫ישראל‬‎)",value:"Israel (‫ישראל‬‎)"},{label:"Italy (Italia)",value:"Italy (Italia)"},{label:"Jamaica",value:"Jamaica"},{label:"Japan (日本)",value:"Japan (日本)"},{label:"Jersey",value:"Jersey"},{label:"Jordan (‫الأردن‬‎)",value:"Jordan (‫الأردن‬‎)"},{label:"Kazakhstan (Казахстан)",value:"Kazakhstan (Казахстан)"},{label:"Kenya",value:"Kenya"},{label:"Kiribati",value:"Kiribati"},{label:"Kosovo (Kosovë)",value:"Kosovo (Kosovë)"},{label:"Kuwait (‫الكويت‬‎)",value:"Kuwait (‫الكويت‬‎)"},{label:"Kyrgyzstan (Кыргызстан)",value:"Kyrgyzstan (Кыргызстан)"},{label:"Laos (ລາວ)",value:"Laos (ລາວ)"},{label:"Latvia (Latvija)",value:"Latvia (Latvija)"},{label:"Lebanon (‫لبنان‬‎)",value:"Lebanon (‫لبنان‬‎)"},{label:"Lesotho",value:"Lesotho"},{label:"Liberia",value:"Liberia"},{label:"Libya (‫ليبيا‬‎)",value:"Libya (‫ليبيا‬‎)"},{label:"Liechtenstein",value:"Liechtenstein"},{label:"Lithuania (Lietuva)",value:"Lithuania (Lietuva)"},{label:"Luxembourg",value:"Luxembourg"},{label:"Macau (澳門)",value:"Macau (澳門)"},{label:"Macedonia (FYROM) (Македонија)",value:"Macedonia (FYROM) (Македонија)"},{label:"Madagascar (Madagasikara)",value:"Madagascar (Madagasikara)"},{label:"Malawi",value:"Malawi"},{label:"Malaysia",value:"Malaysia"},{label:"Maldives",value:"Maldives"},{label:"Mali",value:"Mali"},{label:"Malta",value:"Malta"},{label:"Marshall Islands",value:"Marshall Islands"},{label:"Martinique",value:"Martinique"},{label:"Mauritania (‫موريتانيا‬‎)",value:"Mauritania (‫موريتانيا‬‎)"},{label:"Mauritius (Moris)",value:"Mauritius (Moris)"},{label:"Mayotte",value:"Mayotte"},{label:"Mexico (México)",value:"Mexico (México)"},{label:"Micronesia",value:"Micronesia"},{label:"Moldova (Republica Moldova)",value:"Moldova (Republica Moldova)"},{label:"Monaco",value:"Monaco"},{label:"Mongolia (Монгол)",value:"Mongolia (Монгол)"},{label:"Montenegro (Crna Gora)",value:"Montenegro (Crna Gora)"},{label:"Montserrat",value:"Montserrat"},{label:"Morocco (‫المغرب‬‎)",value:"Morocco (‫المغرب‬‎)"},{label:"Mozambique (Moçambique)",value:"Mozambique (Moçambique)"},{label:"Myanmar (Burma) (မြန်မာ)",value:"Myanmar (Burma) (မြန်မာ)"},{label:"Namibia (Namibië)",value:"Namibia (Namibië)"},{label:"Nauru",value:"Nauru"},{label:"Nepal (नेपाल)",value:"Nepal (नेपाल)"},{label:"Netherlands (Nederland)",value:"Netherlands (Nederland)"},{label:"New Caledonia (Nouvelle-Calédonie)",value:"New Caledonia (Nouvelle-Calédonie)"},{label:"New Zealand",value:"New Zealand"},{label:"Nicaragua",value:"Nicaragua"},{label:"Niger (Nijar)",value:"Niger (Nijar)"},{label:"Nigeria",value:"Nigeria"},{label:"Niue",value:"Niue"},{label:"Norfolk Island",value:"Norfolk Island"},{label:"North Korea (조선 민주주의 인민 공화국)",value:"North Korea (조선 민주주의 인민 공화국)"},{label:"Northern Mariana Islands",value:"Northern Mariana Islands"},{label:"Norway (Norge)",value:"Norway (Norge)"},{label:"Oman (‫عُمان‬‎)",value:"Oman (‫عُمان‬‎)"},{label:"Pakistan (‫پاکستان‬‎)",value:"Pakistan (‫پاکستان‬‎)"},{label:"Palau",value:"Palau"},{label:"Palestine (‫فلسطين‬‎)",value:"Palestine (‫فلسطين‬‎)"},{label:"Panama (Panamá)",value:"Panama (Panamá)"},{label:"Papua New Guinea",value:"Papua New Guinea"},{label:"Paraguay",value:"Paraguay"},{label:"Peru (Perú)",value:"Peru (Perú)"},{label:"Philippines",value:"Philippines"},{label:"Pitcairn Islands",value:"Pitcairn Islands"},{label:"Poland (Polska)",value:"Poland (Polska)"},{label:"Portugal",value:"Portugal"},{label:"Puerto Rico",value:"Puerto Rico"},{label:"Qatar (‫قطر‬‎)",value:"Qatar (‫قطر‬‎)"},{label:"Réunion (La Réunion)",value:"Réunion (La Réunion)"},{label:"Romania (România)",value:"Romania (România)"},{label:"Russia (Россия)",value:"Russia (Россия)"},{label:"Rwanda",value:"Rwanda"},{label:"Saint Barthélemy (Saint-Barthélemy)",value:"Saint Barthélemy (Saint-Barthélemy)"},{label:"Saint Helena",value:"Saint Helena"},{label:"Saint Kitts and Nevis",value:"Saint Kitts and Nevis"},{label:"Saint Lucia",value:"Saint Lucia"},{label:"Saint Martin (Saint-Martin (partie française))",value:"Saint Martin (Saint-Martin (partie française))"},{label:"Saint Pierre and Miquelon (Saint-Pierre-et-Miquelon)",value:"Saint Pierre and Miquelon (Saint-Pierre-et-Miquelon)"},{label:"Saint Vincent and the Grenadines",value:"Saint Vincent and the Grenadines"},{label:"Samoa",value:"Samoa"},{label:"San Marino",value:"San Marino"},{label:"São Tomé and Príncipe (São Tomé e Príncipe)",value:"São Tomé and Príncipe (São Tomé e Príncipe)"},{label:"Saudi Arabia (‫المملكة العربية السعودية‬‎)",value:"Saudi Arabia (‫المملكة العربية السعودية‬‎)"},{label:"Senegal (Sénégal)",value:"Senegal (Sénégal)"},{label:"Serbia (Србија)",value:"Serbia (Србија)"},{label:"Seychelles",value:"Seychelles"},{label:"Sierra Leone",value:"Sierra Leone"},{label:"Singapore",value:"Singapore"},{label:"Sint Maarten",value:"Sint Maarten"},{label:"Slovakia (Slovensko)",value:"Slovakia (Slovensko)"},{label:"Slovenia (Slovenija)",value:"Slovenia (Slovenija)"},{label:"Solomon Islands",value:"Solomon Islands"},{label:"Somalia (Soomaaliya)",value:"Somalia (Soomaaliya)"},{label:"South Africa",value:"South Africa"},{label:"South Georgia & South Sandwich Islands",value:"South Georgia & South Sandwich Islands"},{label:"South Korea (대한민국)",value:"South Korea (대한민국)"},{label:"South Sudan (‫جنوب السودان‬‎)",value:"South Sudan (‫جنوب السودان‬‎)"},{label:"Spain (España)",value:"Spain (España)"},{label:"Sri Lanka (ශ්‍රී ලංකාව)",value:"Sri Lanka (ශ්‍රී ලංකාව)"},{label:"Sudan (‫السودان‬‎)",value:"Sudan (‫السودان‬‎)"},{label:"Suriname",value:"Suriname"},{label:"Svalbard and Jan Mayen (Svalbard og Jan Mayen)",value:"Svalbard and Jan Mayen (Svalbard og Jan Mayen)"},{label:"Swaziland",value:"Swaziland"},{label:"Sweden (Sverige)",value:"Sweden (Sverige)"},{label:"Switzerland (Schweiz)",value:"Switzerland (Schweiz)"},{label:"Syria (‫سوريا‬‎)",value:"Syria (‫سوريا‬‎)"},{label:"Taiwan (台灣)",value:"Taiwan (台灣)"},{label:"Tajikistan",value:"Tajikistan"},{label:"Tanzania",value:"Tanzania"},{label:"Thailand (ไทย)",value:"Thailand (ไทย)"},{label:"Timor-Leste",value:"Timor-Leste"},{label:"Togo",value:"Togo"},{label:"Tokelau",value:"Tokelau"},{label:"Tonga",value:"Tonga"},{label:"Trinidad and Tobago",value:"Trinidad and Tobago"},{label:"Tunisia (‫تونس‬‎)",value:"Tunisia (‫تونس‬‎)"},{label:"Turkey (Türkiye)",value:"Turkey (Türkiye)"},{label:"Turkmenistan",value:"Turkmenistan"},{label:"Turks and Caicos Islands",value:"Turks and Caicos Islands"},{label:"Tuvalu",value:"Tuvalu"},{label:"Uganda",value:"Uganda"},{label:"Ukraine (Україна)",value:"Ukraine (Україна)"},{label:"United Arab Emirates (‫الإمارات العربية المتحدة‬‎)",value:"United Arab Emirates (‫الإمارات العربية المتحدة‬‎)"},{label:"United Kingdom",value:"United Kingdom"},{label:"United States",value:"United States"},{label:"U.S. Minor Outlying Islands",value:"U.S. Minor Outlying Islands"},{label:"U.S. Virgin Islands",value:"U.S. Virgin Islands"},{label:"Uruguay",value:"Uruguay"},{label:"Uzbekistan (Oʻzbekiston)",value:"Uzbekistan (Oʻzbekiston)"},{label:"Vanuatu",value:"Vanuatu"},{label:"Vatican City (Città del Vaticano)",value:"Vatican City (Città del Vaticano)"},{label:"Venezuela",value:"Venezuela"},{label:"Vietnam (Việt Nam)",value:"Vietnam (Việt Nam)"},{label:"Wallis and Futuna",value:"Wallis and Futuna"},{label:"Western Sahara (‫الصحراء الغربية‬‎)",value:"Western Sahara (‫الصحراء الغربية‬‎)"},{label:"Yemen (‫اليمن‬‎)",value:"Yemen (‫اليمن‬‎)"},{label:"Zambia",value:"Zambia"},{label:"Zimbabwe",value:"Zimbabwe"}];return e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(le,{type:"number",id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,values:L})]})})}return s.type===E.CLONE?e.jsx(Ea,{id:a("defaultValue[]"),field:s}):e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("defaultValue"),label:l("The default value for this field")}),e.jsx(Z,{id:a("defaultValue"),register:d,errors:o,placeholder:l("Default value"),defaultValue:typeof r=="string"?r:null,validate:{maxLength:{value:255,message:"max length is 255"}}})]})})};Ma.propTypes={formId:i.func.isRequired,field:i.object.isRequired};const Aa=({formId:a,boxIndex:s,fieldIndex:d,boxId:t,field:o})=>{const{group:n}=H(y=>y.metaState),c=z(),[m,b]=w.useState(!0),{register:r,unregister:h,control:T,formState:{errors:f},resetField:u,reset:p,setValue:x,setError:R,clearErrors:S}=P(),M=V({control:T,name:a("type")}),A=V({control:T,name:`boxes.${s}.fields`}),g=V({control:T,name:`boxes.${s}.name`}),k=Nl(n.boxes,t,o.id),N=()=>M||o.type,v=y=>{if(N()!==y){const j={...o};j.type=y,y!==E.REPEATER&&(j.children=[]),y!==E.FLEXIBLE&&(j.blocks=[]),y!==E.POST&&(j.relations=[]),Jl(y)||(h(a("relations")),h(a("visibilityConditions")),h(a("validationRules")),j.visibilityConditions=[],j.validationRules=[],j.relations=[]),h(a("relations")),h(a("blocks")),h(a("children")),j.children||(j.children=[]),j.blocks||(j.blocks=[]),j.relations||(j.relations=[]),j.visibilityConditions||(j.visibilityConditions=[]),j.validationRules||(j.validationRules=[]),c(Wl({field:j,boxId:t}))}},C=async y=>{if(m){const j=we(Fe(y));x(a("name"),j),await F(j)?R(a("name"),{message:l("Name is already taken")}):S(a("name"))}},F=async y=>{const j=we(Fe(y));let O=[];if(A&&A.map((B,X)=>{X!==d&&O.push(B.name)}),O.includes(j))return l("Name is already taken");if(o.name!==j&&(await ue("checkMetaBoxFieldNameAction",{boxName:g||o.boxName,fieldName:j})).exists===!0)return l("Name is already taken")};return e.jsxs(I.Fragment,{children:[e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-4",children:[e.jsx(Q,{isRequired:!1,id:a("label"),label:e.jsxs("div",{className:"flex-between",children:[e.jsx("span",{children:l("Field label")}),e.jsx("a",{href:"#",style:{fontWeight:"normal"},onClick:y=>{y.preventDefault(),b(!m)},children:l(`${m?"Auto slug ON":"Auto slug OFF"}`)})]})}),e.jsx(Z,{id:a("label"),register:r,errors:f,defaultValue:o.label,placeholder:l("The field label, non latin characters are allowed"),onChangeCapture:Tl(y=>{C(y.target.value)},300),onClick:y=>{y.target.value==="meta box field"&&u(a("label"))},validate:{maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-4",children:[e.jsx(Q,{isRequired:!0,id:a("name"),label:l("Field slug")}),e.jsx(Z,{id:a("name"),register:r,errors:f,placeholder:l("Field slug (Ex. gallery or text_1)"),defaultValue:o.name,onClick:y=>{y.target.value==="meta_box_field"&&u(a("name"))},validate:{validate:{alphanumericallyValid:Ke,checkIfNameIsValid:F},required:l("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-4",children:[e.jsx(Q,{isRequired:!0,id:a("type"),label:l("Choose the field type")}),e.jsx(le,{register:r,id:a("type"),errors:f,defaultValue:o.type,values:$l(k),onChangeCapture:y=>{v(y.target.value)}})]})]}),e.jsx("div",{className:"container align-end",children:e.jsxs("div",{className:"col-12",children:[e.jsx(Q,{id:a("description"),label:l("The description of this field (showed only on admin panel)")}),e.jsx(Ta,{id:a("description"),register:r,defaultValue:o.description,errors:f,placeholder:l("A brief description"),characterLimit:255,rows:4,validate:{maxLength:{value:255,message:"max length is 255"}}})]})}),e.jsx(Ma,{field:o,formId:a})]}),ds(N())&&e.jsx(ha,{boxId:t,fieldId:o.id,boxIndex:s,fieldIndex:d,parentFieldId:o.parentId?o.parentId:null,options:o.options?o.options:[],isMulti:o.type===E.SELECT_MULTI||o.type===E.CHECKBOX}),xl(N())&&e.jsx(ma,{nestingLevel:k,boxId:t,parentFieldId:o.id,boxIndex:s,parentFieldIndex:d,childrenFields:o.children}),vl(N())&&e.jsx(ba,{nestingLevel:k,boxId:t,parentFieldId:o.id,boxIndex:s,parentFieldIndex:d,blocks:o.blocks}),cs(N())&&e.jsx(Ca,{formId:a,field:o})]})};Aa.propTypes={formId:i.func.isRequired,boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,field:i.object.isRequired};const Oa=({id:a,values:s,description:d,validate:t,register:o,style:n,errors:c})=>{const m=Ae(c,a);return e.jsxs(I.Fragment,{children:[e.jsxs("div",{className:`${n==="inline"?"i-flex-center":"flex-column"} s-8`,style:{minHeight:"46px"},children:[Object.keys(s).map((b,r)=>e.jsxs("label",{className:"radio",htmlFor:`${a}_${r}`,children:[e.jsx("input",{name:a,value:s[b].value,defaultChecked:s[b].checked,"aria-invalid":m?"true":"false",type:"radio",id:`${a}_${r}`,...o(a,{...t})}),e.jsx("span",{children:s[b].label})]})),m&&e.jsx("div",{className:"invalid-feedback",children:m.message})]}),d&&e.jsx("div",{className:"form-description",children:d}),m&&e.jsx("div",{className:"invalid-feedback",children:m.message})]})};Oa.propTypes={id:i.string.isRequired,description:i.string,values:i.arrayOf(i.object).isRequired,validate:i.func,register:i.func.isRequired,errors:i.array.isRequired,style:i.string};const ct=[{label:"Administrator",value:"administrator"},{label:"Editor",value:"editor"},{label:"Author",value:"author"},{label:"Contributor",value:"contributor"},{label:"Viewer",value:"viewer"},{label:"Subscriber",value:"subscriber"}],Ia=({field:a,formId:s})=>{const{control:d,register:t,formState:{errors:o},setValue:n,clearErrors:c}=P(),m=V({control:d,name:s("children")}),b=V({control:d,name:s("blocks")}),r=[{label:l("On the top"),value:"top"},{label:l("On the left"),value:"left"},{label:l("On the right"),value:"right"},{label:l("No display"),value:"none"}],h=[{label:l("Center"),value:"center"},{label:l("Top"),value:"flex-start"},{label:l("Bottom"),value:"flex-end"}],T=[{label:l("Row"),value:"row"},{label:l("Block"),value:"block"},{label:l("Table"),value:"table"}],f=[{label:l("Yes"),value:"1"},{label:l("No"),value:"0"}],u=[{label:l("Select"),value:null},{value:"d-M-y",label:"dd-mmm-yy (ex. 28-OCT-90)"},{value:"d-M-Y",label:"dd-mmm-yyyy (ex. 28-OCT-1990)"},{value:"d M y",label:"mmm yy (ex. 28 OCT 90)"},{value:"d M Y",label:"mmm yyyy (ex. 28 OCT 1990)"},{value:"d/m/Y",label:"dd/mm/yy (ex. 28/10/90)"},{value:"d/m/Y",label:"dd/mm/yyyy (ex. 28/10/1990)"},{value:"m/d/y",label:"mm/dd/yy (ex. 10/28/90)"},{value:"m/d/Y",label:"mm/dd/yyyy (ex. 10/28/1990)"},{value:"d.m.Y",label:"dd.mm.yy (ex. 28.10.90)"},{value:"d.m.Y",label:"dd.mm.yyyy (ex. 28.10.1990)"}],p=[{label:l("Select"),value:null},{value:"H:i",label:"H:i (ex. 21:18)"},{value:"g:i a",label:"g:i a (ex. 9:18 pm)"},{value:"g:i A",label:"g:i A (ex. 9:18 PM)"}],x=[{value:"PASSWORD_DEFAULT",label:"DEFAULT"},{value:"PASSWORD_BCRYPT",label:"BCRYPT"},{value:"PASSWORD_ARGON2I",label:"ARGON2I"},{value:"PASSWORD_ARGON2ID",label:"ARGON2ID)"}];let R=[];m&&m.length>0&&m.map(M=>{ll(M.type)&&R.push({label:M.label?M.label:M.name,value:M.id})}),b&&b.length>0&&b.map(M=>{M.fields&&M.fields.length>0&&M.fields.map(A=>{ll(A.type)&&R.push({label:A.label?A.label:A.name,value:A.id})})});const S=({type:M,index:A,innerKey:g,label:k,placeholder:N,options:v})=>{const C=j=>`${s(`advancedOptions.${A}.${j}`)}`,F=()=>{if(!a.advancedOptions)return null;const j=a.advancedOptions[A];return j||null},y=()=>{let j={};return v.min&&(j.min={value:v.min,message:l("min length is")+" "+v.min}),v.max&&(j.max={value:v.max,message:l("max length is")+" "+v.max}),j};return e.jsxs(I.Fragment,{children:[e.jsx(be,{id:C("id"),value:F()?F().id:ce(),register:t}),e.jsx(be,{id:C("key"),value:F()?F().key:g,register:t}),e.jsx(Q,{id:C("value"),label:e.jsx("span",{dangerouslySetInnerHTML:{__html:k}})}),M==="integer"&&e.jsx(Z,{type:"number",id:C("value"),register:t,errors:o,placeholder:N,min:v.min?v.min:null,max:v.max?v.max:null,step:v.step?v.step:null,defaultValue:F()?F().value:null,validate:y()}),M==="radio"&&v&&v.options&&e.jsx(I.Fragment,{children:e.jsx(Oa,{style:"inline",register:t,id:C("value"),errors:o,placeholder:N,values:v.options,defaultValue:F()?F().value:null})}),M==="select"&&v&&v.options&&e.jsx(I.Fragment,{children:v.multiple&&v.multiple===!0?e.jsx(Ge,{clearErrors:c,errors:o,id:C("value"),register:t,setValue:n,values:v.options,defaultValue:F()?F().value:null}):e.jsx(le,{register:t,id:C("value"),errors:o,placeholder:N,values:v.options,defaultValue:F()?F().value:null})}),M==="text"&&e.jsx(Z,{id:C("value"),register:t,errors:o,placeholder:N,defaultValue:F()?F().value:null})]})};return e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("General settings")}),e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-4",children:S({type:"select",index:1,innerKey:"headline",placeholder:l("Select the headline location (default: on the left)"),label:l("Headline location"),options:{options:r}})}),e.jsx("div",{className:"col-4",children:S({type:"select",index:29,innerKey:"vertical_alignment",placeholder:l("Select the field vertical alignment (default: center)"),label:l("Vertical alignment"),options:{options:h}})}),e.jsx("div",{className:"col-4",children:S({type:"integer",index:2,innerKey:"width",placeholder:l("Field width in % ([1-100] default value: 100)"),label:l("Field width"),options:{min:1,max:100,step:1}})})]}),gs(a.type)&&e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:S({type:"text",index:6,innerKey:"before",placeholder:l("This text will appear before input"),label:l("Text before. HTML is allowed (ex. &lt;small&gt;)"),options:{}})}),e.jsx("div",{className:"col-6",children:S({type:"text",index:7,innerKey:"after",placeholder:l("This text will appear after input"),label:l("Text after. HTML is allowed (ex. &lt;small&gt;)"),options:{}})})]}),e.jsx("div",{className:"container align-end",children:e.jsx("div",{className:"col-12",children:S({type:"text",index:18,innerKey:"css",placeholder:l("These CSS classes will be applied to back-end editor fields"),label:l("Add CSS classes to back-end editor fields (ex. class-active pulse)"),options:{}})})})]})]}),js(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Textarea settings")}),e.jsx("div",{className:"flex-column s-24",children:e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:S({type:"integer",index:25,innerKey:"cols",placeholder:l("The cols value (used only by textarea fields)"),label:l("Cols"),options:{}})}),e.jsx("div",{className:"col-6",children:S({type:"integer",index:26,innerKey:"rows",placeholder:l("The rows value (used only by textarea fields)"),label:l("Rows"),options:{}})})]})})]}),ll(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Textual fields settings")}),e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:S({type:"integer",index:8,innerKey:"min",placeholder:l("The minimum value (used only by numeric and textual fields)"),label:l("Min value (used only by numeric and textual fields)"),options:{}})}),e.jsx("div",{className:"col-6",children:S({type:"integer",index:9,innerKey:"max",placeholder:l("The maximum value (used only by numeric and textual fields)"),label:l("Max value (used only by numeric and textual fields)"),options:{}})})]}),e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:S({type:"integer",index:10,innerKey:"step",placeholder:l("Step value (used only by numeric fields)"),label:l("Step value (used only by numeric fields)"),options:{}})}),e.jsx("div",{className:"col-6",children:S({type:"text",index:11,innerKey:"pattern",placeholder:l("Pattern value (used only by numeric and textual fields)"),label:l("Pattern value (used only by textual fields)"),options:{}})})]})]})]}),ys(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("File field settings")}),e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:S({type:"select",index:14,innerKey:"accepts",placeholder:l("Input file accepts"),label:l("Input file accepts"),options:{multiple:!0,options:[{label:"image",value:"image"},{label:"video",value:"video"},{label:"document",value:"document"},{label:"audio",value:"audio"}]}})}),e.jsx("div",{className:"col-6",children:S({type:"radio",index:5,innerKey:"hide_url_label",placeholder:l("Hide the label"),label:l("Hide the label"),options:{options:f}})})]}),e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:S({type:"integer",index:16,innerKey:"max_size",placeholder:l("Maximum size"),label:`${l("Maximum size")} (Mb)`,options:{}})}),e.jsx("div",{className:"col-6",children:S({type:"integer",index:17,innerKey:"min_size",placeholder:l("Minimum size"),label:`${l("Minimum size")} (Mb)`,options:{}})})]})]})]}),Ns(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Radio field settings")}),e.jsx("div",{children:S({type:"radio",index:4,innerKey:"hide_blank_radio",placeholder:l("Hide the blank value"),label:l("Hide the blank value"),options:{options:f}})})]}),Ss(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Date field settings")}),e.jsx("div",{children:S({type:"select",index:27,innerKey:"date_format",placeholder:l("Date format"),label:l("Date format"),options:{options:u}})})]}),Cs(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Datetime field settings")}),e.jsx("div",{className:"flex-column s-24",children:e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:S({type:"select",index:27,innerKey:"date_format",placeholder:l("Date format"),label:l("Date format"),options:{options:u}})}),e.jsx("div",{className:"col-6",children:S({type:"select",index:28,innerKey:"time_format",placeholder:l("Time format"),label:l("Time format"),options:{options:p}})})]})})]}),Ts(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Password field settings")}),e.jsx("div",{children:S({type:"select",index:32,innerKey:"algorithm",placeholder:l("Algorithm"),label:l("Algorithm"),options:{options:x}})})]}),Rs(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Time field settings")}),e.jsx("div",{children:S({type:"select",index:28,innerKey:"time_format",placeholder:l("Time format"),label:l("Time format"),options:{options:p}})})]}),ks(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("URL field settings")}),e.jsx("div",{children:S({type:"radio",index:5,innerKey:"hide_url_label",placeholder:l("Hide the label"),label:l("Hide the label"),options:{options:f}})})]}),ws(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Nestable fields layout settings")}),e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:S({type:"select",index:19,innerKey:"leading_field",placeholder:l("The leading field (which will be displayed when the repeater is collapsed)."),label:l("Leading field"),options:{options:R}})}),e.jsx("div",{className:"col-6",children:S({type:"select",index:20,innerKey:"layout",placeholder:l("The look of the field for admins and editors."),label:l("Field layout"),options:{options:T}})})]}),e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-4",children:S({type:"integer",index:3,innerKey:"columns",placeholder:l("Field columns ([1-6] only for repeater field)"),label:l("Field columns"),options:{min:1,max:6,step:1}})}),e.jsx("div",{className:"col-4",children:S({type:"integer",index:12,innerKey:"minimum_blocks",placeholder:l("The limit on how many elements are required ([1-100] only for repeater field)"),label:l("Minimum elements allowed"),options:{}})}),e.jsx("div",{className:"col-4",children:S({type:"integer",index:13,innerKey:"maximum_blocks",placeholder:l("The limit on how many elements are allowed ([1-100] only for repeater field)"),label:l("Maximum elements allowed"),options:{}})})]})]})]}),Fs(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Relational field settings")}),e.jsx("div",{children:S({type:"select",index:20,innerKey:"layout",placeholder:l("The look of the field for admins and editors."),label:l("Field layout"),options:{options:pl()}})})]}),Es(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Post object settings")}),e.jsx("div",{className:"flex-column s-24",children:e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-3",children:S({type:"select",index:20,innerKey:"layout",placeholder:l("The look of the field for admins and editors."),label:l("Field layout"),options:{options:pl()}})}),e.jsx("div",{className:"col-3",children:S({type:"select",index:21,innerKey:"filter_post_type",placeholder:l("Filter by post type"),label:l("Filter by post type"),options:{options:document.globals.globals.find.customPostType}})}),e.jsx("div",{className:"col-3",children:S({type:"select",index:22,innerKey:"filter_post_status",placeholder:l("Filter by post status"),label:l("Filter by post status"),options:{options:nt}})}),e.jsx("div",{className:"col-3",children:S({type:"select",index:23,innerKey:"filter_taxonomy",placeholder:l("Filter by taxonomy"),label:l("Filter by taxonomy"),options:{options:document.globals.globals.find.TERM_ID}})})]})})]}),Ms(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Term object settings")}),e.jsx("div",{className:"flex-column s-24",children:e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:S({type:"select",index:23,innerKey:"filter_taxonomy",placeholder:l("Filter by taxonomy"),label:l("Filter by taxonomy"),options:{options:document.globals.globals.find.taxonomy}})}),e.jsx("div",{className:"col-6",children:S({type:"radio",index:30,innerKey:"sync_taxonomy",placeholder:l("Sync with post terms"),label:l("Sync with post terms"),options:{options:f}})})]})})]}),As(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Image settings")}),e.jsx("div",{children:S({type:"radio",index:31,innerKey:"set_thumbnail",placeholder:l("Set as post thumbnail"),label:l("Set as post thumbnail"),options:{options:f}})})]}),Os(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("User settings")}),e.jsx("div",{className:"flex-column s-24",children:e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:S({type:"select",index:20,innerKey:"layout",placeholder:l("The look of the field for admins and editors."),label:l("Field layout"),options:{options:pl()}})}),e.jsx("div",{className:"col-6",children:S({type:"select",index:24,innerKey:"filter_role",placeholder:l("Filter by role"),label:l("Filter by role"),options:{multiple:!0,options:ct}})})]})})]}),Is(a.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:l("Clone field settings")}),e.jsx("div",{children:S({type:"select",index:20,innerKey:"layout",placeholder:l("The look of the field for admins and editors."),label:l("Field layout"),options:{options:T}})})]})]})};Ia.propTypes={formId:i.func.isRequired,boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,field:i.object.isRequired};const qa=({boxId:a,fieldId:s,elementId:d,elementIndex:t,parentFieldId:o})=>{const n=z(),{group:c}=H(u=>u.metaState),m=()=>`${W(c.boxes,a,s)}.visibilityConditions`,{control:b}=P(),{remove:r}=ie({control:b,name:m()}),[h,T]=w.useState(!1),f=[e.jsx(U,{style:G.SUCCESS,onClick:u=>{u.preventDefault(),n(qs({boxId:a,fieldId:s,parentFieldId:o,elementId:d})),r(t),T(!h)},children:l("Yes")}),e.jsx(U,{style:G.DANGER,onClick:u=>{u.preventDefault(),T(!h)},children:l("No")})];return e.jsxs("div",{children:[e.jsx(he,{title:l("Confirm deleting conditional rendering element"),visible:h,buttons:f,children:l("Are you sure?")}),e.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),T(!h)},children:e.jsx($,{icon:!1,tip:l("Delete"),label:e.jsx(_,{icon:"bx-trash",width:18,color:"#F94144"})})})]})};qa.propTypes={boxId:i.string.isRequired,fieldId:i.string.isRequired,elementId:i.string.isRequired,elementIndex:i.number.isRequired,parentFieldId:i.string};const Va=({elementIndex:a,boxIndex:s,fieldIndex:d,boxId:t,fieldId:o,element:n,parentFieldIndex:c,parentFieldId:m,isLast:b})=>{const{POST_TAX:r,POST_ID:h}=document.globals.globals.find,{group:T}=H(D=>D.metaState),f=D=>`${W(T.boxes,t,o)}.visibilityConditions.${a}.${D}`,{register:u,formState:{errors:p},control:x,setValue:R,clearErrors:S}=P(),M=V({control:x,name:"belongs"}),A=V({control:x,name:"boxes"}),g=V({control:x,name:`${W(T.boxes,t,o)}.type`}),k=V({control:x,name:f("type")}),N=V({control:x,name:f("operator")}),v=V({control:x,name:f("value")}),C=V({control:x,name:f("logic")}),F=V({control:x,name:f("frontEnd")}),y=V({control:x,name:f("backEnd")}),[j,O]=w.useState([]);w.useEffect(()=>{M&&M.map(D=>{D.belongsTo===te.TAXONOMY&&ue("fetchTermsAction",{taxonomy:D.find,format:"short"}).then(se=>{ze(se)&&ze(j)&&O([...j,...se])})})},[M]);const B=()=>{const D=[E.NUMBER,E.PASSWORD,E.TEXT,E.TEXTAREA,E.CHECKBOX,E.RADIO,E.SELECT,E.SELECT_MULTI,E.DATE,E.DATE_TIME,E.TIME,E.URL,E.PHONE,E.EMAIL,E.COLOR,E.CURRENCY,E.WEIGHT,E.LENGTH,E.TOGGLE,E.POST,E.POST_OBJECT,E.POST_OBJECT_MULTI,E.TERM_OBJECT,E.TERM_OBJECT_MULTI,E.USER,E.USER_MULTI];let se=[],ne=[],me=[{value:null,label:l("Select")}];if(A.map(re=>{if(typeof re.fields<"u"&&re.fields.length>0){const pe=Vs(re);pe&&pe.length>0&&pe.filter(K=>K.field&&K.field.id===o).map(K=>{K.fields&&K.fields.map(oe=>{if(D.includes(oe.type)&&oe.id!==o){const ee=()=>{let de="";return de+=`[${re.label?re.label:re.name}] `,de+=oe.label?oe.label:oe.name,de};ne.push({label:ee(),value:Le({type:"OTHER_FIELDS",value:oe.id})})}})})}}),D.includes(g)&&se.push({value:Le({type:"VALUE",value:"VALUE"}),label:l("Value")}),M&&M.map(re=>{re.belongsTo===te.CUSTOM_POST_TYPE&&se.push({value:Le({type:"POST_ID",value:"POST_ID"}),label:l("Post")}),re.belongsTo===te.TAXONOMY&&se.push({value:Le({type:"TERM_ID",value:"TERM_ID"}),label:l("Term")})}),se&&se.length>0&&D.includes(g)&&me.push({label:l("This field"),options:se}),r&&r.length>0){let re={label:l("Related taxonomies"),options:[]};r.map(pe=>{pe.value!==null&&re.options.push({value:Le({type:"TAXONOMY",value:pe.label}),label:pe.label})}),me.push(re)}return ne&&ne.length>0&&me.push({label:l("Other fields"),options:ne}),me},X=()=>typeof k>"u",ae=D=>{if(!k||typeof k>"u")return[{value:null,label:l("Select")}];const se=typeof k=="object"?k:Il(k),ne=se.type;return se.value,ne==="VALUE"?D===E.SELECT_MULTI?[{value:null,label:l("Select")},{value:"IN",label:l("is included in")},{value:"NOT_IN",label:l("is not included in")},{value:"BLANK",label:l("is empty")},{value:"NOT_BLANK",label:l("is not empty")}]:D===E.NUMBER||D===E.CURRENCY||D===E.WEIGHT||D===E.LENGTH||D===E.DATE||D===E.DATE_TIME||D===E.TIME?[{value:null,label:l("Select")},{value:"=",label:l("is equal to")},{value:"!=",label:l("is not equal to")},{value:"<",label:l("is less than")},{value:">",label:l("is greater than")},{value:"<=",label:l("is less than or equal to")},{value:">=",label:l("is greater than or equal to")},{value:"BLANK",label:l("is empty")},{value:"NOT_BLANK",label:l("is not empty")}]:D===E.TOGGLE?[{value:null,label:l("Select")},{value:"CHECKED",label:l("is checked")},{value:"NOT_CHECKED",label:l("is not checked")}]:[{value:null,label:l("Select")},{value:"=",label:l("is equal to")},{value:"!=",label:l("is not equal to")},{value:"LIKE",label:l("is like to")},{value:"NOT_LIKE",label:l("is not like")},{value:"BLANK",label:l("is empty")},{value:"NOT_BLANK",label:l("is not empty")}]:ne==="OTHER_FIELDS"?D===E.SELECT_MULTI?[{value:null,label:l("Select")},{value:"IN",label:l("is included in")},{value:"NOT_IN",label:l("is not included in")},{value:"BLANK",label:l("is empty")},{value:"NOT_BLANK",label:l("is not empty")}]:D===E.NUMBER||D===E.CURRENCY||D===E.WEIGHT||D===E.LENGTH||D===E.DATE||D===E.TIME?[{value:null,label:l("Select")},{value:"=",label:l("is equal to")},{value:"!=",label:l("is not equal to")},{value:"<",label:l("is less than")},{value:">",label:l("is greater than")},{value:"<=",label:l("is less than or equal to")},{value:">=",label:l("is greater than or equal to")},{value:"BLANK",label:l("is empty")},{value:"NOT_BLANK",label:l("is not empty")}]:D===E.TOGGLE?[{value:null,label:l("Select")},{value:"CHECKED",label:l("is checked")},{value:"NOT_CHECKED",label:l("is not checked")}]:[{value:null,label:l("Select")},{value:"=",label:l("is equal to")},{value:"!=",label:l("is not equal to")},{value:"LIKE",label:l("is like to")},{value:"NOT_LIKE",label:l("is not like")},{value:"BLANK",label:l("is empty")},{value:"NOT_BLANK",label:l("is not empty")}]:ne==="POST_ID"||ne==="TERM_ID"?[{value:null,label:l("Select")},{value:"=",label:l("is equal to")},{value:"!=",label:l("is not equal to")},{value:"IN",label:l("is included in")},{value:"NOT_IN",label:l("is not included in")}]:ne==="TAXONOMY"?[{value:null,label:l("Select")},{value:"IN",label:l("is included in")},{value:"NOT_IN",label:l("is not included in")},{value:"BLANK",label:l("is empty")},{value:"NOT_BLANK",label:l("is not empty")}]:[{value:null,label:l("Select")},{value:"=",label:l("is equal to")},{value:"!=",label:l("is not equal to")},{value:"IN",label:l("is included in")},{value:"NOT_IN",label:l("is not included in")},{value:"BLANK",label:l("is empty")},{value:"NOT_BLANK",label:l("is not empty")}]},L=()=>k&&N&&N!=="BLANK"&&N!=="NOT_BLANK"&&N!=="CHECKED"&&N!=="NOT_CHECKED",q=()=>{let D=typeof k=="object"?k:Il(k);typeof D=="string"&&(D=JSON.parse(D));const se=D.type,ne=D.value,me=N==="IN"||N==="NOT_IN",re=N==="CHECKED"||N==="NOT_CHECKED",pe={value:null,label:l("Select")};if(se==="POST_ID"){const K=()=>{if(n.operator==="IN"||n.operator==="NOT_IN"){const oe=v||n.value,ee=typeof oe=="string"?oe.split(","):oe;let de=[];return ee.map(Se=>de.push(parseInt(Se))),de}return v||n.value};return me?e.jsx(I.Fragment,{children:e.jsx(Ge,{id:f("value"),defaultValue:K(),placeholder:l("Select posts"),values:h,errors:p,register:u,setValue:R,clearErrors:S,validate:{required:l("This field is mandatory")}})}):e.jsx(I.Fragment,{children:e.jsx(le,{id:f("value"),defaultValue:K(),placeholder:l("Select posts"),values:ze(h)?[pe,...h]:[],errors:p,register:u,validate:{required:l("This field is mandatory")}})})}if(se==="TAXONOMY"){if(r&&r.length>0){const K=r.filter(oe=>oe.label===ne);if(K&&K.length===1&&K[0].options)return me?e.jsx(I.Fragment,{children:e.jsx(Ge,{id:f("value"),defaultValue:v||n.value,placeholder:l("Select taxonomies"),errors:p,register:u,values:K[0].options,setValue:R,clearErrors:S,validate:{required:l("This field is mandatory")}})}):e.jsx(I.Fragment,{children:e.jsx(le,{id:f("value"),defaultValue:v||n.value,placeholder:l("Select taxonomy"),errors:p,register:u,values:K.length>0&&K[0].options&&ze(K[0].options)?[pe,...K[0].options]:[],validate:{required:l("This field is mandatory")}})})}return e.jsx(I.Fragment,{children:e.jsx(Z,{id:f("value"),errors:p,register:u,defaultValue:v||n.value,placeholder:l("value"),validate:{required:l("This field is mandatory")}})})}if(se==="TERM_ID"){const K=()=>{if(n.operator==="IN"||n.operator==="NOT_IN"){const oe=v||n.value,ee=typeof oe=="string"?oe.split(","):oe;let de=[];return ee.map(Se=>de.push(parseInt(Se))),de}return v||n.value};return me?e.jsx(I.Fragment,{children:e.jsx(Ge,{id:f("value"),defaultValue:K(),placeholder:l("Select taxonomies"),errors:p,register:u,values:j,setValue:R,clearErrors:S,validate:{required:l("This field is mandatory")}})}):e.jsx(I.Fragment,{children:e.jsx(le,{id:f("value"),defaultValue:K(),placeholder:l("Select taxonomies"),errors:p,register:u,values:ze(j)?[pe,...j]:[],validate:{required:l("This field is mandatory")}})})}return re?e.jsx(I.Fragment,{children:e.jsx(Z,{id:f("value"),disabled:!0,register:u,errors:p,placeholder:`${me?l("Insert values separated by comma. Ex: 12, 54, foo"):l("value")}`,defaultValue:v||n.value})}):e.jsx(I.Fragment,{children:e.jsx(Z,{id:f("value"),register:u,errors:p,placeholder:`${me?l("Insert values separated by comma. Ex: 12, 54, foo"):l("value")}`,defaultValue:v||n.value,validate:{required:l("This field is mandatory")}})})};return e.jsxs("div",{className:"i-flex-center s-8 w-100",children:[e.jsx(be,{id:f("id"),value:n.id,register:u}),e.jsx("div",{className:"w-60",children:e.jsx(le,{id:f("type"),placeholder:l("Select option"),register:u,values:B(),errors:p,defaultValue:k||Le(n.type),validate:{required:l("This field is mandatory")}})}),e.jsx("div",{className:"w-40",children:e.jsx(le,{id:f("operator"),placeholder:l("Select option"),register:u,disabled:X(),values:ae(g),errors:p,defaultValue:k||n.operator,validate:{required:l("This field is mandatory")}})}),e.jsx("div",{className:"w-100",children:L()?q():e.jsx(Z,{id:f("value"),placeholder:l(""),register:u,errors:p,value:"",defaultValue:v||n.value,disabled:!0})}),e.jsx("div",{className:"w-20",children:!b&&e.jsx(I.Fragment,{children:e.jsx(le,{id:f("logic"),placeholder:l("Select option"),register:u,values:[{label:l("AND"),value:"AND"},{label:l("OR"),value:"OR"}],errors:p,defaultValue:C||n.logic,validate:{required:l("This field is mandatory")}})})}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx($,{label:e.jsx(De,{id:f("frontEnd"),control:x,defaultValue:typeof F=="boolean"?F:n.frontEnd,errors:p,icon:"bx:devices",disabled:!L()}),tip:l("Show in Front-End"),icon:!1}),e.jsx($,{label:e.jsx(De,{id:f("backEnd"),control:x,defaultValue:typeof y=="boolean"?y:n.backEnd,errors:p,icon:"bx:cog",disabled:!L()}),tip:l("Show in Back-End"),icon:!1})]}),e.jsx(qa,{boxId:t,fieldId:o,elementId:n.id,parentFieldId:m,elementIndex:a})]})};Va.propTypes={elementIndex:i.number.isRequired,boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,fieldId:i.string.isRequired,element:i.object.isRequired,isLast:i.bool.isRequired,parentFieldIndex:i.string,parentFieldId:i.string};const Da=({boxIndex:a,fieldIndex:s,boxId:d,field:t,parentFieldIndex:o,parentFieldId:n})=>{const c=z(),[m]=Ne(),b=()=>{const r={id:ce(),type:null,operator:"=",value:"",logic:null,frontEnd:!0,backEnd:!0};c(Ds({boxId:d,fieldId:t.id,parentFieldId:n,element:r}))};return e.jsxs("div",{ref:m,className:t.visibilityConditions&&t.visibilityConditions.length>0?"flex-column s-24":"",children:[t.visibilityConditions&&t.visibilityConditions.length>0?e.jsx(I.Fragment,{children:t.visibilityConditions.map((r,h)=>e.jsx(Va,{elementIndex:h,boxIndex:a,fieldIndex:s,boxId:d,fieldId:t.id,element:r,parentFieldIndex:o,parentFieldId:n,isLast:h===t.visibilityConditions.length-1},r.id))}):e.jsx(rl,{style:G.WARNING,children:l('No conditions are present, click on "Add condition" button to add the first one.')}),e.jsx("span",{children:e.jsx("a",{href:"#",className:t.visibilityConditions&&t.visibilityConditions.length>0?"":"mt-24",onClick:r=>{r.preventDefault(),b()},children:l("Add condition")})})]})};Da.propTypes={boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,parentFieldIndex:i.string,parentFieldId:i.string,field:i.object.isRequired};const Ba=({boxId:a,fieldId:s,ruleId:d,ruleIndex:t,parentFieldId:o})=>{const n=z(),{group:c}=H(u=>u.metaState),m=()=>`${W(c.boxes,a,s)}.validationRules`,{control:b}=P(),{remove:r}=ie({control:b,name:m()}),[h,T]=w.useState(!1),f=[e.jsx(U,{style:G.SUCCESS,onClick:u=>{u.preventDefault(),r(t),n(Bs({boxId:a,fieldId:s,parentFieldId:o,ruleId:d})),T(!h)},children:l("Yes")}),e.jsx(U,{style:G.DANGER,onClick:u=>{u.preventDefault(),T(!h)},children:l("No")})];return e.jsxs("div",{children:[e.jsx(he,{title:l("Confirm deleting validation rule"),visible:h,buttons:f,children:l("Are you sure?")}),e.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),T(!h)},children:e.jsx($,{icon:!1,tip:l("Delete"),label:e.jsx(_,{icon:"bx-trash",width:18,color:"#F94144"})})})]})};Ba.propTypes={boxId:i.string.isRequired,fieldId:i.string.isRequired,ruleId:i.string.isRequired,ruleIndex:i.number.isRequired,parentFieldId:i.string};const _a=w.memo(({ruleIndex:a,boxIndex:s,fieldIndex:d,boxId:t,fieldId:o,rule:n,formId:c,parentFieldIndex:m,parentFieldId:b})=>{const r=j=>`${c(`validationRules.${a}.${j}`)}`,{register:h,formState:{errors:T},control:f,setValue:u}=P(),p=V({control:f,name:r("condition")}),x=V({control:f,name:r("value")}),R=V({control:f,name:r("message")}),S=()=>p||n.condition,M=()=>R||(n.message?n.message:A(S())),A=j=>{let O;switch(j){case"blank":O="Value is not blank";break;case"not_blank":O="Value is blank";break;case"=":O="Value is not equal to {{v}}";break;case"!=":O="Value is equals to {{v}}";break;case">":O="Value is lower or equals than {{v}}";break;case">=":O="Value is lower than {{v}}";break;case"<":O="Value is greatest or equals than {{v}}";break;case"<=":O="Value is greatest than {{v}}";break;case"max":O="The maximum length is {{v}}";break;case"min":O="The minimum length is {{v}}";break;case"regex":O="Regex value is not matching {{v}}";break}return l(O)},g=j=>j==="blank"||j==="not_blank",k=j=>{v(A(j)),u(r("message"),A(j)),F(g(j)),g(j)&&u(r("value"),null)},[N,v]=w.useState(M()),[C,F]=w.useState(g(p||n.condition)),y=[{value:"blank",label:l("is empty")},{value:"not_blank",label:l("is not empty")},{value:"=",label:l("is equal to")},{value:"!=",label:l("is not equal to")},{value:">",label:l("is greater than")},{value:">=",label:l("is greater than or equal to")},{value:"<",label:l("is less than")},{value:"<=",label:l("is less than or equal to")},{value:"max",label:l("max length is")},{value:"min",label:l("min length is")},{value:"regex",label:l("regular expression")}];return e.jsxs("div",{className:"i-flex-center s-24 w-100",children:[e.jsx(be,{id:r("id"),value:n.id,register:h}),e.jsx("div",{className:"w-40",children:e.jsx(le,{id:r("condition"),register:h,defaultValue:S(),values:y,errors:T,onChangeCapture:j=>k(j.target.value),validate:{required:l("This field is mandatory")}})}),!C&&e.jsx("div",{className:"w-100",children:e.jsx(Z,{id:r("value"),register:h,errors:T,defaultValue:x||n.value,validate:{required:l("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("div",{className:"w-100",children:e.jsx(Z,{id:r("message"),register:h,errors:T,defaultValue:N,validate:{required:l("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx(Ba,{boxId:t,fieldId:o,ruleId:n.id,parentFieldId:b,ruleIndex:a})]})});_a.propTypes={formId:i.func.isRequired,ruleIndex:i.number.isRequired,boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,fieldId:i.string.isRequired,rule:i.object.isRequired,parentFieldIndex:i.string,parentFieldId:i.string};const La=({boxIndex:a,fieldIndex:s,boxId:d,field:t,formId:o,parentFieldIndex:n,parentFieldId:c})=>{const m=z(),[b]=Ne(),r=()=>{const h={id:ce(),condition:"=",value:""};m(_s({boxId:d,fieldId:t.id,parentFieldId:c,rule:h}))};return e.jsxs("div",{ref:b,className:t.validationRules&&t.validationRules.length>0?"flex-column s-24":"",children:[t.validationRules&&t.validationRules.length>0?e.jsx(I.Fragment,{children:t.validationRules.map((h,T)=>e.jsx(_a,{formId:o,boxId:d,fieldId:t.id,fieldIndex:s,rule:h,boxIndex:a,parentFieldIndex:n,parentFieldId:c,ruleIndex:T}))}):e.jsx(rl,{style:G.WARNING,children:l('No rules already created. Create the first one now by clicking the button "Add rule"!')}),e.jsx("a",{href:"#",className:t.validationRules&&t.validationRules.length>0?"":"mt-24",onClick:h=>{h.preventDefault(),r()},children:l("Add rule")})]})};La.propTypes={formId:i.func.isRequired,boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,field:i.object.isRequired,parentFieldIndex:i.string,parentFieldId:i.string};const $a=({boxId:a,fieldId:s,permissionId:d,permissionIndex:t,parentFieldId:o})=>{const n=z(),{group:c}=H(u=>u.metaState),m=()=>`${W(c.boxes,a,s)}.permissions`,{control:b}=P(),{remove:r}=ie({control:b,name:m()}),[h,T]=w.useState(!1),f=[e.jsx(U,{style:G.SUCCESS,onClick:u=>{u.preventDefault(),n(Ls({boxId:a,fieldId:s,parentFieldId:o,permissionId:d})),r(t),T(!h)},children:l("Yes")}),e.jsx(U,{style:G.DANGER,onClick:u=>{u.preventDefault(),T(!h)},children:l("No")})];return e.jsxs("div",{children:[e.jsx(he,{title:l("Confirm deleting permission element"),visible:h,buttons:f,children:l("Are you sure?")}),e.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),T(!h)},children:e.jsx($,{icon:!1,tip:l("Delete"),label:e.jsx(_,{icon:"bx-trash",width:18,color:"#F94144"})})})]})};$a.propTypes={boxId:i.string.isRequired,fieldId:i.string.isRequired,permissionId:i.string.isRequired,permissionIndex:i.number.isRequired,parentFieldId:i.string};const Ga=w.memo(({permissionIndex:a,boxIndex:s,fieldIndex:d,boxId:t,fieldId:o,permission:n,formId:c,parentFieldIndex:m,parentFieldId:b})=>{const{group:r}=H(u=>u.metaState),h=u=>`${W(r.boxes,t,o)}.permissions.${a}.${u}`,{register:T,formState:{errors:f}}=P();return e.jsxs(I.Fragment,{children:[e.jsx(be,{id:h("id"),value:n.id,register:T}),e.jsx(be,{id:h("entityId"),value:o,register:T}),e.jsxs("tr",{id:n.id,children:[e.jsx("td",{children:e.jsx(le,{register:T,id:h("userRole"),values:document.globals.globals.roles,errors:f,defaultValue:n.userRole})}),e.jsx("td",{children:e.jsxs("label",{className:"checkbox",htmlFor:h("permissions.edit"),children:[e.jsx("input",{name:h("permissions.edit"),value:!0,defaultChecked:n.permissions.edit===!0,type:"checkbox",id:h("permissions.edit"),...T(h("permissions.edit"),{})}),e.jsx("span",{})]})}),e.jsx("td",{children:e.jsxs("label",{className:"checkbox",htmlFor:h("permissions.read"),children:[e.jsx("input",{name:h("permissions.read"),value:!0,defaultChecked:n.permissions.read===!0,type:"checkbox",id:h("permissions.read"),...T(h("permissions.read"),{})}),e.jsx("span",{})]})}),e.jsx("td",{children:e.jsx($a,{permissionIndex:a,boxId:t,fieldId:o,permissionId:n.id,parentFieldId:b})})]})]})});Ga.propTypes={formId:i.func.isRequired,permissionIndex:i.number.isRequired,boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,fieldId:i.string.isRequired,permission:i.object.isRequired,parentFieldIndex:i.string,parentFieldId:i.string};const Pa=({boxIndex:a,fieldIndex:s,boxId:d,field:t,parentFieldIndex:o,formId:n,parentFieldId:c})=>{const m=document.globals;m.settings;const b=m.globals,r=z(),[h]=Ne(),T=()=>{const f={id:ce(),entityId:t.id,userRole:"editor",permissions:{edit:!0,read:!0}};r($s({boxId:d,fieldId:t.id,parentFieldId:c,permission:f}))};return e.jsxs("div",{ref:h,className:t.permissions&&t.permissions.length>0?"flex-column s-24":"",children:[t.permissions&&t.permissions.length>0?e.jsx("div",{className:"responsive with-shadow b-rounded",children:e.jsxs("table",{className:`acpt-table ${b.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:l("User role")}),e.jsx("th",{children:l("Edit")}),e.jsx("th",{children:l("Read")}),e.jsx("th",{style:{width:"10px"}})]})}),e.jsx("tbody",{ref:h,children:t.permissions.map((f,u)=>e.jsx(Ga,{formId:n,permissionIndex:u,boxIndex:a,fieldIndex:s,boxId:d,fieldId:t.id,permission:f,parentFieldIndex:o,parentFieldId:c}))})]})}):e.jsx(rl,{style:G.WARNING,children:l('No permissions are present, click on "Add permission" button to add the first one.')}),e.jsx("span",{children:e.jsx("a",{href:"#",className:t.permissions&&t.permissions.length>0?"":"mt-24",onClick:f=>{f.preventDefault(),T()},children:l("Add permission")})})]})};Pa.propTypes={boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,parentFieldIndex:i.string,parentFieldId:i.string,field:i.object.isRequired,formId:i.func.isRequired};const ut=({boxIndex:a,fieldIndex:s,boxId:d,field:t,parentFieldIndex:o,parentFieldId:n,parentBlockId:c})=>{const{attributes:m,listeners:b,setNodeRef:r,isDragging:h,transform:T}=Oe({id:t.id}),f={transform:Ie.Translate.toString(T)};z();const{group:u,selectedElementsType:p}=H(C=>C.metaState),{formState:{errors:x},control:R}=P(),S=C=>ke(u.boxes,d,t.id,C),M=V({control:R,name:ke(u.boxes,d,t.id,"name")}),A=V({control:R,name:ke(u.boxes,d,t.id,"label")}),g=V({control:R,name:ke(u.boxes,d,t.id,"type")}),k=()=>{const C=ke(u.boxes,d,t.id,"name"),F=Ae(x,C);return F?e.jsx("span",{className:"invalid-feedback",children:l(F.message)}):M||t.name},N=()=>typeof A=="string"?A:t.label,v=()=>g||t.type;return e.jsxs(I.Fragment,{children:[e.jsx(wl,{boxId:d,field:t,parentFieldId:n,parentBlockId:c}),e.jsx("tr",{id:t.id,ref:r,style:f,className:`bg-white ${h?"b-rounded z-100 with-drop-shadow":""}`,children:e.jsx("td",{style:{background:"#eff6fc3b"},className:"with-active-border",colSpan:7,children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex-between s-8 mb-24 for-xs",children:[e.jsxs("span",{className:"i-flex-center s-8",children:[(n||c)&&e.jsx($,{label:e.jsx(_,{icon:"tabler:arrow-guide",color:"#02C39A",width:18}),tip:l("Child field"),icon:!1}),e.jsx("span",{className:"cursor-move top-2 handle",...m,...b,children:e.jsx(_,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),p!=="box"&&p!=="block"&&yl(t.isSaved)&&e.jsx(Ue,{elementType:"field",element:Sl(t,d,n,c)}),e.jsxs("div",{className:"i-flex-center s-8 text-ellipsis",children:[e.jsx("h3",{children:k()}),e.jsx("span",{className:"color-gray",children:N()})]}),e.jsx(kl,{boxId:d,field:t}),e.jsx(dl,{fieldType:v(),css:"with-border b-rounded p-8"})]}),e.jsx(Rl,{boxIndex:a,field:t,boxId:d,fieldIndex:s,parentFieldIndex:o,parentFieldId:n,parentBlockId:c})]}),e.jsx("div",{children:e.jsxs(st,{children:[e.jsx(Je,{title:e.jsxs(I.Fragment,{children:[e.jsx("span",{className:"visible-xs",children:e.jsx(_,{icon:"bx:cog",width:24})}),e.jsx("span",{className:"hidden-xs",children:l("BASIC OPTIONS")})]}),children:e.jsx(Aa,{boxIndex:a,fieldIndex:s,formId:S,boxId:d,field:t})}),e.jsx(Je,{title:e.jsxs(I.Fragment,{children:[e.jsx("span",{className:"visible-xs",children:e.jsx(_,{icon:"solar:tuning-2-outline",width:24})}),e.jsx("span",{className:"hidden-xs",children:l("ADVANCED OPTIONS")})]}),children:e.jsx(Ia,{boxIndex:a,fieldIndex:s,field:t,formId:S})}),e.jsx(Je,{title:e.jsxs(I.Fragment,{children:[e.jsx("span",{className:"visible-xs",children:e.jsx(_,{icon:"bx:low-vision",width:24})}),e.jsx("span",{className:"hidden-xs",children:l("CONDITIONAL LOGIC")})]}),children:e.jsx(Da,{boxIndex:a,fieldIndex:s,boxId:d,field:t,parentFieldIndex:o,parentFieldId:n,formId:S})}),ll(g||t.type)&&e.jsx(Je,{title:e.jsxs(I.Fragment,{children:[e.jsx("span",{className:"visible-xs",children:e.jsx(_,{icon:"bx:check-double",width:24})}),e.jsx("span",{className:"hidden-xs",children:l("VALIDATION RULES")})]}),children:e.jsx(La,{boxIndex:a,fieldIndex:s,boxId:d,field:t,parentFieldIndex:o,parentFieldId:n,formId:S})}),e.jsx(Je,{title:e.jsxs(I.Fragment,{children:[e.jsx("span",{className:"visible-xs",children:e.jsx(_,{icon:"bx:lock",width:24})}),e.jsx("span",{className:"hidden-xs",children:l("PERMISSIONS")})]}),children:e.jsx(Pa,{boxIndex:a,fieldIndex:s,boxId:d,field:t,parentFieldIndex:o,parentFieldId:n,formId:S})})]})})]})})})]})},cl=({boxIndex:a,fieldIndex:s,boxId:d,field:t,parentFieldIndex:o,parentFieldId:n,parentBlockId:c,isMainView:m})=>{const{closedElements:b}=H(h=>h.metaState);return(()=>{const h=b.filter(T=>T===t.id);return typeof h>"u"?!1:h.length>0})()?e.jsx(da,{isMainView:m,boxIndex:a,field:t,boxId:d,fieldIndex:s,parentFieldIndex:o,parentFieldId:n,parentBlockId:c}):e.jsx(ut,{boxIndex:a,field:t,boxId:d,fieldIndex:s,parentFieldIndex:o,parentFieldId:n,parentBlockId:c})};cl.propTypes={boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,boxId:i.string.isRequired,field:i.object.isRequired,parentFieldIndex:i.string,parentFieldId:i.string,parentBlockId:i.string,isMainView:i.bool.isRequired};const We=({boxIndex:a,boxId:s,parentFieldIndex:d,parentFieldId:t,parentBlockId:o,fields:n,addFieldEnabled:c=!0})=>{const m=document.globals;m.settings;const b=m.globals,r=z(),{group:h,selectedElementsType:T}=H(g=>g.metaState),[f]=Ne(),u=()=>o?`${W(h.boxes,s,o)}.fields`:t?`${W(h.boxes,s,t)}.children`:`boxes.${a}.fields`,p=`select-fields-${us()}`,{control:x}=P(),{move:R}=ie({control:x,name:u()}),S=g=>{const{active:k,over:N}=g;if(k.id===N.id)return;const v=n.findIndex(y=>y.id===k.id),C=n.findIndex(y=>y.id===N.id),F=ye(n,v,C);R(v,C),r(Qe({boxId:s,parentFieldId:t,parentBlockId:o,sortedFields:F}))},M=()=>{const g={id:ce(),boxId:s,name:"meta_box_field",label:"meta box field",type:E.TEXT,defaultValue:"",description:"",isRequired:!1,showInArchive:!1,quickEdit:!1,filterableInAdmin:!1,sort:1,advancedOptions:[],options:[],blocks:[],blockId:o||null,validationRules:[],visibilityConditions:[],hasManyRelation:[],children:[],parentId:t||null,isATextualField:!0,isFilterable:!0,isSaved:!1};r(Pe({boxId:s,parentFieldId:t,parentBlockId:o,field:g}))},A=g=>{n&&n.map(k=>{const N=Sl(k,s,t,o);r($e({element:N,selected:g,type:"field"})),N.children&&N.children.map(v=>{r($e({element:v,selected:g,type:"field"})),v.children&&v.children.map(C=>{r($e({element:C,selected:g,type:"field"}))})})})};return e.jsx(I.Fragment,{children:n&&n.length>0?e.jsxs("div",{className:`responsive ${t?"with-shadow b-rounded":""}`,children:[e.jsxs("table",{className:`acpt-table  ${b.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"10px"},children:T!=="box"&&T!=="block"&&e.jsxs("label",{className:"checkbox",htmlFor:p,style:{marginLeft:"26px"},children:[e.jsx("input",{id:p,type:"checkbox",onChange:g=>{A(g.target.checked)}}),e.jsx("span",{})]})}),e.jsx("th",{className:"hidden-xs",children:l("Label")}),e.jsx("th",{children:l("Slug")}),e.jsx("th",{className:"hidden-xs",style:{width:"10px"}}),e.jsx("th",{children:l("Type")}),e.jsx("th",{children:l("Actions")})]})}),e.jsx("tbody",{ref:f,children:e.jsx(ge,{onDragEnd:S,items:n,children:n&&n.map((g,k)=>e.jsx(cl,{isMainView:!1,boxIndex:a,fieldIndex:k,boxId:s,field:g,parentFieldIndex:d,parentFieldId:t,parentBlockId:o}))})})]}),c&&e.jsx("div",{className:"p-24",children:e.jsx(U,{type:"button",style:G.SECONDARY,onClick:g=>{g.preventDefault(),M()},children:l("Add field")})})]}):e.jsx("div",{className:`${t?"":"mx-24 pb-24"}`,children:e.jsxs("div",{className:"b-maxi b-rounded p-24 flex-column s-12 text-center",children:[e.jsx("span",{children:l('No field box already created. Create the first one now by clicking the button "Add field box"!')}),c&&e.jsx("div",{children:e.jsx(U,{type:"button",style:G.SECONDARY,onClick:g=>{g.preventDefault(),M()},children:l("Add field")})})]})})})};We.propTypes={boxIndex:i.number.isRequired,boxId:i.string.isRequired,fields:i.array.isRequired,parentFieldIndex:i.string,parentFieldId:i.string,parentBlockId:i.string,addFieldEnabled:i.bool};const Ka=({index:a,box:s,setActiveTab:d})=>{const{attributes:t,listeners:o,setNodeRef:n,isDragging:c,transform:m}=Oe({id:s.id}),b={transform:Ie.Translate.toString(m)},{closedElements:r}=H(f=>f.metaState),[h]=Ne(),T=()=>r.filter(u=>u===s.id).length===1;return e.jsxs("div",{id:s.id,className:`bg-white b-rounded ${c?"z-100 with-drop-shadow":"with-shadow"}`,ref:n,style:b,children:[e.jsx(la,{index:a,setActiveTab:d,attributes:t,listeners:o,box:s}),e.jsx("div",{ref:h,children:!T()&&e.jsx(We,{boxIndex:a,boxId:s.id,fields:s.fields})})]})};Ka.propTypes={index:i.number.isRequired,box:i.object.isRequired,setActiveTab:i.func};const Ua=({id:a,control:s,register:d,errors:t,belong:o,handleDeleteBelong:n,values:c,isLast:m,index:b,resetField:r,setValue:h,clearErrors:T,format:f="all"})=>{const{data:u}=H(F=>F.fetchMeta),p=F=>`${a}.${b}.${F}`,x=V({control:s,name:p("belongsTo")}),R=V({control:s,name:p("operator")}),S=V({control:s,name:p("find")});w.useEffect(()=>{m&&r(p("logic"))},[m]),w.useEffect(()=>{x!==o.belongsTo&&r(p("find"))},[x]),w.useEffect(()=>{R||h(p("operator"),"=")},[R]);const M=()=>x?c[x]?c[x]:[]:u.belongs&&u.belongs[b]?c[u.belongs[b].belongsTo]?c[u.belongs[b].belongsTo]:[]:[],A=()=>S?typeof S=="string"?S.split(","):S:[],g=()=>f==="reduced"?[{value:null,label:l("Select")},{label:l("Posts"),options:[{value:te.CUSTOM_POST_TYPE,label:l("Post type")},{value:"POST_ID",label:l("Post")}]},{label:l("Taxonomies"),options:[{value:te.TAXONOMY,label:l("Taxonomy")},{value:"TERM_ID",label:l("Term")}]}]:[{value:null,label:l("Select")},{label:l("Posts"),options:[{value:te.CUSTOM_POST_TYPE,label:l("Post type")},{value:"POST_ID",label:l("Post")},{value:"PARENT_POST_ID",label:l("Post parent")},{value:"POST_CAT",label:l("Post category")},{value:"POST_TAX",label:l("Post taxonomy")},{value:"POST_TEMPLATE",label:l("Post template")}]},{label:l("Taxonomies"),options:[{value:te.TAXONOMY,label:l("Taxonomy")},{value:"TERM_ID",label:l("Term")}]},{label:l("Attachment"),options:[{value:te.MEDIA,label:l("Attachment")}]},{label:l("Option pages"),options:[{value:te.OPTION_PAGE,label:l("Option page")}]},{label:l("Comments"),options:[{value:te.COMMENT,label:l("All comments")}]},{label:l("Users"),options:[{value:te.USER,label:l("All users")},{value:"USER_ID",label:l("User")}]}],k=[{value:null,label:l("Select")},{value:"=",label:l("is equal to")},{value:"!=",label:l("is not equal to")},{value:"IN",label:l("is included in")},{value:"NOT_IN",label:l("is not included in")}],N=[{value:null,label:l("Select")},{label:l("AND"),value:"AND"},{label:l("OR"),value:"OR"}],v=()=>x===te.USER||x===te.COMMENT?!0:!x,C=()=>x===te.USER||x===te.COMMENT?{required:!1}:{required:l("This field is mandatory")};return e.jsxs("tr",{id:o.id,children:[e.jsx(be,{register:d,id:p("id"),value:o.id}),e.jsx("td",{children:e.jsx(le,{register:d,id:p("belongsTo"),values:g(),errors:t,onChangeCapture:()=>{r(p("find")),h(p("find"),[])},validate:{required:l("This field is mandatory")}})}),e.jsx("td",{children:e.jsx(le,{register:d,id:p("operator"),values:k,defaultValue:"=",errors:t,disabled:v(),validate:C()})}),e.jsx("td",{children:R==="IN"||R==="NOT_IN"?e.jsx(Ge,{register:d,id:p("find"),values:M(),errors:t,disabled:v(),validate:C(),setValue:h,clearErrors:T,defaultValue:A()}):e.jsx(le,{register:d,id:p("find"),values:M(),errors:t,disabled:v(),validate:C()})}),e.jsx("td",{children:!m&&e.jsx(le,{register:d,id:p("logic"),values:N,errors:t,validate:{required:l("This field is mandatory")}})}),e.jsx("td",{children:e.jsx("a",{href:"#",onClick:F=>{F.preventDefault(),n(b,o.id)},children:e.jsx($,{icon:!1,tip:l("Delete"),label:e.jsx(_,{icon:"bx-trash",width:18,color:"#F94144"})})})})]})};Ua.propTypes={id:i.string.isRequired,index:i.number.isRequired,belong:i.object.isRequired,register:i.func.isRequired,errors:i.object.isRequired,isLast:i.bool.isRequired,handleDeleteBelong:i.func.isRequired,resetField:i.func.isRequired,setValue:i.func.isRequired,clearErrors:i.func.isRequired,format:i.oneOf(["all","reduced"])};const Ya=({id:a,control:s,register:d,handleAddBelong:t,handleDeleteBelong:o,conditions:n,values:c,errors:m,resetField:b,setValue:r,clearErrors:h,format:T="all"})=>{const f=document.globals;f.settings;const u=f.globals,[p]=Ne();return e.jsx(I.Fragment,{children:e.jsxs("div",{className:`${!ve(c)&&n&&n.length>0?"flex-column s-12":""}`,children:[e.jsx("label",{className:"form-label px-24",children:l("Location")}),!ve(c)&&n&&n.length>0?e.jsxs("div",{className:"responsive",children:[e.jsxs("table",{className:`acpt-table ${u.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:l("Location")}),e.jsx("th",{style:{maxWidth:"100px"},children:l("Condition")}),e.jsx("th",{children:l("Value")}),e.jsx("th",{style:{maxWidth:"100px"},children:l("Logic")}),e.jsx("th",{})]})}),e.jsx("tbody",{ref:p,children:n.map((x,R)=>e.jsx(Ua,{id:a,format:T,register:d,errors:m,control:s,belong:x,index:R,handleDeleteBelong:o,values:c,isLast:R===n.length-1,resetField:b,setValue:r,clearErrors:h}))})]}),e.jsx("div",{className:"b-top-1 p-24",children:e.jsx(U,{type:"button",style:G.SECONDARY,onClick:()=>{t()},children:l("Add condition")})})]}):e.jsxs("div",{className:"m-24 b-maxi b-rounded p-24 flex-column s-8 text-center",children:[e.jsx("span",{children:l('No conditions are present, click on "Add condition" button to add the first one.')}),e.jsx("div",{children:e.jsx(U,{type:"button",style:G.SECONDARY,onClick:()=>{t()},children:l("Add condition")})})]})]})})};Ya.propTypes={id:i.string.isRequired,values:i.array.isRequired,append:i.func.isRequired,register:i.func.isRequired,unregister:i.func.isRequired,resetField:i.func.isRequired,conditions:i.array.isRequired,errors:i.array.isRequired,handleDeleteBelong:i.func.isRequired,handleAddBelong:i.func.isRequired,setValue:i.func.isRequired,clearErrors:i.func.isRequired,format:i.oneOf(["all","reduced"])};const Ha=({groupId:a})=>{const d=document.globals.globals,t=z(),{group:o}=H(C=>C.metaState),n=d.find,[c]=Ne(),{control:m,register:b,unregister:r,formState:{errors:h},setValue:T,resetField:f,clearErrors:u}=P(),{append:p,remove:x}=ie({control:m,name:"belongs"}),R=()=>{const C={id:ce(),belongsTo:null,operator:null,find:null,logic:null};t(Gs({belong:C}))},S=(C,F)=>{t(Ps({belongId:F})),x(C)},{id:M}=Ee(),[A,g]=w.useState(typeof M!="string"),k=()=>[{label:l("Standard view"),value:He.STANDARD},{label:l("Accordion"),value:He.ACCORDION},{label:l("Horizontal tabs"),value:He.HORIZONTAL_TABS},{label:l("Vertical tabs"),value:He.VERTICAL_TABS}],N=()=>[{label:"advanced",value:"advanced"},{label:"normal",value:"normal"},{label:"side",value:"side"}],v=()=>[{label:"default",value:"default"},{label:"core",value:"core"},{label:"high",value:"high"},{label:"low",value:"low"}];return e.jsxs("div",{ref:c,children:[e.jsxs("div",{className:"i-flex-center s-8 mb-24",children:[e.jsx(_,{icon:"bx:cog",width:24,color:"#007CBA"}),e.jsx("h3",{children:l("Settings")}),e.jsx("a",{href:"#",onClick:C=>{C.preventDefault(),g(!A)},children:l(`${A?"Close":"Edit"}`)})]}),!A&&e.jsx("div",{className:"line-separator mb-24"}),A&&e.jsxs("div",{className:"mb-24 bg-white b-rounded with-shadow flex-column b-top-1 pt-24",style:{marginTop:"0"},children:[e.jsxs("div",{className:"container p-24",children:[e.jsxs("div",{className:"col-4",children:[e.jsx(Q,{id:"display",label:l("Display as")}),e.jsx(le,{id:"display",register:b,errors:h,values:k(),defaultValue:!ve(o)&&o.display?o.display:He.STANDARD})]}),e.jsxs("div",{className:"col-4",children:[e.jsx(Q,{id:"context",label:l("Context")}),e.jsx(le,{id:"context",register:b,errors:h,values:N(),defaultValue:!ve(o)&&o.context?o.context:"advanced"})]}),e.jsxs("div",{className:"col-4",children:[e.jsx(Q,{id:"priority",label:l("Priority")}),e.jsx(le,{id:"priority",register:b,errors:h,values:v(),defaultValue:!ve(o)&&o.priority?o.priority:"default"})]})]}),e.jsx(Ya,{id:"belongs",values:n,conditions:o.belongs?o.belongs:[],append:p,register:b,unregister:r,remove:x,errors:h,control:m,handleAddBelong:R,handleDeleteBelong:S,resetField:f,setValue:T,clearErrors:u})]})]})};Ha.propTypes={groupId:i.string.isRequired};const za=({boxIds:a,modalOpen:s,setModalOpen:d})=>{const o=document.globals.globals,{setValue:n}=P(),c=z(),{id:m}=Ee(),[b,r]=w.useState(null),[h,T]=w.useState(!1),f=()=>{let u=[];a.map(p=>{u.push(p.id)}),ue("copyMetaBoxesAction",{boxIds:u,targetGroupId:b,delete:h}).then(p=>{p.success?(xe.success(`${l("Meta box was successfully copied")}.${l("The browser will refresh after 5 seconds.")}`),d(!s),c(ol()),m===b&&c(Be({id:m})).then(x=>{c(Ce(x.payload)),n("id",m),n("name",x.payload.name),n("label",x.payload.label),n("display",x.payload.display),x.payload.belongs&&x.payload.belongs.map((R,S)=>{n(`belongs.${S}.id`,R.id),n(`belongs.${S}.belongsTo`,R.belongsTo),n(`belongs.${S}.operator`,R.operator),n(`belongs.${S}.find`,R.find),n(`belongs.${S}.logic`,R.logic)}),x.payload.boxes&&x.payload.boxes.map((R,S)=>{n(`boxes.${S}`,R)})}).catch(x=>{console.error(x)})):xe.error(p.error)}).catch(p=>console.error(p))};return e.jsx(I.Fragment,{children:e.jsx(he,{title:l("Copy selected meta boxes"),visible:s,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:l("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:u=>r(u.target.value),children:o.find.meta.map(u=>e.jsx("option",{value:u.value,children:u.label}))})})]}),b&&b!=="Select"&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:h,onClick:()=>T(!h),id:"deleteBoxes"}),e.jsx("label",{htmlFor:"deleteBoxes",children:l("Delete after copying")})]}),e.jsx(U,{onClick:()=>f(),style:G.PRIMARY,children:l("Copy")})]})]})})})};za.propTypes={boxIds:i.array.isRequired,modalOpen:i.bool.isRequired,setModalOpen:i.func.isRequired};const Ja=({fieldIds:a,modalOpen:s,setModalOpen:d})=>{const o=document.globals.globals,{setValue:n}=P(),c=z(),{id:m}=Ee(),[b,r]=w.useState(null),[h,T]=w.useState([]),[f,u]=w.useState([]),[p,x]=w.useState(null),[R,S]=w.useState(null),[M,A]=w.useState(!1);w.useEffect(()=>{r(null),T([]),u([]),x(null),S(null),A(!1)},[s]);const g=C=>{r(C),T([]),u([]),x(null),S(null),A(!1),ue("fetchMetaAction",{id:C}).then(F=>{T(F.boxes)}).catch(F=>console.error(F))},k=C=>{u([]),x("box"),S(C);const F=h.filter(y=>y.id===C)[0].fields;if(F&&F.length>0){const y=F.filter(j=>j.type===E.REPEATER||j.type===E.FLEXIBLE);y&&y.length>0&&u(y)}},N=C=>{x("field"),S(C)},v=()=>{let C=[];a.map(F=>{C.push(F.id)}),ue("copyMetaFieldsAction",{fieldIds:C,targetEntityType:p,targetEntityId:R,delete:M}).then(F=>{F.success?(xe.success(`${l("Meta field was successfully copied")}.`),d(!s),c(ol()),m===b&&c(Be({id:m})).then(y=>{c(Ce(y.payload)),n("id",m),n("name",y.payload.name),n("label",y.payload.label),n("display",y.payload.display),y.payload.belongs&&y.payload.belongs.map((j,O)=>{n(`belongs.${O}.id`,j.id),n(`belongs.${O}.belongsTo`,j.belongsTo),n(`belongs.${O}.operator`,j.operator),n(`belongs.${O}.find`,j.find),n(`belongs.${O}.logic`,j.logic)}),y.payload.boxes&&y.payload.boxes.map((j,O)=>{n(`boxes.${O}`,j)})}).catch(y=>{console.error(y)})):xe.error(F.error)}).catch(F=>console.error(F))};return e.jsx(I.Fragment,{children:e.jsx(he,{title:l("Copy selected meta fields"),visible:s,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:l("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:C=>g(C.target.value),children:o.find.meta.map(C=>e.jsx("option",{value:C.value,children:C.label}))})})]}),h&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"box",children:l("Meta box")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"box",className:"form-control default",onChangeCapture:C=>k(C.target.value),children:[e.jsx("option",{value:null,children:l("Select")}),h.map(C=>e.jsx("option",{value:C.id,children:C.name}))]})})]}),f&&f.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"field",children:l("Meta field")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"field",className:"form-control default",onChangeCapture:C=>N(C.target.value),children:[e.jsx("option",{value:null,children:l("Select")}),f.map(C=>e.jsx("option",{value:C.id,children:C.name}))]})})]}),p&&R&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:M,onClick:()=>A(!M),id:"deleteFields"}),e.jsx("label",{htmlFor:"deleteFields",children:l("Delete the meta field after copying")})]}),e.jsx(U,{onClick:()=>v(),style:G.PRIMARY,children:l("Copy")})]})]})})})};Ja.propTypes={fieldIds:i.array.isRequired,modalOpen:i.bool.isRequired,setModalOpen:i.func.isRequired};const Wa=({blockIds:a,modalOpen:s,setModalOpen:d})=>{const o=document.globals.globals,{setValue:n}=P(),c=z(),{id:m}=Ee(),[b,r]=w.useState(null),[h,T]=w.useState([]),[f,u]=w.useState([]),[p,x]=w.useState(null),[R,S]=w.useState(!1);w.useEffect(()=>{r(null),T([]),u([]),x(null),S(!1)},[s]);const M=N=>{r(N),T([]),u([]),x(null),S(!1),ue("fetchMetaAction",{id:N}).then(v=>{T(v.boxes)}).catch(v=>console.error(v))},A=N=>{u([]);const v=h.filter(C=>C.id===N)[0].fields;u(v)},g=N=>{x(N)},k=()=>{let N=[];a.map(v=>{N.push(v.id)}),ue("copyMetaBlocksAction",{blockIds:N,targetFieldId:p,delete:R}).then(v=>{v.success?(xe.success(`${l("Meta block was successfully copied")}.${l("The browser will refresh after 5 seconds.")}`),d(!s),m===b&&c(Be({id:m})).then(C=>{c(Ce(C.payload)),n("id",m),n("name",C.payload.name),n("label",C.payload.label),n("display",C.payload.display),C.payload.belongs&&C.payload.belongs.map((F,y)=>{n(`belongs.${y}.id`,F.id),n(`belongs.${y}.belongsTo`,F.belongsTo),n(`belongs.${y}.operator`,F.operator),n(`belongs.${y}.find`,F.find),n(`belongs.${y}.logic`,F.logic)}),C.payload.boxes&&C.payload.boxes.map((F,y)=>{n(`boxes.${y}`,F)})}).catch(C=>{console.error(C)})):xe.error(v.error)}).catch(v=>console.error(v))};return e.jsx(he,{title:l("Copy selected meta blocks"),visible:s,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:l("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:N=>M(N.target.value),children:o.find.meta.map(N=>e.jsx("option",{value:N.value,children:N.label}))})})]}),h&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"box",children:l("Meta box")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"box",className:"form-control default",onChangeCapture:N=>A(N.target.value),children:[e.jsx("option",{value:null,children:l("Select")}),h.map(N=>e.jsx("option",{value:N.id,children:N.name}))]})})]}),f&&f.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"field",children:l("Meta field")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"field",className:"form-control default",onChangeCapture:N=>g(N.target.value),children:[e.jsx("option",{value:null,children:l("Select")}),f.map(N=>e.jsx("option",{value:N.id,children:N.name}))]})})]}),p&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:R,onClick:()=>S(!R),id:"deleteBlocks"}),e.jsx("label",{htmlFor:"deleteBlocks",children:l("Delete the meta block after copying")})]}),e.jsx(U,{onClick:()=>k(),style:G.PRIMARY,children:l("Copy")})]})]})})};Wa.propTypes={blockIds:i.array.isRequired,modalOpen:i.bool.isRequired,setModalOpen:i.func.isRequired};const Xa=({setFieldTab:a,setBoxTab:s,setBlockTab:d})=>{const t=z(),{selectedElements:o,selectedElementsType:n}=H(g=>g.metaState),{control:c,setValue:m,getValues:b}=P(),r=V({control:c,name:"boxes"}),h=w.useRef(null),[T,f]=w.useState(null),[u,p]=w.useState(!1),[x,R]=w.useState(!1),[S,M]=w.useState(!1),A=()=>{o.map(g=>{switch(T){case"copy":n==="box"?p(!u):n==="block"?M(!S):R(!x);break;case"duplicate":if(n==="box"){const k=r.findIndex(C=>C.id===g.id),N=r[k],v=Kl(N);r.push(v),m("boxes",r),t(nl(v))}else if(n==="block"){const k=ql(r,g.boxId,g.id),N=zl(g.boxId,g.parentFieldId,k),v=W(r,g.boxId,g.id,!1),C=b(v);C.push(N),m(v,C),t(il({boxId:g.boxId,parentFieldId:g.parentFieldId,block:N}))}else{const k=ql(r,g.boxId,g.id),N=Yl(g.boxId,k),v=W(r,g.boxId,g.id,!1),C=b(v);C.push(N),m(v,C),t(Pe({boxId:g.boxId,field:N,parentFieldId:g.parentFieldId,parentBlockId:g.parentBlockId}))}break;case"delete":if(n==="box"){const k=r?r.filter(N=>N.id!==g.id):[];m("boxes",k),s&&s(0),t(Pl(g.id))}else if(n==="block"){const k=W(r,g.boxId,g.id,!1),N=b(k)?b(k).filter(v=>v.id!==g.id):[];m(k,N),d&&d(0),t(Hl({boxId:g.boxId,parentFieldId:g.parentFieldId,blockId:g.id}))}else{const k=W(r,g.boxId,g.id,!1),N=b(k)?b(k).filter(v=>v.id!==g.id):[];m(k,N),a&&a(0),t(Ul({boxId:g.boxId,fieldId:g.id,parentFieldId:g.parentFieldId,parentBlockId:g.parentBlockId}))}break}}),(T==="delete"||T==="duplicate")&&t(ol()),h.current.value=""};return e.jsxs(I.Fragment,{children:[e.jsx(za,{boxIds:o,modalOpen:u,setModalOpen:p}),e.jsx(Ja,{fieldIds:o,modalOpen:x,setModalOpen:R}),e.jsx(Wa,{blockIds:o,modalOpen:S,setModalOpen:M}),o&&o.length>0&&e.jsxs("div",{className:"flex-between",children:[e.jsxs("div",{children:[o.length," ",l("Selected items")]}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsxs("select",{ref:h,className:"form-control sm",onChange:g=>{f(g.target.value!==""?g.target.value:null)},children:[e.jsx("option",{value:"",children:l("Select")}),e.jsx("option",{value:"copy",children:l("Copy")}),e.jsx("option",{value:"duplicate",children:l("Duplicate")}),e.jsx("option",{value:"delete",children:l("Delete")})]}),e.jsx(U,{style:G.WHITE,size:"sm",disabled:T===null,onClick:g=>{g.preventDefault(),A()},children:l("Execute")})]})]})]})};Xa.propTypes={setBoxTab:i.func,setFieldTab:i.func,setBlockTab:i.func};const Qa=({level:a,boxIndex:s,fieldIndex:d,blockIndex:t,boxId:o,parentField:n,block:c})=>{const{group:m}=H(h=>h.metaState),{control:b}=P(),r=V({control:b,name:`${W(m.boxes,o,n.id)}.blocks.${t}.name`});return e.jsxs(I.Fragment,{children:[e.jsxs("div",{className:"tree-el flex-between s-8",style:{"--level":a},children:[e.jsx("span",{className:"cursor-pointer text-ellipsis",onClick:h=>{h.preventDefault(),Me(c.id)},children:r||c.name}),e.jsx(Gl,{style:G.INFO,children:"B"})]},c.id),c.fields&&c.fields.length>0&&c.fields.map((h,T)=>e.jsx(ul,{level:a+1,boxIndex:s,fieldIndex:T,boxId:o,parentField:n,field:h}))]})};Qa.propTypes={level:i.number.isRequired,boxIndex:i.number.isRequired,fieldIndex:i.number.isRequired,blockIndex:i.number.isRequired,boxId:i.string.isRequired,block:i.object.isRequired,parentField:i.object.isRequired};const ul=({level:a,boxIndex:s,fieldIndex:d,boxId:t,parentField:o,field:n})=>{const{group:c}=H(g=>g.metaState),m=z(),{attributes:b,listeners:r,setNodeRef:h,isDragging:T,transform:f}=Oe({id:n.id}),u={transform:Ie.Translate.toString(f)},{control:p}=P(),x=V({control:p,name:`${W(c.boxes,t,n.id)}.name`}),{move:R}=ie({control:p,name:`${W(c.boxes,t,n.id)}.children`}),{move:S}=ie({control:p,name:`${W(c.boxes,t,n.id)}.blocks`}),M=g=>{const{active:k,over:N}=g;if(k.id===N.id)return;const v=n.blocks,C=v.findIndex(j=>j.id===k.id),F=v.findIndex(j=>j.id===N.id),y=ye(v,C,F);S(C,F),m(Cl({boxId:t,parentFieldId:n.id,sortedBlocks:y}))},A=g=>{const{active:k,over:N}=g;if(k.id===N.id)return;const v=n.children,C=v.findIndex(j=>j.id===k.id),F=v.findIndex(j=>j.id===N.id),y=ye(v,C,F);R(C,F),m(Qe({boxId:t,parentFieldId:n.id,parentBlockId:null,sortedFields:y}))};return e.jsxs(I.Fragment,{children:[e.jsxs("div",{className:`tree-el level${a} flex-between s-8`,ref:h,style:u,children:[e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"cursor-move top-2 handle",...b,...r,children:e.jsx(_,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),e.jsx("span",{className:"cursor-pointer text-ellipsis",onClick:g=>{g.preventDefault(),Me(`${n.id}`)},children:x||n.name})]}),e.jsx(Gl,{style:o?G.SUCCESS:G.SECONDARY,children:o?"C":"F"})]},n.id),n.children&&n.children.length>0&&e.jsx(ge,{onDragEnd:A,items:n.children,children:e.jsx(I.Fragment,{children:n.children.map((g,k)=>e.jsx(ul,{level:a+1,boxIndex:s,fieldIndex:k,boxId:t,parentField:n,field:g}))})}),n.blocks&&n.blocks.length>0&&e.jsx(ge,{onDragEnd:M,items:n.blocks,children:e.jsx(I.Fragment,{children:n.blocks.map((g,k)=>e.jsx(Qa,{boxIndex:s,block:g,blockIndex:k,boxId:t,level:a+1,parentField:n,fieldIndex:d}))})})]})};ul.propTypes={level:i.number.isRequired,fieldIndex:i.number.isRequired,boxIndex:i.number.isRequired,boxId:i.string.isRequired,field:i.object.isRequired,parentField:i.object};const Za=({index:a,box:s})=>{const t=document.globals.globals,o=z(),[n,c]=w.useState(!1),{attributes:m,listeners:b,setNodeRef:r,isDragging:h,transform:T}=Oe({id:s.id}),f={transform:Ie.Translate.toString(T)},{control:u}=P(),p=V({control:u,name:`boxes.${a}.name`}),{move:x}=ie({control:u,name:`boxes.${a}.fields`}),R=S=>{const{active:M,over:A}=S;if(M.id===A.id)return;const g=s.fields,k=g.findIndex(C=>C.id===M.id),N=g.findIndex(C=>C.id===A.id),v=ye(g,k,N);x(k,N),o(Qe({boxId:s.id,sortedFields:v,parentFieldId:null,parentBlockId:null}))};return e.jsxs("div",{ref:r,style:f,className:"b-rounded with-shadow bg-white p-24",children:[e.jsxs("h3",{className:`${!n&&s.fields&&s.fields.length>0?"mb-24":""} flex-between s-8`,children:[e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"cursor-move top-2 handle",...m,...b,children:e.jsx(_,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),e.jsx("span",{className:"text-ellipsis cursor-pointer",onClick:S=>{S.preventDefault(),Me(s.id)},children:p||s.name})]}),e.jsx("span",{className:"cursor-pointer top-2",style:{paddingRight:"6px"},onClick:()=>c(!n),children:e.jsx(_,{width:18,icon:n?"bx:chevron-up":"bx:chevron-down",color:"#777"})})]}),!n&&s.fields&&s.fields.length>0&&e.jsx("div",{className:`tree ${t.is_rtl===!0?"rtl":""}`,children:e.jsx(ge,{onDragEnd:R,items:s.fields,children:e.jsx(I.Fragment,{children:s.fields&&s.fields.map((S,M)=>e.jsx(ul,{level:0,boxIndex:a,fieldIndex:M,boxId:s.id,field:S}))})})})]},s.id)};Za.propTypes={index:i.number.isRequired,box:i.object.isRequired};const es=({boxes:a})=>{if(typeof a>"u"||a.length===0)return null;const s=z(),{control:d}=P(),{move:t}=ie({control:d,name:"boxes"}),o=n=>{const{active:c,over:m}=n;if(c.id===m.id)return;const b=a.findIndex(T=>T.id===c.id),r=a.findIndex(T=>T.id===m.id),h=ye(a,b,r);t(b,r),s(Ql(h))};return e.jsx(I.Fragment,{children:e.jsx(ge,{onDragEnd:o,items:a,children:e.jsx(I.Fragment,{children:a&&a.map((n,c)=>e.jsx(Za,{index:c,box:n}))})})})};es.propTypes={boxes:i.array.isRequired};const ls=({boxes:a})=>{const s=z(),{group:d,closedElements:t}=H(x=>x.metaState),o=ce(),[n,c]=Ne(),{control:m}=P(),{move:b}=ie({control:m,name:"boxes"}),[r,h]=w.useState(Vl(d.id));w.useEffect(()=>{typeof d.id<"u"&&h(Vl(d.id))},[d]);const T=()=>{const x=ce(),R={id:x,name:"meta_box_title",UIName:"meta box title",label:"meta box title",fields:[],isSaved:!1,sort:d.boxes?d.boxes.length:1};s(nl(R)),Xe(1).then(()=>{Me(`${x}`)})},f=x=>{const{active:R,over:S}=x;if(R.id===S.id)return;const M=a.findIndex(k=>k.id===R.id),A=a.findIndex(k=>k.id===S.id),g=ye(a,M,A);b(M,A),s(Ql(g))},u=()=>{const x=Ks(d.boxes);t.length>0?(s(Us()),Ys(x)):(s(Hs()),zs(x))},p=x=>{Js(d.id,x),h(!r)};return e.jsxs(I.Fragment,{children:[e.jsx(Ha,{groupId:ve(d)?o:d.id}),e.jsxs("div",{className:"flex-column s-24",ref:n,children:[e.jsxs("div",{className:"flex-between s-8",children:[e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(_,{icon:"bx:box",width:24,color:"#007CBA"}),e.jsx("h3",{children:l("Meta boxes")}),e.jsx("span",{className:"px-8 py-4 font-sm bg-light-gray text-normal b-rounded",children:a&&a.length>0?a.length:0}),e.jsx("a",{href:"#",onClick:x=>{x.preventDefault(),u()},children:l(t.length>0?"Show elements":"Hide elements")})]}),a&&a.length>0&&e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{htmlFor:"toggle_navigation",className:"toggle",children:[e.jsx("input",{id:"toggle_navigation",type:"checkbox",checked:r,onChangeCapture:x=>{p(x.target.checked)}}),e.jsx("span",{className:"slider round"})]})}),e.jsx("label",{className:"cursor-pointer",htmlFor:"toggle_navigation",children:l(r?"Hide navigation":"Show navigation")})]})]}),e.jsx(Xa,{}),a&&a.length>0?e.jsxs("div",{ref:c,className:"container",children:[r&&e.jsx("div",{className:"col-3 flex-column s-24 hidden-xs sticky",style:{top:"130px"},children:e.jsx(es,{boxes:a})}),e.jsxs("div",{className:`flex-column s-24 ${r?"col-9":"col-12"}`,children:[e.jsx(ge,{onDragEnd:f,items:a,children:e.jsx(I.Fragment,{children:a&&a.map((x,R)=>e.jsx(Ka,{index:R,box:x},x.id))})}),e.jsx("div",{children:e.jsx(U,{type:"button",style:G.WHITE,onClick:()=>{T()},children:l("Add meta box")})})]})]}):e.jsx("div",{className:"mb-24 p-24 bg-white with-shadow",children:e.jsxs("div",{className:"b-maxi b-rounded p-24 flex-column s-12 text-center",children:[e.jsx("span",{children:l('No meta box already created. Create the first one now by clicking the button "Add meta box"!')}),e.jsx("div",{children:e.jsx(U,{type:"button",style:G.SECONDARY,onClick:()=>{T()},children:l("Add meta box")})})]})})]})]})};ls.propTypes={boxes:i.array.isRequired};const ht=()=>{const a=z(),[s,d]=w.useState(!1),{unregister:t}=P(),o=[e.jsx(U,{style:G.SUCCESS,onClick:n=>{n.preventDefault(),a(Ws()),a(ol()),t("boxes"),d(!s)},children:l("Yes")}),e.jsx(U,{style:G.DANGER,onClick:n=>{n.preventDefault(),d(!s)},children:l("No")})];return e.jsxs(I.Fragment,{children:[e.jsx(he,{title:l("Confirm deleting all"),visible:s,buttons:o,children:l("Are you sure?")}),e.jsx(U,{type:"button",style:G.DANGER,onClick:n=>{n.preventDefault(),d(!s)},children:l("Delete all")})]})},mt=a=>{const s="You have unsaved changes. Continue?";w.useEffect(()=>{const d=t=>{if(a)return t.returnValue=s,s};return window.addEventListener("beforeunload",d),()=>window.removeEventListener("beforeunload",d)},[a])},as=({groupId:a})=>{const{register:s,formState:{errors:d},control:t,setValue:o,resetField:n}=P(),c=V({control:t,name:"name"}),m=V({control:t,name:"label"}),{group:b}=H(x=>x.metaState),[r,h]=w.useState(!0),[T,f]=w.useState(!1),u=()=>d&&d.name?e.jsx("span",{className:"invalid-feedback",children:l("Group name error(s). Please fix it.")}):d&&d.belongs?e.jsx("span",{className:"invalid-feedback",children:l("Location rules error(s). Please fix it.")}):c?e.jsx("span",{children:c}):e.jsx("span",{children:ve(b)?"group_name":b.name}),p=()=>m?e.jsx("span",{className:"color-gray",children:m}):!ve(b)&&b.label?e.jsx("span",{className:"color-gray",children:b.label}):l("Group name");return e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(be,{id:"id",value:a,register:s}),T?e.jsxs(I.Fragment,{children:[e.jsx("div",{children:e.jsx(Z,{id:"label",register:s,placeholder:l("Group label"),defaultValue:ve(b)?null:b.label,errors:d,onChangeCapture:x=>{r&&o("name",we(Fe(x.target.value)))},onClick:x=>{x.target.value==="group name"&&n("label")},validate:{maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("div",{children:e.jsx(Z,{id:"name",register:s,placeholder:l("Group name"),defaultValue:ve(b)?"group_name":b.name,errors:d,isRequired:!0,validate:{validate:Ke,required:l("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("div",{children:e.jsx($,{label:e.jsx("span",{className:`acpt-btn-switch ${r===!0?"active":""}`,onClick:x=>{x.preventDefault(),h(!r)},children:e.jsx(_,{icon:"bx-link",width:18})}),tip:l(`${r?"Auto slug ON":"Auto slug OFF"}`),icon:!1})})]}):e.jsxs(I.Fragment,{children:[e.jsx("h1",{children:u()}),p()&&e.jsx("span",{className:"font-regular text-normal",children:p()})]}),e.jsx(U,{style:G.SECONDARY,size:"sm",onClick:x=>{x.preventDefault(),f(!T)},children:l(`${T?"Close":"Edit"}`)})]})};as.propTypes={groupId:i.string.isRequired};const $t=()=>{const a=w.useRef(null),s=z(),{error:d,success:t,loading:o}=H(y=>y.saveMeta),{loading:n}=H(y=>y.fetchMeta),{group:c}=H(y=>y.metaState),m=ce(),{id:b}=Ee(),[r,h]=hs(),T=b||m,[f,u]=w.useState(!1),[p,x]=w.useState(!1),[R,S]=w.useState(!1),[M,A]=w.useState(0);ms();const g=lt({mode:"onChange"});w.useEffect(()=>{Dl(`${l("Manage meta fields")}${p?"*":""}`)},[p]),mt(p),al([a],()=>{s(et())});const k=()=>{const y=ce(),j={id:y,name:"meta_box_title",UIName:"meta box title",label:"meta box title",fields:[],isSaved:!1,sort:c.boxes?c.boxes.length:1};s(nl(j)),A(c.boxes?c.boxes.length:0),Xe(1).then(()=>{Me(`${y}`)})};w.useEffect(()=>{if(Dl(l("Manage meta fields")),Xs("#/meta"),b)s(Be({id:b})).then(y=>{s(Ce(y.payload)),g.setValue("id",b),g.setValue("name",y.payload.name),g.setValue("label",y.payload.label),g.setValue("display",y.payload.display),g.setValue("context",y.payload.context),g.setValue("priority",y.payload.priority),y.payload.belongs&&y.payload.belongs.map((j,O)=>{g.setValue(`belongs.${O}.id`,j.id),g.setValue(`belongs.${O}.belongsTo`,j.belongsTo),g.setValue(`belongs.${O}.operator`,j.operator),g.setValue(`belongs.${O}.find`,j.find),g.setValue(`belongs.${O}.logic`,j.logic)}),y.payload.boxes&&y.payload.boxes.map((j,O)=>{g.setValue(`boxes.${O}`,j)})}).catch(y=>{console.error(y),S(!0)});else{const y=r.get("find"),j=r.get("belongsTo"),O=`${y?y+"_":""}group_name`,B=`${y?y+" ":""}group name`;let X={name:O,label:B};if(g.reset(),g.setValue("name",O),g.setValue("label",B),y&&j){const ae=ce();g.setValue("belongs.0.id",ae),g.setValue("belongs.0.belongsTo",j),g.setValue("belongs.0.operator","="),g.setValue("belongs.0.find",y),X.belongs=[],X.belongs.push({id:ae,belongsTo:j,operator:"=",find:y})}s(Ce(X))}},[b]);const N=()=>!(f||o||!ve(g.formState.errors)),v=y=>{u(!0),s(Zs(y)).then(j=>{const O=j.payload;O.success?(g.reset({},{keepValues:!0,keepIsSubmitted:!0}),x(!1),ml.success(l("Meta group settings successfully saved")),s(Ce(y)),C(y),bs()):ml.error(O.error),u(!1)}).catch(j=>{ml.error(j),u(!1)})},C=y=>{let j=[];document.globals.globals.find.meta.map(ae=>{ae.value===y.id?j.push({value:y.id,label:y.name}):j.push(ae)});const O={meta:j},B={find:{...document.globals.globals.find,...O}},X={globals:{...document.globals.globals,...B}};document.globals={...document.globals,...X}},F=[e.jsx(U,{type:"button",style:G.SECONDARY,onClick:y=>{y.preventDefault(),k()},children:l("Add meta box")}),e.jsx(U,{disabled:!N(),style:G.PRIMARY,children:l("Save")}),e.jsx(ht,{})];return b&&n?e.jsx(Qs,{}):R?e.jsx(it,{}):e.jsx(I.Fragment,{children:e.jsx(at,{...g,children:e.jsx("form",{onSubmit:g.handleSubmit(v),onChange:()=>{x(!0)},children:e.jsx(ps,{title:e.jsx(as,{groupId:T}),actions:F,crumbs:[{label:l("Field groups"),link:"/meta"},{label:l("Manage meta fields")}],children:e.jsx("div",{ref:a,children:e.jsx(ls,{boxes:ve(c)?[]:c.boxes})})})})})})};export{$t as default};
