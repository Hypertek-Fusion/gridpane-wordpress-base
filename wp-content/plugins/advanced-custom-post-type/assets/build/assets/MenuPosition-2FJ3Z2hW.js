import{j as e,n as S,u as r}from"./fields-Cqw4NA-S.js";import{a as x,R as v}from"./vendor-D21mNUGX.js";import{P as o,I as w,B as y,s as I}from"./index-DxCcoVgy.js";import{M as C}from"./index-Dp8I9ahT.js";import{E as O}from"./index-CTAGjDz_.js";import{g as P}from"./index.esm-CunHohLK.js";import"./Select-DQFFBRh5.js";import{I as T}from"./InputHidden-D-OSbUvk.js";const N=({icon:l,isSelected:a,callback:d})=>e.jsx("div",{title:l,className:`icon ${a?"selected":""}`,onClick:()=>{d(l)},children:e.jsx(w,{icon:l,width:"24px"})});N.propTypes={icon:o.string.isRequired,isSelected:o.bool,callback:o.func};const k=({type:l,defaultIcon:a=null,callback:d})=>{const[u,h]=x.useState([]),p="https://api.iconify.design/",j=t=>{fetch(`${p}search?query=${t}&prefix=dashicons&limit=96`).then(s=>s.json()).then(s=>{h(s.icons)})},f=()=>{fetch(`${p}collection?prefix=dashicons`).then(t=>t.json()).then(t=>{let s=[];t.uncategorized.map(i=>{s.push(`dashicons-${i}`)}),h(s)})},m=()=>{if(!wp||!wp.media){alert(r("The media gallery is not available. You must admin_enqueue this function: wp_enqueue_media()"));return}const t=wp.media({title:r("Upload an Image"),library:{type:["image"]},multiple:!1});t.on("select",function(s){const n=t.state().get("selection").first().toJSON().url;d(n)}),t.open()};return x.useEffect(()=>{f()},[]),l==="image"?e.jsxs(v.Fragment,{children:[a&&S(a)&&e.jsx("div",{className:"fit-content mt-8 mb-8 p-8 with-border b-rounded",children:e.jsx("img",{src:a,alt:"",width:128})}),e.jsx("a",{href:"#",className:"mt-1 acpt-btn acpt-btn-primary-o acpt-btn-block",onClick:t=>{t.preventDefault(),t.stopPropagation(),m()},children:r("Upload an Image")})]}):e.jsxs(v.Fragment,{children:[e.jsx("div",{className:"form-group",children:e.jsx("input",{type:"text",className:"form-control",placeholder:r("Type at least 3 characters to start searching."),onChange:async t=>{const s=t.currentTarget.value;s.length===0&&f(),s.length>=3&&j(s)}})}),u.length>0&&e.jsx("div",{className:"mt-24 icon-picker-wrapper","data-cy":"icon-picker-wrapper",children:u.map(t=>e.jsx(N,{isSelected:a===t,icon:t,callback:d}))})]})};k.propTypes={type:o.string.isRequired,defaultIcon:o.string,callback:o.func};const q=({callback:l,id:a,validate:d,register:u,description:h,defaultValue:p,errors:j})=>{const f=P(j,a),[m,t]=x.useState(p),[s,i]=x.useState(!1),[n,g]=x.useState(null),R=c=>{t(c),l(c),i(!1)};x.useEffect(()=>{p!==null&&t(p)},[p]);const b=c=>{g(c),i(!s)};return e.jsxs(v.Fragment,{children:[s&&e.jsxs(C,{title:r("Choose icon"),visible:s,setVisible:i,testId:a,children:[e.jsxs("div",{className:"text-left",children:[e.jsx("label",{className:"form-label",htmlFor:"icon-picker",children:r("Select icon type from the list")}),e.jsxs("select",{"data-cy":"select-icon",onChange:c=>{c.preventDefault(),c.stopPropagation(),g(c.currentTarget.value)},defaultValue:n,className:"form-control",id:"icon-picker",children:[e.jsx("option",{value:"",children:r("--Select--")}),e.jsx("option",{value:"dashicon",children:r("Select a Dashicon")}),e.jsx("option",{value:"image",children:r("Upload an icon image")})]})]}),n&&e.jsx("div",{className:"mt-8",children:e.jsx(k,{type:n,defaultIcon:m,callback:R})})]}),e.jsxs("div",{className:"flex-center s-8",children:[m&&e.jsx(O,{value:m}),e.jsx("input",{id:a,name:a,type:"text","data-cy":"input-icon",value:m||"",className:"hidden",...u(a,d)}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(y,{onClick:c=>{c.preventDefault(),c.stopPropagation(),b("dashicon")},style:I.SECONDARY,size:"sm",testId:`${a}_dashicon`,children:r("Choose icon")}),e.jsx(y,{onClick:c=>{c.preventDefault(),c.stopPropagation(),b("image")},style:I.BORDERED,size:"sm",testId:`${a}_image`,children:r("Upload an icon image")})]})]}),h&&e.jsx("div",{className:"form-description",children:h}),f&&e.jsx("div",{"data-cy":"input-error-icon",className:"invalid-feedback",children:f.message})]})};q.propTypes={id:o.string.isRequired,defaultValue:o.string,description:o.string,callback:o.func,validate:o.func,register:o.func.isRequired,errors:o.array.isRequired};const D=({id:l,register:a,setValue:d,defaultValue:u,description:h})=>{const p=x.useRef(null),j=x.useRef(null),f=()=>{const s=p.current.value,i=j.current.value;if(s&&i){const n=s==="after"?parseInt(i)+1:parseInt(i)-1;d(l,n)}},m=()=>{const s=n=>{const g=n.replace(/(<([^>]+)>)/gi,"");return n.length!==g.length?n.split(" ")[0]:n};let i=[];for(const[n,g]of Object.entries(document.globals.menu))i.push({label:g[0]!==""?s(g[0]):"----",value:n});return i},t=()=>{if(!u)return{position:null,menu:null};for(const[n,g]of Object.entries(document.globals.menu)){if(parseInt(n)+1===u)return{position:"after",menu:n};if(parseInt(n)-1===u)return{position:"before",menu:n}}const i=Object.keys(document.globals.menu).findIndex(n=>parseInt(n)===parseInt(u));return Object.entries(document.globals.menu)[i+1]?{position:"before",menu:Object.entries(document.globals.menu)[i+1][0]}:Object.entries(document.globals.menu)[i-1]?{position:"after",menu:Object.entries(document.globals.menu)[i-1][0]}:{position:null,menu:null}};return e.jsxs(v.Fragment,{children:[e.jsx(T,{register:a,id:l,value:u}),e.jsxs("div",{className:"i-flex-center s-8 w-100",children:[e.jsx("div",{className:"acpt-select w-50",children:e.jsxs("select",{ref:p,"data-cy":`position-${l}`,className:"form-control",onChangeCapture:f,defaultValue:t().position,children:[e.jsx("option",{value:"",children:r("Select")}),e.jsx("option",{value:"after",children:r("After")}),e.jsx("option",{value:"before",children:r("Before")})]})}),e.jsx("div",{className:"acpt-select w-50",children:e.jsxs("select",{ref:j,"data-cy":`menu-${l}`,className:"form-control",onChangeCapture:f,defaultValue:t().menu,children:[e.jsx("option",{value:"",children:r("Select")}),m().map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})})]}),h&&e.jsx("div",{className:"form-description",children:h})]})};D.propTypes={id:o.string.isRequired,defaultValue:o.number,description:o.string,setValue:o.func.isRequired,register:o.func.isRequired};export{q as I,D as M};
